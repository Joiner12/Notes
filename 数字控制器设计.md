# 数字控制器设计_R1

## 1.离散（数字）控制系统

关键参数：${T_s}​$ 采样周期

拉斯算子：${s = e^{j\omega + \delta}}​$



## 2.两种PID控制器模式(位置式)${^{[1]}}$

### 2.1 Text Book Form

$$
\begin{align}
&Continuous:\\
&u(t) = K(e(t) + \frac{1}{T_i}\int_0^te(\tau)d\tau + T_d\frac{de(t)}{dt})&...(Ⅰ)\\
& Discrete^{[2][4]}:\\


\end{align}
$$



### 2.2 Parallel Form

$$
\begin{align}
&Continuous:\\
&u(t) = K_p*e(t) + K_i\int_0^te(\tau)d\tau + K_d*\frac{de(t)}{dt} ...(Ⅱ)\\
& Discrete^{[2][4]}:\\
\end{align}
$$

### 2.3 About

2.3.1 从系数量纲的角度看？

  （Ⅰ）式中，K单位${（HZ）(\frac{1}{s})}$,${T_i}$积分时间常数，${T_d}$微分时间常数；

  （Ⅱ）式中，${K_p}​$单位${（HZ）(\frac{1}{s})}​$,${K_i}​$ 单位（${\frac{1}{s^2}}​$），${K_d}​$无量纲；

2.3.2 从整定方式看。

Ziegler Nichols 整定方式是基于（Ⅰ）；



2.3.2 转换关系${^{[1]}}​$
$$
\begin{align}
K,\frac{1}{T_i},T_d |
K_P,K_i,K_d可以进行相互转换\\
\end{align}
$$

## 3.设计流程

### 3.1 连续系统被控对象&控制器

#### 3.1.1 被控对象（Continuous System Transform Function）

以${Gs = \frac{1}{s^3+1}}​$被控对象为例，

```matlab
s = tf('s');
Gs = 1/(s^3+1);
ts = 1e-3; % 采样周期
Dgs = c2d(Gs,'zoh'); %以零阶保持器的方式进行离散化（Z变换）；
[num,den] = tfdata(Dgs,'v');% 'v'强制返回Vector而非Cell类型数据；
```

#### 3.1.2 连续系统离散方式${^{[8][9]}}$

  获取被控对象的传递（S域）传递函数之后，进行计算机仿真（MATLAB | Visual Studio ）需要对被控对象进行离散化，实现模拟控制器的数字形式${^{[5]}}​$，将S域函数转换为Z域传递函数，并进一步转换为差分方程形式；S域到Z域变换方式比较多，主要包括以下方法，‘zoh’:零阶保持器方法${^{[10]}}​$、三角近似法、脉冲冲击响应不变、双线性变换、零极点匹配、最小二乘法。

- `'zoh'` — Zero-order hold (default). Assumes the control inputs are piecewise constant over the sample time `Ts`.
- `'foh'` — Triangle approximation (modified first-order hold). Assumes the control inputs are piecewise linear over the sample time `Ts`.
- `'impulse'` — Impulse invariant discretization
- `'tustin'` — Bilinear (Tustin) method. To specify this method with frequency prewarping (formerly known as the `'prewarp'` method), use the `PrewarpFrequency` option of `c2dOptions`.
- `'matched'` — Zero-pole matching method
- `'least-squares'` — Least-squares method

#### 3.1.3 PID控制器离散方式

  PID控制器的设计方式之一，先进行模拟控制器设计，设计完成之后，对控制器进行离散化，对PID进行离散化的方式${^{[2]}}​$主要有前向欧拉（Forward Euler），后向欧拉（Backward Euler）， 梯形变换（Trapezoidal）${^{[4]}}​$。不同的控制器结构，会有不同的控制效果，以及对应参数调整方式；上述三种控制器离散算法都需要设计到数字控制器控制周期${T_s}​$ ，并且控制器参数的设计中，将控制器周期进行显式使用；区别于另外一种常用的控制器设计方式（差分设计），此种控制器设计方式以差分近似微分，偏差累计近似微分，两者最显著的区别在于是否将系统采样周期代入控制器参数设计中，因为PID控制器的参数一般都是进行经验调整，因此这两种不同的设计方式模糊了是否在控制器设计代入采样周期这个参数的意义；
$$
\begin{align}
&e.g^{^{[2]}}:\\
&采样周期（Sample Period）:T_s\\
&\frac{1}{s}离散方式:\\
&Forward Euler: \frac{K_iT_s}{z-1}\\
&Backward Euler:\frac{K_iT_sz}{z-1}\\
&Trapezoidal:\frac{K_iT_s(z+1)}{z-1}\\
\end{align}
$$

### 3.2 不同采样周期对于局部系统的影响分析

#### 3.2.1 滑动滤波器

  那么滑动平均滤波的点数与截止频率之间的关系可以表达为${^{[11][12]}}$：

  
$$
N = 0.443*fs/fco,
式中，N为平均的点数，fs为采样频率，fco为截止频率。
$$


#### 3.2.2 一阶RC低通滤波器

截止频率同滤波系数、采样周期关系：
$$
fl:截止频率\\
a：滤波系数\\
T:采样周期\\
fl = \frac{a}{2*pi*T}\\
$$

#### 3.2.3 逆控制系统参数分析

问题提出：

  已经设计调试好的控制器，修改整个控制系统采样周期，分析不同采样周期条件下，受采样周期影响控制器系数问题；

分析方式：

  数字控制系统，逆转换为模拟控制系统，以模拟控制系统控制器作为参考标准，进行对比分析；





## 4. Vibration Depress

### 4.1 问题背景

  薄板边缘进行随动，由于跟踪对象的不稳定性、边缘效应、系统内部相互作用；导致浮动头出现较高频率的抖动，并且由于系统内部的相互作用，加剧了浮动头抖动效果；

### 4.2 解决方案-1

  非线性偏差；
$$
\begin{align}
& Cof(error,boundary,k) = 
\begin{cases}
boundary / boundary ,abs(error) >= boundary; \\
1 + k*(boundary - abs(error))/boundary;\\
\end{cases}...(1)\\
\\
& ErrorDepress(t) = Error(t)*Cof(t)...(2)；
\end{align}
$$


## n. Problems

1.S（s域）不能进行Z变换的原因；

2.增量式PID控制器如何进行积分饱和设计；

## Reference:

[1]  《PID Anti-Windup Schemes》<https://www.scilab.org/pid-anti-windup-schemes>

[2] 《Discrete time pid controller implementation》<https://www.scilab.org/discrete-time-pid-controller-implementation>

[3] 《Advanced PID Controller Implementation》<https://www.scilab.org/advanced-pid-controller-implementation>

[4] 《Disrete Pid Controller》<http://portal.ku.edu.tr/~cbasdogan/Courses/Robotics/projects/Discrete_PID.pdf>

[5] 《Digital PID》<https://web.calpoly.edu/~fowen/me422/Chapter10.pdf>

[6] 《Modern PID - Digital PID》 <https://msc.berkeley.edu/assets/files/PID/modernPID4-digitalPID.pdf>

[7] 《Digital Control Systems》<https://ethz.ch/content/dam/ethz/special-interest/mavt/dynamic-systems-n-control/idsc-dam/Lectures/Digital-Control-Systems/Slides_DigReg_2013.pdf>

[8] 《Convert model from continuous to discrete time》<https://ww2.mathworks.cn/help/control/ref/c2d.html#mw_de45fa0b-4dd8-4040-be9c-4fd55b8b9567>

[9] 赵霞, 王祝萍, 贾海航. 连续系统离散化方法的比较与解析初探[J]. 工业和信息化教育, 2015(10):71-76.

[10] Landua I , GianlucaZito. 数字控制系统：设计、辨识和实现：design, identification and implementation[M]. 科学出版社, 2014.

[11] 《 滑动平均滤波的截止频率与平均点数计算》(https://www.cnblogs.com/pingwen/p/6670675.html)

[12] 《Which is the cut -off frequency of Moving Average LP Filter?》<https://www.dsprelated.com/showthread/comp.dsp/155807-1.php>