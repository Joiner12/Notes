# (一)状态方程描述下的动态系统

(https://www.zhihu.com/people/shan-dao-95)https://www.zhihu.com/people/shan-dao-95)



控制理论是一门上个世纪诞生的很重要的理论，它基于信息的交互来实现目标的运动。一经诞生就备受人们重视，它启发和影响了诸如人工智能、认知科学、环境科学、现代经济理论等多个领域。经典控制理论已经广泛运用到工业自动化领域。用经典控制理论来实现控制器的设计思路十分成熟。不过在一些设计过程中只用根轨迹、伯德图设计系统控制器参数比较棘手，一开始对系统稳定性的判定就很繁琐，而且如果不适合又要完全从头开始作图，费时费力，很多时候系统阶数很高的时候又不便于直接求出极点。所幸现代控制理论找到了一种不错的方法，能够很快判断系统稳定性也很便于设计控制器。它就是基于状态空间描述的状态方程模型，由于状态方程模型基于矩阵，更便于现代的计算机求解。

那么就让我们来探讨一下关于状态空间方程的现代控制理论吧！我希望通过我的叙述，能够比较完整地整理一下所学内容，顺便与大家共同探讨和分享知识。

本系列内容均为我在Lehrstuhl für Regelungstechnik Technische Fakultät Friedrich-Alexander-Universität Erlangen-Nürnberg上课期间学习资料，由课程教授Prof. Dr.-Ing. Knut Graichen主编的关于Regelungstechnik B (Zustandsraummethoden) 的内容。

## 1.1动态系统的定义

在很多领域都有关于"系统"这个概念，系统往往描述了一个比较复杂的关系的总和，而我们要想很好控制这个系统，就需要先了解它。控制理论研究的是更加广义的系统，把一个系统先当作黑箱，那么这个黑箱和外界的交互关系，就对应了有不同时间的输入输出。

![img](https://pic3.zhimg.com/80/v2-c5604e0c8042bf61076524b9a4c704e6_hd.jpg)图1.1系统的输入输出

在t时刻，这m个会影响系统的输入量在控制理论里称为**控制变量**(Stellgrößen)，而这p个系统输出的可以被传感器测量的量称为**测量变量**(Messgrößen)。现在我们做一些基本假设，限制一些条件，只研究连续时变的线性系统。而且系统的行为，即输出量，由描述系统的函数通过输入量，在时域上唯一确定。我们把系统的行为分为**静态和动态**两类。

用电路来举个例子, ![[公式]](https://www.zhihu.com/equation?tex=v%28t%29) 现在是输出电压， ![[公式]](https://www.zhihu.com/equation?tex=i%28t%29) 表示输入电流，那么电路系统有：

![img](https://pic2.zhimg.com/80/v2-06bb5905657feaaa6aa04db45442ce11_hd.jpg)图1.2 含阻电路和含容电路

例a：带电阻的电路

(1.1) ![[公式]](https://www.zhihu.com/equation?tex=v%28t%29%3DR~i%28t%29)

例b：带电容的电路

(1.2) ![[公式]](https://www.zhihu.com/equation?tex=v%28t%29%3Dv_0+%2B%5Cfrac%7B1%7D%7BC%7D%5Cint_%7Bt_0%7D%5E%7Bt%7Di%28%5Ctau%29d%5Ctau)

显然和不随时间变化的例a相比，例b里的初始条件 ![[公式]](https://www.zhihu.com/equation?tex=v_0%3Dv%28t_0%29)，以及 ![[公式]](https://www.zhihu.com/equation?tex=i%28%5Ctau%29) 在这个时间区间 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B+t_0%2Ct+%5Cright%5D) 内的变化决定了输出电压。系统的状态受过去影响，随时间变化。这样的系统被称为**动态系统**。

## 1.2状态方程的引入

我们定义**状态方程**中的状态变量为

> 定义1.1 **状态变量**：
> n个变量 ![[公式]](https://www.zhihu.com/equation?tex=x_1%2Cx_2%2C...x_n) 被称为动态系统的**状态变量**(Zustandsgrößen)，当且仅当它们的p个输出变量 ![[公式]](https://www.zhihu.com/equation?tex=y_1%2Cy_2%2C...y_p) 完全由初始状态 ![[公式]](https://www.zhihu.com/equation?tex=x_1%5Cleft%28+t_0+%5Cright%29%2Cx_2%5Cleft%28+t_0+%5Cright%29%2C...x_n%5Cleft%28+t_0+%5Cright%29) 以及m个输入量 ![[公式]](https://www.zhihu.com/equation?tex=u_1%5Cleft%28+%5Ctau+%5Cright%29%2Cu_2%5Cleft%28+%5Ctau+%5Cright%29...u_m%5Cleft%28+%5Ctau+%5Cright%29) 在 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctau%5Cin%5Cleft%5B+t_0%2Ct+%5Cright%5D) 内的历史决定。

那么状态方程可以由有限个一阶常微分方程组描述：

(1.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+x_1%3Df_1%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%2Cx_1%5Cleft%28+t_0+%5Cright%29%3Dx_%7B1%2C0%7D%5C%5C+%5Cdot+x_2%3Df_2%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%2Cx_2%5Cleft%28+t_0+%5Cright%29%3Dx_%7B2%2C0%7D%5C%5C+....%5C%5C+%5Cdot+x_n%3Df_n%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%2Cx_n%5Cleft%28+t_0+%5Cright%29%3Dx_%7Bn%2C0%7D)

同时输出方程为

(1.4) ![[公式]](https://www.zhihu.com/equation?tex=y_1%3Dh_1%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%5C%5C+y_2%3Dh_2%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%5C%5C+....%5C%5C+y_p%3Dh_p%5Cleft%28+x_1%2Cx_2%2C...x_n%2C+u_1%2Cu_2...u_m%2Ct%5Cright%29%5C%5C)

当然我们可以向量形式来描述这些方程组

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cleft%5B+x_%7B1%7D~+x_%7B2%7D...x_%7Bn%7D+%5Cright%5D%5E%7BT%7D) 为总共n维状态变量；

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cleft%5B+u_%7B1%7D~+u_%7B2%7D...u_%7Bm%7D+%5Cright%5D%5E%7BT%7D) 为总共m维输入列向量；

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%3D%5Cleft%5B+y_%7B1%7D~+y_%7B2%7D...y_%7Bp%7D+%5Cright%5D%5E%7BT%7D) 为总共p维输出行向量；

所以我们就可以用更加紧凑的方式来描述它

(1.5) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D+%26%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%2Cu%7D%2Ct%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D%5C%5C+%26%5Cmathbf%7By+%7D%3D%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%2Cu%7D%2Ct%29+%5Cend%7Balign%2A%7D)

所以在t时刻，所有状态变量就可以用n维的向量空间描述，也即状态空间。在一个时间区间内，状态空间所有的状态量的点集就构成了一条轨迹。

![img](https://pic1.zhimg.com/80/v2-eb13c5c75f78a83f59b27e9f16b767e4_hd.jpg)图1.3 状态变量轨迹的可视化

## 1.3一些物理例子

接下来我们用一些实际物理过程的数学建模举例，来说明使用状态空间描述的优点。

**例一：一个经典的电路**

![img](https://pic4.zhimg.com/80/v2-68ca0fc62d49268d94071edf852feaef_hd.jpg)

图1.4 含电容电感电阻的时变电路运用基尔霍夫电压定律可得

(1.6) ![[公式]](https://www.zhihu.com/equation?tex=-u%28t%29%2Bu_C%28t%29%2Bu_L%28t%29%2By%28t%29%3D0)

其中 ![[公式]](https://www.zhihu.com/equation?tex=C%5Cfrac%7Bd%7D%7Bdt%7D+u_C%28t%29%3Di%28t%29) ， ![[公式]](https://www.zhihu.com/equation?tex=L%5Cfrac%7Bd%7D%7Bdt%7Di%28t%29%3D-u_L%28t%29) , ![[公式]](https://www.zhihu.com/equation?tex=y%28t%29%3DR~i%28t%29) ,初始条件为 ![[公式]](https://www.zhihu.com/equation?tex=i%280%29%3Di_%7B0%7D)，![[公式]](https://www.zhihu.com/equation?tex=u_C%280%29%3Du_%7BC%2C0%7D) 可以得出状态方程的表达方式

(1.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%7D%7Bdt%7D%5Cbegin%7Bbmatrix%7D+u_C%28t%29++++%5C%5Ci%28t%29+++++++%5Cend%7Bbmatrix%7D%3D+%5Cbegin%7Bbmatrix%7D+0+++++%26+%5Cfrac%7B1%7D%7BC%7D+++++++%5C%5C-%5Cfrac%7B1%7D%7BL%7D+++++%26+-%5Cfrac%7BR%7D%7BL%7D++++++++%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7D+u_C%28t%29++++%5C%5Ci%28t%29+++++++%5Cend%7Bbmatrix%7D%2B%5Cbegin%7Bbmatrix%7D+0+++%5C%5C%5Cfrac%7B1%7D%7BL%7D+++++++%5Cend%7Bbmatrix%7Du%28t%29)

(1.8) ![[公式]](https://www.zhihu.com/equation?tex=y%28t%29%3D%5Cbegin%7Bbmatrix%7D+0++%26+R++++++%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D+u_C%28t%29++++%5C%5Ci%28t%29+++++++%5Cend%7Bbmatrix%7D)

现在给出这个一阶方程的解，当输入 ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29%3D0) ，会有时间常数 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctau%3D%5Cfrac%7BR%7D%7B2L%7D) ，以及对应的振荡频率 ![[公式]](https://www.zhihu.com/equation?tex=%5Comega%3D%5Csqrt%7B%5Cleft%7C+%5Cfrac%7B1%7D%7BLC%7D-%5Cleft%28+%5Cfrac%7BR%7D%7B2L%7D+%5Cright%29%5E2+%5Cright%7C%7D) ，可能出现虚部，于是有三种情况

![img](https://pic2.zhimg.com/80/v2-f130c16ae2b0a511da06878282845831_hd.jpg)图1.5 u(t)=0时的解析解

如果令 ![[公式]](https://www.zhihu.com/equation?tex=L%3DC%3D1) ， ![[公式]](https://www.zhihu.com/equation?tex=R%5Cin%5Cleft%5C%7B+1%2C2%2C3+%5Cright%5C%7D) 并且初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%28u_%7BC%2C0%7D%2Ci_%7B0%7D%29%3D%282%2C1%29) 有轨迹

![img](https://pic4.zhimg.com/80/v2-38f6211a51407a8f6be4c05311a1c1c7_hd.jpg)图1.6 三种情况对应的暂态行为状态变量轨迹

可见在这样初始条件下，这个系统在没有输入控制变量时也是能够自己稳定，并不会发散而最终不稳定。

**例二：一个机械动力系统**

![img](https://pic3.zhimg.com/80/v2-b211e0cf94fa2659a795532404b17cf2_hd.jpg)1.7 两自由度的旋转机械臂

让我们考察这样一个旋转的机械臂，其中转角 ![[公式]](https://www.zhihu.com/equation?tex=%5Cphi%28t%29) 和有效臂长 ![[公式]](https://www.zhihu.com/equation?tex=r%28t%29) 各贡献了一个自由度。其中机座转动惯量 ![[公式]](https://www.zhihu.com/equation?tex=J_0) ，机械臂质量 ![[公式]](https://www.zhihu.com/equation?tex=m)，转动惯量 ![[公式]](https://www.zhihu.com/equation?tex=J_1) 。实际转动时，机械臂会伸出去缩回来，所以转动惯量会发生变化，所以总的转动惯量 ![[公式]](https://www.zhihu.com/equation?tex=J%28t%29%3DJ_0%2BJ_1%2Bmr%5E2%28t%29) ，所以总的角动量为 ![[公式]](https://www.zhihu.com/equation?tex=D%28t%29%3DJ%28t%29%5Comega%28t%29) 。

施加的控制转矩为 ![[公式]](https://www.zhihu.com/equation?tex=M%28t%29) ，则角动量变化量有

(1.9) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cfrac%7Bd%7D%7Bdt%7DD%28t%29%26%3D%5Cdot+J%28t%29%5Comega%28t%29%2BJ%28t%29%5Cdot+%5Comega%28t%29+%5C%5C%26%3D2mr%5Cdot+r%5Comega%2B%28J_0%2BJ_1%2Bmr%5E2%29%5Cdot%5Comega%3DM%28t%29+%5Cend%7Balign%7D)

略去自变量 ![[公式]](https://www.zhihu.com/equation?tex=%28t%29) 的写法，此时科里奥利力带来的影响 ![[公式]](https://www.zhihu.com/equation?tex=2mr%5Cdot+r%5Comega) 会出现。同时考虑在旋转机械臂上的作用力，有动量 ![[公式]](https://www.zhihu.com/equation?tex=p%3Dmv)

(1.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%7D%7Bdt%7Dp%3Dm%5Cdot+v%3DF%28t%29%2Bmr%5Comega%5E2)

![[公式]](https://www.zhihu.com/equation?tex=F%28t%29) 为施加的控制力， ![[公式]](https://www.zhihu.com/equation?tex=mr%5Comega%5E2) 为旋转时产生的离心力。

考虑到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot%5Comega%28t%29%3D%5Cphi%28t%29) 以及 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+r%28t%29%3Dv%28t%29) ，我们一阶微分方程一共有四个，有

(1.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%5Cphi%26%3D%5Comega%5C%5C+%5Cdot+%5Comega%26%3D%5Cfrac%7B-2mrv%5Comega%2BM%28t%29%7D%7BJ_0%2BJ_1%2Bmr%5E2%7D%5C%5C+%5Cdot+r%26%3Dv%5C%5C+%5Cdot+v%26%3Dr%5Comega%5E2%2B%5Cfrac%7B1%7D%7Bm%7DF%28t%29+%5Cend%7Balign%7D+)

其中状态变量为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cleft%5B+%5Cphi%2C~%5Comega%2C~r%2C~v+%5Cright%5D%5E%7BT%7D) ，输入控制变量为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cleft%5B+M%2C~F+%5Cright%5D%5E%7BT%7D) ，显然这个微分方程组无法直接写成矩阵向量线性相乘的状态方程形式，于是合写作向量函数来表示。

(1.12) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%2Cu%7D%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D)

## **1.4线性系统**

上述两例子可知，系统的状态方程只用一阶的微分方程组就能很好描述系统，那么遇上更高阶的方程组怎么办呢？事实上考察一个动态系统有很多不同分类标准，我们在这里只探讨其中最主要的——线性、时不变性。

> 定义1.2 **线性函数**：
> 函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%5Cleft%28+x+%5Cright%29) 被称为线性的，当他满足叠加定理和齐次定理。
> ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%5Cleft%28+%5Calpha_1x_1%2B%5Calpha_2x_2+%5Cright%29%3D%5Calpha_1%5Cpsi%28x_1%29%2B%5Calpha_2%5Cpsi%28x_2%29) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha_1%2C%5Calpha_1%2Cx_2%2Cx_2%5Cin+%5Cmathbb%7BR%7D)

所以当动态系统满足线性，其状态方程 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%2Cu%7D%2Ct%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D) 各自对应的部分可以分别分别相叠加，自然可以用向量空间表示它们之间的线性关系。

> 定义1.3 **线性系统**：
> 动态系统满足线性时不变条件，当且仅当它可以有以下形式表示
> (1.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BA%7D%28t%29%5Cmathbf%7B+x%2BB%7D%28t%29%5Cmathbf%7Bu%7D%5C%5C+%5Cmathbf%7By%7D%3D%5Cmathbf%7BC%7D%28t%29%5Cmathbf%7B+x%2BD%7D%28t%29%5Cmathbf%7Bu%7D)

包含时变的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%28t%29) (nxn)矩阵， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D%28t%29) (nxm)矩阵， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BC%7D%28t%29) (pxn)矩阵，(pxm)矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BD%7D%28t%29)

而当系统系统输入量不随时间变化时，有时不变特性

> 定义1.4 **时不变系统**：
> 动态系统满足线性时不变条件，当它许用的输入轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29) 在每个初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0) 每个开始的时点 ![[公式]](https://www.zhihu.com/equation?tex=t_0) 并且在之后![[公式]](https://www.zhihu.com/equation?tex=T%5Cgeq0) 的输出 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%28t%29%3D%5Cboldsymbol%7B%5Cpsi%7D%28t%2C%5Cmathbf%7Bu%7D%2C%5Cmathbf%7Bx%7D_0%2Ct_0%29) ，总有可以有以下形式表示
> ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cpsi%7D%28t%2C%5Cmathbf%7Bu%7D%28t%29%2C%5Cmathbf%7Bx%7D_0%2Ct_0%29%3D%5Cboldsymbol%7B%5Cpsi%7D%28t%2BT%2C%5Cmathbf%7Bu%7D%28t-T%29%2C%5Cmathbf%7Bx%7D_0%2Ct_0%2BT%29)

于是可以继续给出

> 定义1.5 **线性时不变系统**：
> 动态系统满足线性时不变条件，当且仅当它可以有以下形式表示
> (1.14)![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BA+x%2BBu%7D%5C%5C+%5Cmathbf%7By%7D%3D%5Cmathbf%7BCx%2BDu%7D)

值得一提的是，当系统非线性时不变时，自变量里面就没有t，是以下形式

(1.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D+%26%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%2Cu%7D%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D%5C%5C+%26%5Cmathbf%7By+%7D%3D%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%2Cu%7D%29+%5Cend%7Balign%2A%7D)

当系统非线性且与输入量无关，则被称为**自由**非线性系统

(1.16) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D+%26%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%2Ct%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D%5C%5C+%26%5Cmathbf%7By+%7D%3D%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%7D%2Ct%29+%5Cend%7Balign%2A%7D)

当系统既自由而且时不变时，被称为**自治**的非线性系统

(1.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D+%26%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%29%2C~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D%5C%5C+%26%5Cmathbf%7By+%7D%3D%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%7D%29+%5Cend%7Balign%2A%7D)

## 1.5平衡点的定义

系统在一个工作点上能够在接受外界输入(或干扰)后依然能够稳定平衡在这里，那么它就是一个系统的平衡点。显然平衡点在控制技术里十分重要，系统能够稳定就相当于找到了一个平衡点。

> 定义1.6 **平衡点**：
> ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_R) 被定义为系统的平衡点，当 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cgeq0) 它满足条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D_R%2Ct%29%3D%5Cmathbf%7B0%7D)

根据定义，状态变量处于平衡点时，所有n个状态变量都处于静止状态，即没有速度。一个非线性系统往往会含有多个平衡点。比如 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+x%3Dx%5E2-1) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+x%3Dsin%28x%29) 等等。与非线性系统不同，一个线性时不变的自治系统仅有一个平衡点或者无穷个平衡点。

(1.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7BA%7D%5Cmathbf%7Bx%7D%3D%5Cmathbf%7B0%7D%2C~~~~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D)

根据克拉默法则，显然这个齐次线性方程组的解的数量取决于(nxn)系统系数矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA+%7D) 是否满秩

- ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA+%7D%29%5Cne+0) ：矩阵满秩，有且仅有一个解。
- ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA+%7D%29%3D+0) ：矩阵不满秩，有无穷多个解。

如果忘记了关于向量和系数矩阵的解的关系的同学，不要紧。我可以简单帮你们重温一遍。

一个系统用一阶齐次常微分方程组表示时，如果有n个独立未知量，想要获得**唯一解**，就必须要有n条线性无关的方程，也即对应了**n条不变的约束关系**。但是如果约束关系不够，并没有n条线性无关的方程，或者n条方程里，有几条方程线性相关，那么实际可用的约束关系就不足n个了。那么未知量就无法一一对应地被唯一约束，也即有**无穷解**。

矩阵的秩描述了最大线性无关的矩阵行数\列数，即在这里线性无关的方程的行数，如果系数矩阵行列式为0，即不满秩，那就缺少约束，自然就有无穷解了。

而对于一个带输入的非线性系统，当它处于平衡点时，这个平衡点会与输入量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_R) 有关，于是把它们合写做 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7Bx%7D_R%2C%5Cmathbf%7Bu%7D_R%29) 。表示这个工作点的状态变量与稳态输入有关。

而对于带输入的线性时不变系统的平衡点

(1.19) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x+%7D%3D%5Cmathbf%7BA%7D%5Cmathbf%7Bx++%2BBu%7D%3D%5Cmathbf%7B0%7D%2C~~~~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_%7B0%7D)

- ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA+%7D%29%5Cne+0) ：矩阵满秩，有且仅有一个解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x+%7D_R%3D-%5Cmathbf%7BA%5E%7B-1%7DBu%7D_R)。
- ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA+%7D%29%3D+0%2C~Rank%28%5Cmathbf%7BA+%7D%29%3DRank%28%5Cmathbf%7BA%2CBu+%7D_R+%29) ：矩阵不满秩，有无穷多个解。
- ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA+%7D%29%3D+0%2C~Rank%28%5Cmathbf%7BA+%7D%29%3CRank%28%5Cmathbf%7BA%2CBu+%7D_R+%29) ：矩阵不满秩，且无解。

对于非齐次的线性方程组而言，满秩的意义就更明显了，只有满秩了才有逆矩阵可以用来求解。而且，非齐次方程组里，如果增广矩阵的秩比原来的系数矩阵秩还多，意味着有一些行的方程，有不为0的输入却等于0，自然是无解了。

## 1.6在平衡点上的线性化

对线性时不变系统的控制显然比非线性的系统要容易得多。不过我们也可以用近似的方法，处理非线性系统，这样它就可以通过线性模型来表示，而只有有限的在平衡点附近或者跟踪轨迹上的偏差。

为了对非线性系统线性化，需要用到偏导数。对一个标量函数 ![[公式]](https://www.zhihu.com/equation?tex=f%28%5Cmathbf%7Bx%7D%29) 在平衡点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cmathbf%7Bx%7D_R) 上求梯度会得到偏导数组成的向量函数。

(1.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%3D%5Cmathbf%7Bx%7D_R%7D%3D%5Cleft%5B+%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_1%7D+~%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_2%7D...~%5Cfrac%7B%5Cpartial+f%7D%7B%5Cpartial+x_n%7D%5Cright%5D)

而对于向量函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%29%3D%5Cleft%5B+f_1%28%5Cmathbf%7Bx%7D%29%2C~f_2%28%5Cmathbf%7Bx%7D%29%2C~...f_n%28%5Cmathbf%7Bx%7D%29+%5Cright%5D%5ET) 的梯度，即得到矩阵，被称为**雅可比矩阵**(Jacobi-Matrix)，在平衡点处的雅可比矩阵为

(1.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%3D%5Cmathbf%7Bx%7D_R%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cfrac%7B%5Cpartial+f_1%7D%7B%5Cpartial+x_1%7D+++++%26+%5Ccdots+%26+%5Cfrac%7B%5Cpartial+f_1%7D%7B%5Cpartial+x_n%7D++++++%5C%5C+%5Cvdots+%26+%26+%5Cvdots%5C%5C+%5Cfrac%7B%5Cpartial+f_n%7D%7B%5Cpartial+x_1%7D++++%26+%5Ccdots+%26++%5Cfrac%7B%5Cpartial+f_n%7D%7B%5Cpartial+x_n%7D+%5Cend%7Bbmatrix%7D)

在一维的情况下我们对一个非线性函数的线性近似用的方法是一阶泰勒展开，类比这个思路，我们可以自然得到高维非线性函数的一阶线性近似公式。

> 定义1.7 **高维函数的二阶泰勒展开公式**：
> 对于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bf%7D%3AD%5Crightarrow+%5Cmathbb%7BR%7D%5Em) 处于一个n维开子集 ![[公式]](https://www.zhihu.com/equation?tex=D%5Csubset+%5Cmathbb%7BR%7D%5En) 的函数连续可微，有![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_k%2Bk%5CDelta%5Cmathbf%7Bx%7D%5Cin+D) ， ![[公式]](https://www.zhihu.com/equation?tex=k%5Cin+%5Cleft%5B+0%2C1+%5Cright%5D) ，那么有
> ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D_R%2B%5CDelta%5Cmathbf%7Bx%7D%29%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D_R%29%2B%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%7D%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BR%7D%28%5Cmathbf%7Bx%7D_R%2C%5CDelta%5Cmathbf%7Bx%7D%29+) ，其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D%28%5Cmathbf%7Bx%7D_R%2C%5CDelta%5Cmathbf%7Bx%7D%29) 为二阶以上的余项，有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C+%5Cleft%7C+%5Cmathbf%7BR%7D%28%5Cmathbf%7Bx%7D_R%2C%5CDelta%5Cmathbf%7Bx%7D%29+%5Cright%7C+%5Cright%7C%5Cleq+K%5Cleft%7C+%5Cleft%7C+%5CDelta%5Cmathbf%7Bx%7D+%5Cright%7C+%5Cright%7C%5E2) , ![[公式]](https://www.zhihu.com/equation?tex=K%3E0)

对于一个时不变非线性系统，其在平衡点附近的小偏移 ![[公式]](https://www.zhihu.com/equation?tex=%28%5CDelta%5Cmathbf%7Bx%7D%2C%5CDelta%5Cmathbf%7Bu%7D%2C%5CDelta%5Cmathbf%7By%7D%29) 有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7Bx%7D_R%2B%5CDelta%5Cmathbf%7Bx%7D%28t%29) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29%3D%5Cmathbf%7Bu%7D_R%2B%5CDelta%5Cmathbf%7Bu%7D%28t%29) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%28t%29%3D%5Cmathbf%7By%7D_R%2B%5CDelta%5Cmathbf%7By%7D%28t%29) ,于是有

(1.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D++%5Cmathbf%7B%5Cdot+x%7D_R%2B%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D_R%2B%5CDelta%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D_R%2B%5CDelta%5Cmathbf%7Bu%7D%29%2C~~%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_R%2B%5CDelta%5Cmathbf%7Bx%7D%28t_0%29%5C%5C+%5Cmathbf%7By%7D_R%2B%5CDelta%5Cmathbf%7By%7D%26%3D%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%7D_R%2B%5CDelta%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D_R%2B%5CDelta%5Cmathbf%7Bu%7D%29+%5Cend%7Balign%2A%7D)

运用泰勒展开，忽略余项，可得

(1.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D++%5Cunderbrace%7B%5Cmathbf%7B%5Cdot+x%7D_R%7D_0%2B%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cunderbrace%7B%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%29%7D_0%2B%5Cunderbrace%7B%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D%7D_%7B%5Cmathbf%7BA%7D%7D%5CDelta%5Cmathbf%7Bx%7D%2B%5Cunderbrace%7B%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D%7D_%7B%5Cmathbf%7BB%7D%7D%5CDelta%5Cmathbf%7Bu%7D%2C~~%5CDelta%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_0-%5Cmathbf%7Bx%7D_R%5C%5C+%5Cmathbf%7By%7D_R%2B%5CDelta%5Cmathbf%7By%7D%26%3D%5Cunderbrace%7B%5Cmathbf%7Bh%7D%28%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%29%7D_%7B%5Cmathbf%7B%5Cmathbf%7By%7D_R%7D%7D%2B%5Cunderbrace%7B%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D%7D_%7B%5Cmathbf%7BC%7D%7D%5CDelta%5Cmathbf%7Bx%7D%2B%5Cunderbrace%7B%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D%7D_%7B%5Cmathbf%7BD%7D%7D%5CDelta%5Cmathbf%7Bu%7D+%5Cend%7Balign%2A%7D)

> 定义1.8 **平衡点附近的雅可比线性化**：
> 非线性系统，在平衡点 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%29) 对应的足够小的输入变动 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bu%7D%28t%29) 在小范围内的稳态偏移 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bx%7D%28t%29) , ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7By%7D%28t%29) 可以通过一个线性时不变的系统近似描述：
> (1.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D++%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA%7D%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BB%7D%5CDelta%5Cmathbf%7Bu%7D%2C~~%5CDelta%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_0-%5Cmathbf%7Bx%7D_R%5C%5C+%5CDelta%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BC%7D%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BD%7D%5CDelta%5Cmathbf%7Bu%7D+%5Cend%7Balign%2A%7D+)
> 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BC%7D%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BD%7D%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D_R+%2C%5Cmathbf%7Bu%7D_R+%7D)

接下来举个例子

**例三：倒立摆小车的平衡点线性化**

![img](https://pic4.zhimg.com/80/v2-95a81edfb527dd1681d922abee843193_hd.jpg)图1.8 倒立摆小车

一个质量为M的小车上固定了一个质量为m，摆长为l的倒立摆，当输入力 ![[公式]](https://www.zhihu.com/equation?tex=u%3DF) 时，借助拉格朗日法可以求得这个系统的非线性模型，如下

(1.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cddot%5Cphi~~%26%3D%5Cfrac%7B6g%28m%2BM%29sin%28%5Cphi%29-3cos%28%5Cphi%29%282u%2Bml%5Cdot+%5Cphi%5E2sin%28%5Cphi%29%29%7D%7Bl%28m%2B4M%2B3m~sin%5E2%28%5Cphi%29%29%7D%5C%5C+%5Cddot+x_w%26%3D%5Cfrac%7B8u%2B4ml%5Cdot+%5Cphi%5E2sin%28%5Cphi%29-3mg~sin%282%5Cphi%29%7D%7B5m%2B8M-3mg~cos%28%5Cphi%29%7D+%5Cend%7Balign%7D)

设状态变量为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cleft%5B+%5Cphi%2C~%5Cdot%5Cphi%2C~x_w%2C~%5Cdot+x_w+%5Cright%5D%5E%7BT%7D) ，在平衡点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_R%3D%5Cleft%5B+0%2C~0%2C~x_%7BR%2Cw%7D%2C~0+%5Cright%5D%5E%7BT%7D) 上线性化，原式的状态方程为

(1.26) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot+%5Cphi~~%26%3D%5Cdot+x_1%3Dx_2%5C%5C+%5Cddot%5Cphi~~%26%3D%5Cdot+x_2%3D%5Cfrac%7B6g%28m%2BM%29sin%28x_1%29-3cos%28x_1%29%282u%2Bmlx_2%5E2sin%28x_1%29%29%7D%7Bl%28m%2B4M%2B3m~sin%5E2%28x_1%29%29%7D%5C%5C+%5Cdot+x_w%26%3D%5Cdot+x_3%3Dx_4%5C%5C+%5Cddot+x_w%26%3D%5Cdot+x_4%3D%5Cfrac%7B8u%2B4mlx_2%5E2sin%28x_1%29-3mg~sin%282x_1%29%7D%7B5m%2B8M-3mg~cos%28x_1%29%7D+%5Cend%7Balign%7D)

所以其线性化以后的状态方程为

(1.27) ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7B%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D+0++++++%261+%260%26+0++++++%5C%5C+%5Cfrac%7B6g%28m%2BM%29%7D%7B%28m%2B4M%29l%7D%260++++++%26+0%26+0%5C%5C+0%260%260%261%5C%5C+-%5Cfrac%7B3mg%7D%7Bm%2B4M%7D%260%260%260+%5Cend%7Bbmatrix%7D%5CDelta%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D+0+++++%5C%5C+-%5Cfrac%7B6%7D%7B%28m%2B4M%29l%7D+%5C%5C++0%5C%5C+%5Cfrac%7B4%7D%7Bm%2B4M%7D+%5Cend%7Bbmatrix%7D%5CDelta+u)

## 1.7沿轨迹运动的线性化

除了在平衡点上进行线性化，还可以沿着非线性运动轨迹进行实时的线性化，这意味着线性化后的状态方程不再是时不变，而是线性时变的状态方程了。

具体操作其实也很简单，当我们把工作点放在非线性方程解的轨迹上，根据时间变化连续移动，即可得到时变的状态方程。类比刚刚的平衡点线性化方法，只不过把静止的平衡点变成连续变化的点集，即认为是平衡点的连续移动，也可被称为工作点的连续切换。

> 定义1.9 **沿轨迹运动的雅可比线性化**：
> 非线性系统的解的轨迹，即状态变量和输入变量的轨迹是 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29+%29) ，其对应的足够小的输入变动 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bu%7D%28t%29) 在解轨迹上小范围内的稳态偏移 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bx%7D%28t%29) , ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7By%7D%28t%29) 可以通过一个线性时变的系统近似描述：
> (1.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%2A%7D++%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA%7D%28t%29%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BB%7D%28t%29%5CDelta%5Cmathbf%7Bu%7D%2C~~%5CDelta%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_0-%5Cmathbf%7Bx%7D%5E%7B%2A%7D_0%5C%5C+%5CDelta%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BC%7D%28t%29%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BD%7D%28t%29%5CDelta%5Cmathbf%7Bu%7D+%5Cend%7Balign%2A%7D+)
> 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%28t%29%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D%28t%29%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bf%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BC%7D%28t%29%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bx%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29+%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BD%7D%28t%29%3D%5Cfrac%7B%5Cpartial+%5Cmathbf%7Bh%7D%7D%7B%5Cpartial%5Cmathbf%7Bu%7D%7D%5Cbigg%7C_%7B%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29+%7D)



**例四：旋转机械臂沿目标轨迹线性化**

我们继续考察例二里面的机械臂，现在有初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_%7BR%2C0%7D%3D%5Cleft%5B+%5Cphi_0%5E%7B%2A%7D%2C~0%2C~r_0%5E%7B%2A%7D%2C0+%5Cright%5D%5E%7BT%7D) ，我们希望通过合理的输入控制量使得机械臂移动到目标位置上，即各个状态变量变动到到目标平衡点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_%7BR%2C1%7D%3D%5Cleft%5B+%5Cphi_1%5E%7B%2A%7D%2C~0%2C~r_1%5E%7B%2A%7D%2C0+%5Cright%5D%5E%7BT%7D) 。可以预给一条合理的移动轨迹的关于时间的函数

(1.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cphi%5E%7B%2A%7D%28t%29%3D+%5Cphi_0%5E%7B%2A%7D%2B%5Cfrac%7B+%5Cphi_1%5E%7B%2A%7D-+%5Cphi_0%5E%7B%2A%7D%7D%7B2%7D%5Cleft%5B+1-cos%5Cleft%28+%5Cfrac%7B%5Cpi+t%7D%7BT%7D+%5Cright%29+%5Cright%5D%5C%5C+r%5E%7B%2A%7D%28t%29%3D+r_0%5E%7B%2A%7D~%2B~%5Cfrac%7B+r_1%5E%7B%2A%7D-+r_0%5E%7B%2A%7D%7D%7B2%7D%5Cleft%5B+1-cos%5Cleft%28+%5Cfrac%7B%5Cpi+t%7D%7BT%7D+%5Cright%29+%5Cright%5D)

用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%5Cphi%3D%5Comega) 以及 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+r%3Dv) 可以得到目标轨迹的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29%3D%5Cleft%5B+%5Cphi%5E%7B%2A%7D%28t%29%2C~%5Comega%5E%7B%2A%7D%28t%29%2C~r%5E%7B%2A%7D%28t%29%2C~v%5E%7B%2A%7D%28t%29+%5Cright%5D%5E%7BT%7D) ，通过例三的微分方程也可以反解出目标输入控制量的函数，其中 ![[公式]](https://www.zhihu.com/equation?tex=J%5E%7B%2A%7D%28t%29%3DJ_0%2BJ_1%2Bmr%5E%7B%2A%7D%28t%29%5E2)

(1.30) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29%3D%5Cbegin%7Bbmatrix%7D+M%5E%7B%2A%7D%28t%29%5C%5CF%5E%7B%2A%7D%28t%29+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+2mr%5E%7B%2A%7D%28t%29v%5E%7B%2A%7D%28t%29%5Comega%5E%7B%2A%7D%28t%29%2BJ%5E%7B%2A%7D%28t%29%5Cdot+%5Comega%5E%7B%2A%7D%28t%29%5C%5Cm%5B%5Cdot+v%5E%7B%2A%7D%28t%29-r%5E%7B%2A%7D%28t%29%5Comega%5E%7B%2A%7D%28t%29%5E2%5D+%5Cend%7Bbmatrix%7D)

![img](https://pic1.zhimg.com/80/v2-2a9f07fa99372f27e96f4ba19d5abd10_hd.jpg)图1.9 机械臂的目标轨迹

给定历程时间 ![[公式]](https://www.zhihu.com/equation?tex=T%3D2s) ，其余参数 ![[公式]](https://www.zhihu.com/equation?tex=J_0%3D0.05kg~+m%5E2) ， ![[公式]](https://www.zhihu.com/equation?tex=J_1%3D0.1kg~+m%5E2) ， ![[公式]](https://www.zhihu.com/equation?tex=m%3D3kg)

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+%5Cphi_0%5E%7B%2A%7D%5C%5C+r_0%5E%7B%2A%7D+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+0%5E%5Ccirc%5C%5C0.1~m+%5Cend%7Bbmatrix%7D~%5Crightarrow~%5Cbegin%7Bbmatrix%7D+%5Cphi_1%5E%7B%2A%7D%5C%5C+r_1%5E%7B%2A%7D+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+90%5E%5Ccirc%5C%5C0.5~m+%5Cend%7Bbmatrix%7D%5C%5C)

当沿着目标轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5E%7B%2A%7D%28t%29+%2C%5Cmathbf%7Bu%7D%5E%7B%2A%7D%28t%29) 运动时，就能得到系统的矩阵

(1.31) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%28t%29%3D%5Cbegin%7Bbmatrix%7D+0%261%260%260%5C%5C0%26%5Cfrac%7B-2mr%5E%7B%2A%7D%28t%29v%5E%7B%2A%7D%28t%29%7D%7BJ%5E%7B%2A%7D%28t%29%7D%26%5Cfrac%7B-2m%5Cleft%5B+r%5E%7B%2A%7D%28t%29M%5E%7B%2A%7D%28t%29%2B%5BJ%5E%7B%2A%7D%28t%29%2B2mr%5E%7B%2A%7D%28t%29%5Dv%5E%7B%2A%7D%28t%29%5Comega%5E%7B%2A%7D%28t%29+%5Cright%5D%7D%7BJ%5E%7B%2A%7D%28t%29%5E2%7D%26%5Cfrac%7B-2mr%5E%7B%2A%7D%28t%29%5Comega%5E%7B%2A%7D%28t%29%7D%7BJ%5E%7B%2A%7D%28t%29%7D%5C%5C+0%260%260%261%5C%5C+0%262r%5E%7B%2A%7D%28t%29%5Comega%5E%7B%2A%7D%28t%29%26%5Comega%5E%7B%2A%7D%28t%29%5E2%260+%5Cend%7Bbmatrix%7D)

(1.32) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D%28t%29%3D%5Cbegin%7Bbmatrix%7D+0%260%5C%5C%5Cfrac%7B1%7D%7BJ%5E%7B%2A%7D%28t%29%7D%260%5C%5C0%260%5C%5C0%26%5Cfrac%7B1%7D%7Bm%7D+%5Cend%7Bbmatrix%7D)

(1.33) ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BA%7D%28t%29%5CDelta%5Cmathbf%7Bx%7D%2B%5Cmathbf%7BB%7D%28t%29%5CDelta%5Cmathbf%7Bu%7D%2C~~%5CDelta%5Cmathbf%7Bx%7D%5Cleft%28+t_0+%5Cright%29%3D%5Cmathbf%7Bx%7D_0-%5Cmathbf%7Bx%7D%5E%7B%2A%7D_0)

上述沿轨迹运动的线性化模型特别适合二自由度的控制器设计，这会在之后的文章里提及。使用二自由度控制的设计方式，最大优点在于用于调控平衡的反馈控制与用于导引轨迹的前馈控制可以分离独立设计。



参考文献：

Regelungstechnik B (Zustandsraummethoden) (WS 2019), Prof. Dr.-Ing. Knut Graichen

Lehrstuhl für Regelungstechnik, Friedrich-Alexander-Universität Erlangen-Nürnberg

# (二)状态变量的解和渐近稳定性

上一篇我们引入了时域的状态方程的描述方法，当引入状态变量以后，系统的特性就由多个耦合的状态变量的微分方程来描述，选择一些状态变量输出，就得到了可测的输出量。所以这些微分方程的解至关重要，接下来探讨一下状态变量的解的性质行为。

## **2.1 线性系统解的行为**

先考虑最简单的线性自治系统

(2.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BAx%7D%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0)

它的解可以借助一个所谓的(n x n)**转移矩阵** ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28t%29) 来表示

(2.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0)

所以如果状态转移矩阵已知，那我们就可以给出任意一个初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0) 得到任意时点的状态变量的解。那么怎么获得这个转移矩阵呢？我们可以使用**Picard迭代**逼近解，即所谓的不动点迭代，专门用来解常微分方程**初值问题**(Anfangswertproblem)。形如

(2.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%29%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5Crightarrow+~%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7Bx%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%28%5Ctau%29%29d%5Ctau)

迭代递推式如下

(2.4) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26%5Cmathbf%7Bx%7D%5E0%28t%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+%26%5Cmathbf%7Bx%7D%5Ek%28t%29%3D%5Cmathbf%7Bx%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7Bf%7D%5E%7Bk-1%7D%28%5Cmathbf%7Bx%7D%28%5Ctau%29%29d%5Ctau%2C~~k%3D1%2C2%2C...+%5Cend%7Balign%7D)

那么经由Picard迭代的线性自治系统的微分方程组的解

(2.5) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7Bx%7D%5E0%28t%29%26%3D%5Cmathbf%7Bx%7D_0%5C%5C+%5Cmathbf%7Bx%7D%5E1%28t%29%26%3D%5Cmathbf%7Bx%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7BAx%7D_0d%5Ctau%3D%28%5Cmathbf%7BI%2BA%7Dt%29%5Cmathbf%7Bx%7D_0%5C%5C+%5Cmathbf%7Bx%7D%5E2%28t%29%26%3D%5Cmathbf%7Bx%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7BA%7D%28%5Cmathbf%7BI%2BA%7D%5Ctau%29%5Cmathbf%7Bx%7D_0+d%5Ctau%3D%28%5Cmathbf%7BI%2BA%7Dt%2B%5Cmathbf%7BA%7D%5E2%5Cfrac%7Bt%5E2%7D%7B2%7D%29%5Cmathbf%7Bx%7D_0%5C%5C+%26%5Cvdots%5C%5C+%5Cmathbf%7Bx%7D%5Ek%28t%29%26%3D%28%5Cmathbf%7BI%2BA%7Dt%2B%5Cmathbf%7BA%7D%5E2%5Cfrac%7Bt%5E2%7D%7B2%7D%2B...%2B%5Cmathbf%7BA%7D%5Ek%5Cfrac%7Bt%5Ek%7D%7Bk%21%7D%29%5Cmathbf%7Bx%7D_0+%5Cend%7Balign%7D)

当 ![[公式]](https://www.zhihu.com/equation?tex=k%5Crightarrow%5Cinfty+) 时，![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5Ek%28t%29) 就会等效收敛到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29) ，所以转移矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28t%29) 就可以记作

(2.6) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28t%29%3D%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D%5Cmathbf%7BA%7D%5Ek%5Cfrac%7Bt%5Ek%7D%7Bk%21%7D%3De%5E%7B%5Cmathbf%7BA%7Dt%7D)

显然在一维的时候指数函数可以麦克劳林展开得到类似形式，所以把这个形式记作矩阵的指数形式。更多时候都会用这种指数形式 ![[公式]](https://www.zhihu.com/equation?tex=e%5E%7B%5Cmathbf%7BA%7Dt%7D) 来代替转移矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28t%29) 的写法。同时这样的转移矩阵保有了类似指数函数的基本性质：

- ①初值： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%280%29%3D%5Cmathbf%7BI%7D)
- ②乘积： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28a%2Bb%29%3D%5Cmathbf%7B%5CPhi%7D%28a%29%5Cmathbf%7B%5CPhi%7D%28b%29)
- ③可逆： ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%5E%7B-1%7D%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28-t%29)
- ④可微： ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7Bd%7D%7Bdt%7D%5Cmathbf%7B%5CPhi%7D%28t%29%3D%5Cmathbf%7BA%7D%5Cmathbf%7B%5CPhi%7D%28t%29)

显然，总是用级数展开的形式计算转移矩阵，太过繁琐，那么有没有简便的方法呢？答案是之前在经典控制里面使用的拉普拉斯变换！对(2.1)应用拉普拉斯变换 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%28s%29%3D%5Cmathcal%7BL%7D%5Cleft%5C%7B%5Cmathbf%7Bx%7D%28t%29+%5Cright%5C%7D)

(2.7) ![[公式]](https://www.zhihu.com/equation?tex=s%5Cmathbf%7BX%7D%28s%29-%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7BAX%7D%28s%29%5C%5C+%5Cmathbf%7BX%7D%28s%29%3D%5Cleft%28+s%5Cmathbf%7BI-A%7D+%5Cright%29%5E%7B-1%7D%5Cmathbf%7Bx%7D_0)

所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BX%7D%28s%29%3D%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%5Cmathbf%7Bx%7D_0) 就有s域的转移矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%3D%5Cmathcal%7BL%7D%5Cleft%5C%7B%5Cmathbf%7B%5CPhi%7D%28t%29+%5Cright%5C%7D+)

(2.8) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%3D%5Cleft%28+s%5Cmathbf%7BI-A%7D+%5Cright%29%5E%7B-1%7D%5C%5C)

举个例子

(2.9) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D+1%261%5C%5C+-9%261+%5Cend%7Bbmatrix%7D%5Cmathbf%7Bx%7D) ，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D+%3D%5Cbegin%7Bbmatrix%7D+1%261%5C%5C+-9%261+%5Cend%7Bbmatrix%7D)

(2.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%3D%5Cleft%28+s%5Cmathbf%7BI-A%7D+%5Cright%29%5E%7B-1%7D%3D%5Cbegin%7Bbmatrix%7D+s-1%26-1%5C%5C+9%26s-1+%5Cend%7Bbmatrix%7D%5E%7B-1%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cfrac%7Bs-1%7D%7B%28s-1%29%5E2%2B9%7D%26%5Cfrac%7B1%7D%7B%28s-1%29%5E2%2B9%7D%5C%5C+%5Cfrac%7B-9%7D%7B%28s-1%29%5E2%2B9%7D%26%5Cfrac%7Bs-1%7D%7B%28s-1%29%5E2%2B9%7D+%5Cend%7Bbmatrix%7D)

查表，不难求得原来的转移矩阵

(2.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5CPhi%7D%28t%29%3D%5Cmathcal%7BL%7D%5E%7B-1%7D%5Cleft%5C%7B+%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%5Cright%5C%7D+%3D%5Cbegin%7Bbmatrix%7D+e%5Etcos%283t%29%26%5Cfrac%7B1%7D%7B3%7De%5Etsin%283t%29%5C%5C+-3e%5Etsin%283t%29%26e%5Etcos%283t%29+%5Cend%7Bbmatrix%7D)

然而对于 ![[公式]](https://www.zhihu.com/equation?tex=n%3E3) 以上的式子想要用拉普拉斯变换这样确定转移函数的复杂度已经达到了必须用计算机求解的程度。

知道了转移矩阵，下一步就可以求非齐次的普通的线性时不变系统的解了

(2.12) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BAx%2BBu%7D%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0)

代入![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29)，同时根据性质③④

(2.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29%2B%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7B%5Cdot+x%7D_0%28t%29%26%3D%5Cmathbf%7BA%7D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29%2B%5Cmathbf%7BBu%7D%28t%29%5C%5C+%5Ccancel%7B%5Cmathbf%7BA%7D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29%7D%2B%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7B%5Cdot+x%7D_0%28t%29%26%3D%5Ccancel%7B%5Cmathbf%7BA%7D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29%7D%2B%5Cmathbf%7BBu%7D%28t%29%5C%5C+%5Cmathbf%7B%5Cdot+x%7D_0%28t%29%26%3D%5Cmathbf%7B%5CPhi%7D%28-t%29%5Cmathbf%7BBu%7D%28t%29+%5Cend%7Balign%7D)

用关于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%28t%29) 的Picard迭代

(2.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%28t%29%3D%5Cmathbf%7Bx%7D_0%280%29%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7B%5CPhi%7D%28-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau)

再根据性质②可得任意时刻的状态变量为

(2.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%280%29%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7B%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau)

所以这时候完整的线性时不变系统的表达为

(2.16) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cunderbrace%7B%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%280%29%7D_%7B%E9%BD%90%E6%AC%A1%E8%A7%A3%7D%2B%5Cunderbrace%7B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7B%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau%7D_%7B%E7%89%B9%E8%A7%A3%7D)

(2.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%28t%29%3D%5Cunderbrace%7B%5Cmathbf%7BC%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%280%29%7D_%7B%E8%87%AA%E6%B2%BB%E7%9A%84%E8%BF%90%E5%8A%A8%7D%2B%5Cunderbrace%7B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7BC%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau%7D_%7B%E5%8F%97%E6%8E%A7%E7%9A%84%E8%BF%90%E5%8A%A8%7D%2B%5Cunderbrace%7B%5Cmathbf%7BDu%7D%28t%29%7D_%7B%E7%9B%B4%E6%8E%A5%E6%8E%A7%E5%88%B6%7D)

可见，线性时不变系统最后输出的轨迹是**自治系统轨迹、输入控制轨迹**以及**直接控制**(Durchgriff) 三部分的线性叠加，线性时变系统的输出解轨迹也可以同样类比，不过本篇不加深入。

## **2.2 脉冲响应和阶跃响应**

对于检测系统性能来说，脉冲响应和阶跃响应既是最方便又是最重要的。让我们回忆一下狄拉克脉冲函数，狄拉克Δ函数

(2.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdelta%28t%29%3D%5Cbegin%7Bcases%7D+%5Clim_%7B%5Cvarepsilon+%5Crightarrow+0%7D%5Cfrac%7B1%7D%7B%5Cvarepsilon%7D%2C%260%5Cleq+t%5Cleq%5Cvarepsilon%5C%5C0%2C%26+%E5%85%B6%E4%BB%96+%5Cend%7Bcases%7D)

有基本性质 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%28t%29%3D%5Cint_%7B-%5Cinfty%7D%5E%7Bt%7D%5Cdelta%28%5Ctau%29d%5Ctau) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cdelta%28%5Ctau%29d%5Ctau%3D1) 以及卷积运算的性质 ![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7Df%28%5Ctau%29%5Cdelta%28a-%5Ctau%29d%5Ctau%3Df%28a%29) ，其中单位阶跃函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Csigma%28t%29%3D%5Cbegin%7Bcases%7D+0%2C%26+t%3C0%5C%5C1%2C%26+t%5Cgeq0+%5Cend%7Bcases%7D) 。

当初值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D) 并且没有直接控制部分( ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BD%3D0%7D) )，我们在脉冲函数的输入下 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29%3D%5Cleft%5B+%5Cdelta%28t%29%2C%5Cdelta%28t%29...%5Cdelta%28t%29+%5Cright%5D%5ET) ,定义**权重函数**(Gewichtsfunktionen) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%7D%28t%29%3D%5Cmathbf%7BC%5CPhi%7D%28t%29%5Cmathbf%7BB%7D) ,则有输出响应

(2.19) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%28t%29%3D%5Cint_%7B0%7D%5E%7Bt%7D%5Cunderbrace%7B%5Cmathbf%7Bg%7D%28t-%5Ctau%29%7D_%7B%5Cmathbf%7BC%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BB%7D%7D%5Cmathbf%7Bu%7D%28%5Ctau%29d%5Ctau)

可见，系统输出的行为正好是一个权重函数和输入信号的卷积运算。这也符合我们对s域的认知，因为在s域里，输出信号等于输入信号乘以传递函数 ![[公式]](https://www.zhihu.com/equation?tex=Y%28s%29%3DG%28s%29U%28s%29) ，对应的时域关系恰为卷积。

当输入为单位阶跃函数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29%3D%5Cleft%5B+%5Csigma%28t%29%2C%5Csigma%28t%29...%5Csigma%28t%29+%5Cright%5D%5ET) 时，且 ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA%7D%29%5Cne0) 会有

(2.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%28t%29%3D%5Cmathbf%7Bh%7D%28t%29%3D%5Cmathbf%7BCA%7D%5E%7B-1%7D%28%5Cmathbf%7B%5CPhi%7D%28t%29-%5Cmathbf%7BI%7D%29%5Cmathbf%7BB%7D)

## **2.3 一般形式变换为对角型**

实际上对于一个动态系统的状态变量的选择是不唯一的，不同的选择会导致不同的状态方程组，但是它们经过还原，仍然能得到同一个系统的微分方程的形式。一般形式下的系数矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 常常未解除耦合，这意味着每一行的状态变量都由其他状态变量一起表示，这样不能够直观看出特征值。那么什么情况下，能够在一个特定的坐标下的状态方程直接看出特征值呢？

自然是只包含矩阵特征信息的对角形式啦！

我们选取新坐标，新的状态变量， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bz%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bn%7D) ，设一个正则变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D) ，使得

(2.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bz%3DTx+%5Cquad++%5Cquad+x%3DT%5E%7B-1%7Dz%7D+%5Cquad++%5Cquad%5Cmathbf%7B%5Ctilde+A%7D%3D%5Cmathbf%7BTAT%7D%5E%7B-1%7D%3Ddiag%28%5Clambda_i%29)

那么会有

(2.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+z%7D%3D%5Cmathbf%7BT%5Cdot+x%7D%26%3D%5Cunderbrace%7B%5Cmathbf%7BTAT%7D%5E%7B-1%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D%7D%5Cmathbf%7Bz%7D%2B%5Cunderbrace%7B%5Cmathbf%7BTB%7D%7D_%7B%5Cmathbf%7B%5Ctilde+B%7D%7D%5Cmathbf%7Bu%7D%2C~~%5Cmathbf%7Bz%7D%280%29%3D%5Cmathbf%7Bz%7D_0%3D%5Cmathbf%7BTx%7D_0%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cunderbrace%7B%5Cmathbf%7BCT%7D%5E%7B-1%7D%7D_%7B%5Cmathbf%7B%5Ctilde+C%7D%7D%5Cmathbf%7Bz%7D%2B%5Cunderbrace%7B%5Cmathbf%7BD%7D%7D_%7B%5Cmathbf%7B%5Ctilde+D%7D%7D%5Cmathbf%7Bu%7D+%5Cend%7Balign%7D)

显然这样的线性变换并不会改变系数矩阵原有的特征值，所以

(2.23) ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Cmathbf%7BA%7D%29%3Ddet%28%5Cmathbf%7B%5Ctilde+A%7D%29%3Ddet%28%5Cmathbf%7BTAT%7D%5E%7B-1%7D%29%5C%5C+det%28%5Clambda%5Cmathbf%7BI-A%7D%29%3Ddet%28%5Clambda%5Cmathbf%7BI-TAT%7D%5E%7B-1%7D%29)

根据 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7Bx%7D_0%28t%29) ，不难知道新的转移矩阵为

(2.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde%5CPhi%7D%28t%29%3D%5Cmathbf%7BT%7D%5E%7B-1%7D%5Cmathbf%7B%5CPhi%7D%28t%29%5Cmathbf%7BT%7D%3D%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D%5Cmathbf%7B%5Ctilde+A%7D%5Ek%5Cfrac%7Bt%5Ek%7D%7Bk%21%7D%3D%5Cbegin%7Bbmatrix%7D+e%5E%7B%5Clambda_1t%7D%260%26%5Ccdots%260%5C%5C+0%26e%5E%7B%5Clambda_2t%7D%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C+0%260%26%5Ccdots%26e%5E%7B%5Clambda_nt%7D+%5Cend%7Bbmatrix%7D)

## **2.4 状态变量的渐近稳定性**

> 定义2.1 **渐近稳定性**
> 线性系统如果对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cforall+~%5Cmathbf%7Bx%7D%280%29%5Cne+%5Cmathbf%7B0%7D) 都有 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%7B%5Cleft%7C+%5Cleft%7C+%5Cmathbf%7Bx%7D%28t%29+%5Cright%7C+%5Cright%7C%7D%3D0) ，则称系统是渐近稳定的。

直观来看，渐近稳定性表示任意起始位置，在通过有限时间的演化和运动，最终都要趋向于0，这个0对于系统的所有状态变量来说，就是一个平衡点。意味着所有的状态变量都在这里平衡，最终位置在这，最终速度也会变为0，是一个任何扰动都要在此收敛的地方。我们注意到，转移矩阵在决定解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29) 的形式中会扮演重要角色。其他一般情况下的解无非是对角型的线性变换，即线性组合。

对任意 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29%3D%5Cleft%5B+x_1%28t%29%2C...%2Cx_n%28t%29++%5Cright%5D%5ET) ，它的解应为下列成分的线性组合 ![[公式]](https://www.zhihu.com/equation?tex=t%5Eke%5E%7B%5Clambda+t%7D%2C%5Cqquad+t%5Eke%5E%7B%5Calpha+t%7Dcos%28%5Comega+t%29%3D%5Cmu+%5Ccdot+t%5Eke%5E%7B%28%5Calpha%2Bj%5Comega+%29t%7D%2C%5Cqquad+t%5Eke%5E%7B%5Calpha+t%7Dsin%28%5Comega+t%29%3D%5Cnu%5Ccdot+t%5Eke%5E%7B%28%5Calpha%2Bj%5Comega+%29t%7D)

所以复数特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda%3D%5Calpha%5Cpm+j%5Comega) 和 ![[公式]](https://www.zhihu.com/equation?tex=0%5Cleq+k%5Cleq+n-1) 就决定了解的特性。因为特征值虚部的幅值受限，它只会给系统带来振荡的行为，所以真正决定解是收敛还是发散的原因还在实部，也就是这个 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha) 。如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%3E0) 主导部分都是发散的，所以系统不稳定；如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%3C0) ，所有成分都是收敛的，那么系统一定会稳定下来；如果 ![[公式]](https://www.zhihu.com/equation?tex=%5Calpha%3D0) ，系统会有振荡部分，无法渐近稳定。

> **定理2.1 渐近稳定性**
> 对平衡点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_R%3D+%5Cmathbf%7B0%7D) 的线性系统，恰为渐近稳定，当且仅当所有来自系数矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 的特征值均有负实部。这等价于 ![[公式]](https://www.zhihu.com/equation?tex=Re%5Cleft%28+%5Clambda_i+%5Cright%29%3C0%EF%BC%8C%5Cqquad+1%5Cleq+i%5Cleq+n) 。

![img](https://pic4.zhimg.com/80/v2-36758775c6191ededde59a66954e08d3_hd.jpg)图2.1 不同特征值对应的状态变量解的行为

系统的状态变量会有决定系统稳定的行为，但是我们还可以从另一个视角，系统的输入输出的直接关系，也就是传递函数，来看系统的整体行为，这就是下一章我们要探讨的内容。



# (三)输入输出变量的稳定性

渐近稳定是状态变量的特性，如果再度考虑系统的输入输出行为，这个输入输出变量的稳定性可以由**单变量输入单变量输出**(Single-Input-Single-Output, SISO)时传递函数以及**多变量输入输出**(Multi-Input-Multi-Output, MIMO)的传递矩阵来描述。

## **3.1传递函数和传递矩阵**

当 ![[公式]](https://www.zhihu.com/equation?tex=m%3Dp%3D1) 时，普通的线性时不变系统退化为SISO系统

(3.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2Bb%7Du%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+y%26%3D%5Cmathbf%7Bc%5ETx%7D%2Bdu+%5Cend%7Balign%7D)

对其进行拉普拉斯变换，有

(3.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+s%5Cmathbf%7BX%7D%28s%29-%5Cmathbf%7Bx%7D_0%26%3D%5Cmathbf%7BAX%7D%28s%29%2B%5Cmathbf%7Bb%7DU%28s%29%5C%5C+Y%28s%29%26%3D%5Cmathbf%7Bc%5ETX%7D%28s%29%2BdU%28s%29+%5Cend%7Balign%7D)

所以

(3.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7BX%7D%28s%29%26%3D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bx%7D_0%2B%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7DU%28s%29%5C%5C+Y%28s%29%26%3D%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bx%7D_0%2B%28%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D%2Bd%29U%28s%29+%5Cend%7Balign%7D)

当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D) 时，比较 ![[公式]](https://www.zhihu.com/equation?tex=Y%28s%29%3DG%28s%29U%28s%29) 和上式，可得传递函数 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29)

> **定理3.1 传递函数**
> 线性时不变的SISO系统的传递函数 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29) 有
> ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BZ%28s%29%7D%7BN%28s%29%7D%3D%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D%2Bd%3D%5Cmathbf%7Bc%5ET%7D%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%5Cmathbf%7Bb%7D%2Bd)

![[公式]](https://www.zhihu.com/equation?tex=Z%28s%29)为传递函数的分子多项式， ![[公式]](https://www.zhihu.com/equation?tex=N%28s%29) 是传递函数分母多项式。两者互质，且有微分度 ![[公式]](https://www.zhihu.com/equation?tex=deg%28Z%28s%29%29%5Cleq+deg%28N%28s%29%29%5Cleq+n) 。而逆矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D) 可以表示为伴随矩阵和行列式的分式

(3.4) ![[公式]](https://www.zhihu.com/equation?tex=%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%3D%5Cfrac%7Badj%28s%5Cmathbf%7BI-A%7D%29%7D%7Bdet%28s%5Cmathbf%7BI-A%7D%29%7D)

所以传递函数也可以写成以下形式

(3.5) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BZ%28s%29%7D%7BN%28s%29%7D%3D%5Cfrac%7B%5Cmathbf%7Bc%5ET%7Dadj%28s%5Cmathbf%7BI-A%7D%29%5Cmathbf%7Bb%7D%2Bd%5Ccdot+det%28s%5Cmathbf%7BI-A%7D%29%7D%7Bdet%28s%5Cmathbf%7BI-A%7D%29%7D)

![[公式]](https://www.zhihu.com/equation?tex=det%28s%5Cmathbf%7BI-A%7D%29) 就对应了系统的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 的特征多项式，传递函数的极点恰为矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 的特征值，但是反过来传递函数的极点不一定为动态矩阵的特征值，这一点在之后说明。分母多项式 ![[公式]](https://www.zhihu.com/equation?tex=N%28s%29) 最高阶数为 ![[公式]](https://www.zhihu.com/equation?tex=n) 。分子多项式 ![[公式]](https://www.zhihu.com/equation?tex=Z%28s%29) 最高阶数为 ![[公式]](https://www.zhihu.com/equation?tex=n) ，或当直接控制系数 ![[公式]](https://www.zhihu.com/equation?tex=d%3D0) ， 最高阶数为 ![[公式]](https://www.zhihu.com/equation?tex=n-1) 。因为在计算时可知，分子部分计算伴随矩阵时会从原矩阵 ![[公式]](https://www.zhihu.com/equation?tex=s%5Cmathbf%7BI-A%7D) 中取出 ![[公式]](https://www.zhihu.com/equation?tex=n-1) 行来计算余子式因此最高阶数仅为 ![[公式]](https://www.zhihu.com/equation?tex=n-1)。

现在我们继续推广到MIMO的情况。

(3.6) ![[公式]](https://www.zhihu.com/equation?tex=+%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2BBu%7D%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BCx%2BDu%7D+%5Cend%7Balign%7D)

易知，上述推导过程类似，所以直接给出当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D) 时，有传递函数矩阵

(3.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BG%7D%28s%29%3D%5Cmathbf%7BC%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7BB%7D%2B%5Cmathbf%7BD%7D%3D%5Cmathbf%7BC%7D%5Cmathbf%7B%5Chat+%5CPhi%7D%28s%29%5Cmathbf%7BB%7D%2B%5Cmathbf%7BD%7D)

那么 ![[公式]](https://www.zhihu.com/equation?tex=%28p%5Ctimes+m%29) 传递矩阵为

(3.8) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BG%7D%28s%29%3D%5Cbegin%7Bbmatrix%7D+G_%7B11%7D%28s%29%26%5Ccdots%26G_%7B1m%7D%28s%29%5C%5C+%5Cvdots%26%5Cddots%26%5Cvdots%5C%5CG_%7Bp1%7D%28s%29%26%5Ccdots%26G_%7Bpm%7D%28s%29%5Cend%7Bbmatrix%7D) 其中有 ![[公式]](https://www.zhihu.com/equation?tex=+G_%7Bij%7D%28s%29%3D%5Cfrac%7BY_i%28s%29%7D%7BU_j%28s%29%7D)

## 3.2 传递函数到状态变量的可实现性

之前讨论了怎么从状态变量推出传递函数，那么现在能否反过来从传递函数直接推出状态方程表达呢？这就是一个传递函数到状态变量的可实现性的问题，原则上，会有无数种可行的构造，而实践上，应该找到那些最小代价的实现方式，比如最小维度的。状态变量数量尽量少，或者说，问题转化为：想要实现一个传递函数的所需的最少状态变量维数的存在性。

> **定理3.2 传递函数的可实现性**
> 一个传递函数 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BZ%28s%29%7D%7BN%28s%29%7D)是可实现的，当且仅当有正确的微分度，即微分度 ![[公式]](https://www.zhihu.com/equation?tex=deg%28Z%28s%29%29%5Cleq+deg%28N%28s%29%29) 。

因为实现方式不唯一，所以在本章里只讨论两种规范的最小实现形式。并考察这样的传递函数

(3.9) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BY%28s%29%7D%7BU%28s%29%7D%3D%5Cfrac%7BZ%28s%29%7D%7BN%28s%29%7D%3D%5Cfrac%7Bb_ns%5En%2Bb_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Bb_1s%2Bb_0%7D%7Bs%5En%2Ba_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Ba_1s%2Ba_0%7D)

其中 ![[公式]](https://www.zhihu.com/equation?tex=Z%28s%29) 和 ![[公式]](https://www.zhihu.com/equation?tex=N%28s%29) 互质且 ![[公式]](https://www.zhihu.com/equation?tex=a_n%3D1) 。



- **第一标准型/能控标准型**(1.Standardform bzw. Regelungsnormalform)

为了推导出能控标准型，我们引入辅助状态变量 ![[公式]](https://www.zhihu.com/equation?tex=z%28t%29) ，定义

(3.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7BY%28s%29%7D%7BZ%28s%29%7D%3Db_ns%5En%2Bb_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Bb_1s%2Bb_0)

(3.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7BZ%28s%29%7D%7BU%28s%29%7D%3D%5Cfrac%7B1%7D%7Bs%5En%2Ba_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Ba_1s%2Ba_0%7D)

显然(3.10)乘以(3.11)便可得到 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BY%28s%29%7D%7BU%28s%29%7D) ，(3.11)对应的微分方程为

(3.12) ![[公式]](https://www.zhihu.com/equation?tex=z%5E%7B%28n%29%7D%2Ba_%7Bn-1%7Dz%5E%7B%28n-1%29%7D%2B...%2Ba_1%5Cdot+z%2Ba_0z%3Du)

因而选择状态变量![[公式]](https://www.zhihu.com/equation?tex=x_1%3Dz%2C~~x_2%3D%5Cdot+z%2C~~...~~x_n%3Dz%5E%7B%28n-1%29%7D) ，可列出所有一阶微分方程

(3.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26%5Cdot+x_1~~~%3Dx_2%5C%5C+%26%5Cdot+x_2~~~%3Dx_3%5C%5C+%26%5Cqquad+%5Cvdots%5C%5C+%26%5Cdot+x_%7Bn-1%7D%3Dx_%7Bn%7D%5C%5C+%26%5Cdot+x_n~~~~%3D-a_0x_1-a_1x_2-...-a_%7Bn-1%7Dx_%7Bn%7D%2Bu+%5Cend%7Balign%7D)

![img](https://pic3.zhimg.com/80/v2-b510fc8045bd1dec056ad49ac9fb9fe6_hd.jpg)图3.1 能控标准型的信号框图

式(3.10)对应的时域表达为

(3.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+y%26%3Db_nz%5E%7B%28n%29%7D%2Bb_%7Bn-1%7Dz%5E%7B%28n-1%29%7D%2B...%2Bb_1%5Cdot+z~~%2Bb_0z%5C%5C+%26%3Db_n%5Cdot+x_n~~%2Bb_%7Bn-1%7Dx_%7Bn%7D~~~~~%2B...%2Bb_1+x_2%2Bb_0+x_1%5C%5C+%26%3Db_n%28-a_0x_1-a_1x_2-...-a_%7Bn-1%7Dx_%7Bn%7D%2Bu%29%2Bb_%7Bn-1%7Dx_%7Bn%7D%2B...%2Bb_1+x_2%2Bb_0+x_1%5C%5C+%26%3D%5Cunderbrace%7B%28b_0-a_0b_n%29%7D_%7Bc_1%7Dx_1%2B...%2B%5Cunderbrace%7B%28b_%7Bn-1%7D-a_%7Bn-1%7Db_n%29%7D_%7Bc_n%7Dx_n%2Bb_nu+%5Cend%7Balign%7D)

最后汇总成矩阵形式，应有

(3.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cdot+x_1%5C%5C+%5Cdot+x_2%5C%5C+%5Cvdots%5C%5C+%5Cdot+x_%7Bn-1%7D%5C%5C+%5Cdot+x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Cdot+x%7D%7D%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D++0%261%260%26%5Ccdots%260%5C%5C+0%260%261%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cddots%26%5Cvdots%26%5C%5C+0%260%26%5Ccdots%260%261%5C%5C+-a_0%26-a_1%26%5Ccdots%26-a_%7Bn-2%7D%26-a_%7Bn-1%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BA%7D%7D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+x_2%5C%5C+%5Cvdots%5C%5C++x_%7Bn-1%7D%5C%5C+x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B+x%7D%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%5C%5C+0%5C%5C+%5Cvdots%5C%5C+0%5C%5C+1+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bb%7D%7Du%5C%5C+y%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7Dc_1%26%5Ccdots%26c_n%5C%5C++%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bc%5ET%7D%7D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+%5Cvdots%5C%5C++x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bx%7D%7D%2B%5Cunderbrace%7Bb_n%7D_du+%5Cend%7Balign%7D)

于是(3.9)代表的传递函数的直接实现方式，即可按照第一标准型或者能控标准型表示。这种表现形式与系统的能控性紧密相关，这会在下一章讨论。

举个例子， ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7Bs%28s%5E2%2B3%29%7D%7B%28s-1%29%282s%2B1%29%28s-3%29%7D) ，求其第一标准型的状态方程。

为了能够直接读出来，先变形为标准形式

(3.16) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7Bs%5E3%2B3s%7D%7B2s%5E3-7s%5E2%2B2s%2B3%7D%3D%5Cfrac%7B%5Cfrac%7B1%7D%7B2%7Ds%5E3%2B%5Cfrac%7B3%7D%7B2%7Ds%7D%7Bs%5E3-%5Cfrac%7B7%7D%7B2%7Ds%5E2%2Bs%2B%5Cfrac%7B3%7D%7B2%7D%7D)

于是可以直接导出

(3.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cbegin%7Bbmatrix%7D+%5Cdot+x_1%5C%5C+%5Cdot+x_2%5C%5C+%5Cdot+x_3+%5Cend%7Bbmatrix%7D+%26%3D%5Cbegin%7Bbmatrix%7D++0%261%260%5C%5C+0%260%261%5C%5C+-%5Cfrac%7B3%7D%7B2%7D%26-1%26%5Cfrac%7B7%7D%7B2%7D+%5Cend%7Bbmatrix%7D+%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+x_2%5C%5C++x_3+%5Cend%7Bbmatrix%7D%2B%5Cbegin%7Bbmatrix%7D0%5C%5C+0%5C%5C+1+%5Cend%7Bbmatrix%7Du%5C%5C+y%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0-%5Cfrac%7B3%7D%7B2%7D%5Ccdot%5Cfrac%7B1%7D%7B2%7D%2C%26%5Cfrac%7B3%7D%7B2%7D-1%5Ccdot%5Cfrac%7B1%7D%7B2%7D%2C%260%2B%5Cfrac%7B7%7D%7B2%7D%5Ccdot%5Cfrac%7B1%7D%7B2%7D%5C%5C++%5Cend%7Bbmatrix%7D%7D_%7B%5B-%5Cfrac%7B3%7D%7B4%7D%5Cquad1%5Cquad%5Cfrac%7B7%7D%7B4%7D%5D%7D+%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+x_2%5C%5C++x_3+%5Cend%7Bbmatrix%7D%2B%5Cfrac%7B1%7D%7B2%7Du+%5Cend%7Balign%7D)



- **第二标准型/能观标准型**(2.Standardform bzw. Beobachtungsnormalform)

为了推导第二种实现方式，我们可以使用传递函数的另一种表达

(3.18) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D%2Bd)

因为 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29) 此时为关于 ![[公式]](https://www.zhihu.com/equation?tex=s) 的标量有理函数，易知

(3.19) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%28G%28s%29%29%5ET%3D%5Cleft%28+%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D%2Bd+%5Cright%29%5ET%3D%5Cmathbf%7Bb%5ET%7D%28s%5Cmathbf%7BI-A%5ET%7D%29%5E%7B-1%7D%5Cmathbf%7Bc%7D%2Bd)

所以我们立刻能求出同一传递函数的另一形式

(3.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA%5ETx%2Bc%7Du%2C~~%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+y%26%3D%5Cmathbf%7Bb%5ETx%7D%2Bdu+%5Cend%7Balign%7D)

(3.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cdot+x_1%5C%5C+%5Cdot+x_2%5C%5C+%5Cvdots%5C%5C+%5Cdot+x_%7Bn-1%7D%5C%5C+%5Cdot+x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Cdot+x%7D%7D%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D++0%26%5Ccdots%26%5Ccdots%260%26-a_0%5C%5C+1%260%26%5Ccdots%260%26-a_1%5C%5C+%5Cvdots%261%26%5Cddots%26%5Cvdots%26%5Cvdots%26%5C%5C+0%260%26%5Cddots%260%26-a_%7Bn-2%7D%5C%5C+0%260%26%5Ccdots%261%26-a_%7Bn-1%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BA%5ET%7D%7D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+x_2%5C%5C+%5Cvdots%5C%5C++x_%7Bn-1%7D%5C%5C+x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B+x%7D%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+c_1%5C%5C+c_2%5C%5C+%5Cvdots%5C%5C+c_%7Bn-1%7D%5C%5C+c_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bc%7D%7Du%5C%5C+y%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%260%26%5Ccdots%260%261%5C%5C++%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bb%5ET%7D%7D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7Dx_1%5C%5C+%5Cvdots%5C%5C++x_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bx%7D%7D%2B%5Cunderbrace%7Bb_n%7D_du+%5Cend%7Balign%7D)

![img](https://pic1.zhimg.com/80/v2-2b443f168d3b271357bd53b790d9747c_hd.jpg)图3.2 能观标准型的信号框图

于是(3.9)代表的传递函数的另一种实现方式，即可按照第二标准型或者能观标准型表示，第二种表示方法的系统与第一种的系统对偶。这种表现形式与系统的能观性紧密相关，这也会在下一章讨论。

## 3.3输入输出稳定性

在上一章我们考察了线性时不变系统状态变量的渐近稳定性，实际上还有另一种**输入输出的稳定性**(Ein-/Ausgangsstabilität)值得探讨，这在英语里又被称为“有界输入有界输出稳定性”(Bounded-Input-Bounded-Output, BIBO)，即BIBO稳定性。

> **定义3.1 输入输出稳定性**
> 一个线性时不变的单输入单输出系统被称为输入输出稳定，当初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D) 时，对每一个受限的输入信号 ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29)，都有一个受限的输出信号 ![[公式]](https://www.zhihu.com/equation?tex=y%28t%29) 。这等价于 ![[公式]](https://www.zhihu.com/equation?tex=sup%28%5Cleft%7C+u%28t%29%5Cright%7C%29%3Da%2C~~+a%5Cin+R%5E%2B) ; ![[公式]](https://www.zhihu.com/equation?tex=sup%28%5Cleft%7C+y%28t%29+%5Cright%7C%29%3Db%2C~~+b%5Cin+R%5E%2B)

显然输入输出稳定性可以借助脉冲响应判断分析，而传递函数 ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29) 的时域表示，即权重函数 ![[公式]](https://www.zhihu.com/equation?tex=g%28t%29) 。

(3.22) ![[公式]](https://www.zhihu.com/equation?tex=g%28t%29%3D%5Cmathcal%7BL%7D%5E%7B-1%7D+%5Cleft%5C%7B+G%28s%29%5Ccdot1+%5Cright%5C%7D%3D%5Cmathbf%7Bc%5ET%7D%5Cmathbf%7B+%5CPhi%7D%28t%29%5Cmathbf%7Bb%7D%2C%5Cqquad+t%3E0)

> **定理3.3 输入输出稳定性-脉冲响应判据**
> 一个线性时不变的单输入单输出系统被称为输入输出稳定，当它的脉冲响应时绝对可积的，即
> (3.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B0%7D%5E%7B%5Cinfty%7D%5Cleft%7C+g%28t%29+%5Cright%7Cdt%5Cleq+M_g%2C%5Cqquad+M_g%5Cin+R%5E%2B)

因为输入输出稳定性实际上就是通过传递函数表现的，当传递函数的幅值表现为发散时，系统自然无法稳，当传递函数的幅值收敛时，系统自然可以稳定。而通过传递函数的极点来检验输入输出稳定性是另一种更常用的方法。

> **定理3.4 输入输出稳定性-传递函数判据**
> 一个线性时不变的单输入单输出系统被称为输入输出稳定，当它的传递函数的所有的极点 ![[公式]](https://www.zhihu.com/equation?tex=s_i%3D%5Calpha_i%2Bj%5Comega_i) 有且仅有负的实部，这等价于 ![[公式]](https://www.zhihu.com/equation?tex=Re%5Cleft%5C%7B+s_i%5Cright%5C%7D%3D%5Calpha_i%3C0)

因为传递函数的极点恰好也正为对应的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 的特征值，所以系统状态变量的渐近稳定性也能推出系统输入输出稳定性。而反过来的话，当且仅当系统的传递函数的阶数正好为系统的阶数，会有系统输入输出稳定性则系统状态变量的渐近稳定性的推论。

## 3.4 对系统的零点的解释

传递函数的零点虽然不会影响系统的稳定性，但是会对系统运动的速度和幅值产生影响。

- **零点的阻断性**

考察传递函数

(3.24) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7BZ%28s%29%7D%7BN%28s%29%7D%3D%5Cfrac%7B%5Cprod_%7Bi%3D1%7D%5E%7Bm%7D%28s-n_i%29%7D%7B%5Cprod_%7Bi%3D1%7D%5E%7Bn%7D%28s-p_i%29%7D)

当从频域，即 ![[公式]](https://www.zhihu.com/equation?tex=s) 域考察时，输入信号的频率正好为一个传递函数的零点 ![[公式]](https://www.zhihu.com/equation?tex=s%3Dn_%7B0%2Ci%7D) ，那么自然传递函数的值就为0，系统有输入却没有输出，这即所谓的**零点的阻断性**(Blockade-Eigenschaft)。

(3.25) ![[公式]](https://www.zhihu.com/equation?tex=G%28n_%7B0%2Ci%7D%29%3D0)

现在我们继续考察一个确定的实零点 ![[公式]](https://www.zhihu.com/equation?tex=%5Ceta_%7B0%7D) ，其对应的输入信号为 ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29%3DCe%5E%7B%5Ceta_%7B0%7Dt%7D) 或者 ![[公式]](https://www.zhihu.com/equation?tex=U%28s%29%3D%5Cfrac%7BC%7D%7Bs-%5Ceta_%7B0%7D%7D) ，那么当常数 ![[公式]](https://www.zhihu.com/equation?tex=C%3E0) 时，这样一个输入信号进来系统对应的响应为

(3.26) ![[公式]](https://www.zhihu.com/equation?tex=Y%28s%29%3DG%28s%29U%28s%29%3D%5Cfrac%7B%5Cprod_%7Bi%3D1%7D%5E%7Bm-1%7D%28s-n_i%29%5Ccdot+%5Ccancel%7B%28s-%5Ceta_%7B0%7D%29%7D%7D%7BN%28s%29%7D%5Ccdot%5Cfrac%7BC%7D%7B%5Ccancel%7Bs-%5Ceta_%7B0%7D%7D%7D)

显然这样的动态输入 ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29%3DCe%5E%7B%5Ceta_%7B0%7Dt%7D) 是不能通过系统传递并输出的。这种零点的阻断性主要会应用在信号技术里，比如说notch filter，为了把一个极窄带宽内的频率给滤掉。



**例3.1 倒立摆小车系统**

让我们再度考察之前第一章里面出现过的倒立摆小车，我们使用在平衡点线性化后的模型，其状态变量为 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bx%7D%3D%5Cleft%5B+%5CDelta%5Cphi%2C~%5CDelta%5Cdot%5Cphi%2C~%5CDelta+x_w%2C~%5CDelta%5Cdot+x_w+%5Cright%5D%5E%7BT%7D) ，并且让输出选为 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta+y%3D%5CDelta+x_w%2Bl%5CDelta%5Cphi) ，那么其完整线性时不变的状态方程为

(3.27) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cbegin%7Bbmatrix%7D+0++++++%261+%260%26+0++++++%5C%5C+%5Cfrac%7B6g%28m%2BM%29%7D%7B%28m%2B4M%29l%7D%260++++++%26+0%26+0%5C%5C+0%260%260%261%5C%5C+-%5Cfrac%7B3mg%7D%7Bm%2B4M%7D%260%260%260+%5Cend%7Bbmatrix%7D%5CDelta%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D+0+++++%5C%5C+-%5Cfrac%7B6%7D%7B%28m%2B4M%29l%7D+%5C%5C++0%5C%5C+%5Cfrac%7B4%7D%7Bm%2B4M%7D+%5Cend%7Bbmatrix%7D%5CDelta+u%5C%5C+%5CDelta+y%26%3D%5Cbegin%7Bbmatrix%7D+l%260%261%260%5Cend%7Bbmatrix%7D%5CDelta%5Cmathbf%7B+x%7D+%5Cend%7Balign%7D)

其传递函数为

(3.28) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7B%5CDelta+Y%28s%29%7D%7B%5CDelta+U%28s%29%7D%3D%5Cfrac%7B2ls%5E2%2B6g%7D%7B-l%28m%2B4M%29s%5E4%2B6g%28m%2B4M%29s%5E2%7D)

显然，它有两个共轭零点 ![[公式]](https://www.zhihu.com/equation?tex=n_%7B0%2C1%7D%3Dj%5Comega%2C~~n_%7B0%2C2%7D%3D-j%5Comega%2C~~~%5Comega%3D%5Csqrt%7B%5Cfrac%7B6g%7D%7B2l%7D%7D) 则对应的零点频率为输入信号可选为

(3.29) ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cleft%28+e%5E%7Bn_%7B0%2C1%7Dt%7D%2Be%5E%7Bn_%7B0%2C2%7Dt%7D+%5Cright%29%3Dcos%28%5Comega+t%29)

这样，这个信号输入就不会有有效输出了。特别情况下，还可以通过合适的初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bx%7D%280%29%3D%5CDelta%5Cmathbf%7Bx%7D_0) ，实现输出信号在输入信号为 ![[公式]](https://www.zhihu.com/equation?tex=u%28t%29%3Dcos%28%5Comega+t%29) 时，对小车和摆产生一个持续振荡，而摆的最高处仍然平衡，下图展示了半个周期 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B+0%2C%5Cfrac%7B%5Cpi%7D%7B%5Comega%7D+%5Cright%5D) 的运动轨迹。

![img](https://pic4.zhimg.com/80/v2-e3090fe82823d73d39849f306c487eaf_hd.jpg)图3.3 在零点频率的稳态输出

- **相反的输入输出行为**

当零点落在复平面右边时，会有一些行为会对控制造成妨碍，即 ![[公式]](https://www.zhihu.com/equation?tex=Re%28n_%7Bi%7D%29%3E0) 。这样的系统被称为**非最小相位系统**(Nichtminimalphasige Systeme)，比如只有一个零点且为非最小相位零点 ![[公式]](https://www.zhihu.com/equation?tex=s%3Dc%2C~~~c%3E0) ，系统的对应的传递函数为

(3.30) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7Bs-c%7D%7Bs%5En%2Ba_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Ba_1s%2Ba_0%7D)

其分母用一个Hurwitz多项式表示，代表所有极点/特征根都是渐进稳定的。考虑阶跃响应，并对其使用初值定理

(3.31) ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7Dy%28t%29%3D%5Clim_%7Bs+%5Crightarrow+%5Cinfty%7DsG%28s%29U%28s%29)

易知对于 ![[公式]](https://www.zhihu.com/equation?tex=n-2) 阶导数都应有 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7Dy%5E%7B%28i%29%7D%28t%29%3D%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7D%5Cfrac%7Bd%5E%7B~i%7D%7D%7Bdt%5Ei%7Dy%28t%29%3D0) , ![[公式]](https://www.zhihu.com/equation?tex=i%3D1%2C2%2C...n-2)

(3.32) ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7Dy%5E%7B%28i%29%7D%28t%29%3D%5Clim_%7Bs+%5Crightarrow+%5Cinfty%7Ds%5E%7Bi%2B1%7DG%28s%29U%28s%29)

应有阶跃响应的输出信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7Dh%5E%7B%28i%29%7D%28t%29%3D0) ,且初值为

(3.33) ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+0%5E%2B%7Dh%5E%7B%28n-1%29%7D%28t%29%3D%5Clim_%7Bs+%5Crightarrow+%5Cinfty%7Ds%5E%7Bn-1%7DG%28s%29U%28s%29%3D%5Clim_%7Bs+%5Crightarrow+%5Cinfty%7D%5Cfrac%7Bs%5E%7Bn-1%7D%28s-c%29%7D%7Bs%5En%2Ba_%7Bn-1%7Ds%5E%7Bn-1%7D%2B...%2Ba_1s%2Ba_0%7D%3D1)

但是当我们考察这个系统的终值时，它却是负值

(3.34) ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7Dh%28t%29%3D%5Clim_%7Bs+%5Crightarrow+0%7DsG%28s%29U%28s%29%3D-%5Cfrac%7Bc%7D%7Ba_0%7D)

这意味着初值导数为正 ![[公式]](https://www.zhihu.com/equation?tex=y%5E%7B%28n-1%29%7D%28t%29%3Dh%5E%7B%28n-1%29%7D%28t%29%3D1) ，终态却反转为负值了，也就是说系统响应初期会先经历一次正负号反转，而且照这样推论，如果正的零点越多，系统到终态稳定值之前要经历越多次反转和正负号变动。所以这种多次反向的特征行为是非最小相位系统的基本特性。

**例3.2 经历反转的非最小相位系统**

考察一个二阶的传递函数，它有零点 ![[公式]](https://www.zhihu.com/equation?tex=n_0%3Dc) 和极点 ![[公式]](https://www.zhihu.com/equation?tex=p_1%3D-1%2Cp_2%3D-2) 。下面将展示最小相位系统 ![[公式]](https://www.zhihu.com/equation?tex=%28c%3C0%29) 和非最小相位系统 ![[公式]](https://www.zhihu.com/equation?tex=%28c%3E0%29) 的阶跃响应。归一化以后易知终值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7Dh%28t%29%3D1) ，而初始斜率/速度为

(3.35) ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%5Cdot+h%28t%29%3D-%5Cfrac%7B2%7D%7Bc%7D%5Cbegin%7Bcases%7D%3C0%2Cif~~c%3E0%5C%5C%3E0%2Cif~~c%3C0+%5Cend%7Bcases%7D)

![img](https://pic1.zhimg.com/80/v2-1711beb9b8f521d385e2e9f9dd668360_hd.jpg)图3.4 不同参数c对应的系统行为

在多输入多输出的MIMO系统里，系统的输入输出行为由传递矩阵描述，但是考察零点的方法会更加复杂，我们还需要考虑这个零点是不是

- 传递零点(Übertragungsnullstellen)
- 不动零点(invariante Nullstellen)
- 输入输出解耦零点(Ein-/Ausgangs-Entkopplungsnullstellen)



# (四)能控性和能观性

现在我们来探讨线性时不变系统的一个重要性质——能控性(Steuerbarkeit)。

对于这样一个的线性时不变MIMO系统

(4.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BA+x%2BBu%7D%2C%5Cqquad+%5Cmathbf%7B+x%7D%280%29%3D%5Cmathbf%7B+x%7D_0)

其中状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%5Cin%5Cmathbb%7B+R%7D%5En) ，输入变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5Cin%5Cmathbb%7B+R%7D%5Em) ，动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bn%5Ctimes+n%7D) ，控制矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bn%5Ctimes+m%7D) 。

> **定义4.1 能控性**
> 一个线性系统被称为完全能控，当且仅当在有限时间 ![[公式]](https://www.zhihu.com/equation?tex=T%3C%5Cinfty) 内，任意初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%280%29%3D%5Cmathbf%7B+x%7D_0) 都可经由一个连续的控制变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%28t%29) ，在 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5Cleft%5B+0%2CT%5Cright%5D) 内，传导到达任意终值状态 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%28T%29%3D%5Cmathbf%7B+x%7D_T) 。

## 4.1 能控性

**4.1.1 Kalman定义的能控性**

为了考察系统的能控性，我们先看看状态变量的一般解形式

(4.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%28t%29%3D%5Cmathbf%7B+%5CPhi%7D%28t%29%5Cmathbf%7B+x%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7B+%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau)

现在令 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D_0%3D%5Cmathbf%7B+0%7D) 并且选择时间 ![[公式]](https://www.zhihu.com/equation?tex=t%3DT) ，会有

(4.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B+x%7D%28T%29%26%3D%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7B+%5CPhi%7D%28T-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau%3D%5Cint_%7B0%7D%5E%7BT%7D%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D%5Cmathbf%7B+A%7D%5Ek%5Cfrac%7B%28T-%5Ctau%29%5Ek%7D%7Bk%21%7D%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau%5C%5C+%26%3D%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D%5Cmathbf%7B+A%7D%5Ek%5Cmathbf%7BB%5Chat+u%7D_k%2C~~%5Cqquad+%5Cmathbf%7B%5Chat+u%7D_k%3D%5Cint_%7B0%7D%5E%7BT%7D%5Cfrac%7B%28T-%5Ctau%29%5Ek%7D%7Bk%21%7D%5Cmathbf%7B+u%7D%28%5Ctau%29d%5Ctau+%5Cend%7Balign%7D)

从上式可知，输入变量目控制轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%28t%29) 在确定的时间 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5Cleft%5B+0%2CT%5Cright%5D) 内都能用 ![[公式]](https://www.zhihu.com/equation?tex=m) 维向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Chat+u%7D_k) 表示。而目标终值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%28T%29) 可以看作各个矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D%2C%5Cmathbf%7BAB%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7BB%7D%2C...) 的线性组合。从而，对于任意点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%28T%29%5Cin%5Cmathbb%7B+R%7D%5En) 上使得能控性有意义的一个必要的条件就会变成：由 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D%2C%5Cmathbf%7BAB%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7BB%7D%2C...) 各个矩阵的所有列向量能够张开成 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbb%7B+R%7D%5En) 的空间。

也就是说增广矩阵

(4.4) ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cmathbf%7B+B%7D%2C%5Cmathbf%7BAB%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7BB%7D%2C...%2C%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7BB%7D%2C%5Cmathbf%7BA%7D%5E%7Bn%7D%5Cmathbf%7BB%7D%2C%5Cmathbf%7BA%7D%5E%7Bn%2B1%7D%5Cmathbf%7BB%7D%2C...+%5Cright%5D)

必须要有 ![[公式]](https://www.zhihu.com/equation?tex=n) 的秩，如此才能保证让所有 ![[公式]](https://www.zhihu.com/equation?tex=n) 个状态变量 ![[公式]](https://www.zhihu.com/equation?tex=x_i) 都是经过矩阵乘法后还能与 ![[公式]](https://www.zhihu.com/equation?tex=m) 维的输入变量相作用中间变量导出的。如果秩低于 ![[公式]](https://www.zhihu.com/equation?tex=n) ，意味着 ![[公式]](https://www.zhihu.com/equation?tex=n) 行元素里面第 ![[公式]](https://www.zhihu.com/equation?tex=i) 行都是0，这样最后控制变量 ![[公式]](https://www.zhihu.com/equation?tex=u_i) 就无法作用，使得对应的 ![[公式]](https://www.zhihu.com/equation?tex=x_i)有值。

> **定理4.1 Cayley-Hamilton定理**
> 多项式 ![[公式]](https://www.zhihu.com/equation?tex=p%28%5Clambda%29%3Dp_0%2Bp_1%5Clambda%2B...%2Bp_%7Bn-1%7D%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En) 是矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D) 的特征多项式 ![[公式]](https://www.zhihu.com/equation?tex=p%28%5Clambda%29%3Ddet%28%5Clambda%5Cmathbf%7B+I%7D-%5Cmathbf%7B+A%7D%29%3D0) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bn%5Ctimes+n%7D) ，那么有对应的关系
> (4.5) ![[公式]](https://www.zhihu.com/equation?tex=p%28%5Cmathbf%7B+A%7D%29%3Dp_0%5Cmathbf%7B+I%7D%2Bp_1%5Cmathbf%7B+A%7D%2B...%2Bp_%7Bn-1%7D%5Cmathbf%7B+A%7D%5E%7Bn-1%7D%2B%5Cmathbf%7B+A%7D%5En%3D%5Cmathbf%7B+0%7D)

Cayley-Hamilton定理指出，更高次幂的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%5E%7Bn%7D%5Cmathbf%7BB%7D%2C%5Cmathbf%7BA%7D%5E%7Bn%2B1%7D%5Cmathbf%7BB%7D%2C...+) 都可以由低次幂 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5E0%2C%5Cmathbf%7B+A%7D%5E1%2C...%2C%5Cmathbf%7B+A%7D%5E%7Bn-1%7D) 的线性组合得到，而需要确定的系数就是特征多项式 ![[公式]](https://www.zhihu.com/equation?tex=p%28%5Clambda%29) 的系数。由此可见，更高次幂显然不会提供更多的秩，不过这也已经足够了，只需要检验前 ![[公式]](https://www.zhihu.com/equation?tex=n) 个向量的线性无关性，于是有

> **定理4.2 Kalman的能控性判据**
> 式(4.1)所指的系统完全能控，当且仅当能控性矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S) 满秩，即
> (4.6) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S%3D%5Cleft%5B+%5Cmathbf%7B+B%7D%2C%5Cmathbf%7BAB%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7BB%7D%2C...%2C%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7BB%7D%5Cright%5D) 或者SISO系统的情况下
> (4.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S%3D%5Cleft%5B+%5Cmathbf%7B+b%7D%2C%5Cmathbf%7BAb%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7Bb%7D%2C...%2C%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7Bb%7D%5Cright%5D) ， ![[公式]](https://www.zhihu.com/equation?tex=Rank%28%5Cmathbf%7B+Q%7D_S%29%3Dn)

当系统不是完全能控的，那么只有不足 ![[公式]](https://www.zhihu.com/equation?tex=n) 维的子空间能控。

**4.1.2 Hautus定义的能控性**

除了Kalman给出的定义，还有Hautus的能控性定义，这是关于动态矩阵的特征值的分析

> **定理4.3 Hautus的能控性判据**
> 式(4.1)所指的系统完全能控，当且仅当所有动态矩阵的特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_i) 都满足
> (4.8) ![[公式]](https://www.zhihu.com/equation?tex=Rank%28%5Cleft%5B+%5Clambda_i+%5Cmathbf%7B+I-A%7D%2C%5Cmathbf%7B+B%7D+%5Cright%5D%29%3Dn)

Kalman判据要探讨一个 ![[公式]](https://www.zhihu.com/equation?tex=n%5Ctimes+%28n%5Ctimes+m%29) 的矩阵的秩。跟Kalman的判据不同，Hautus只需要讨论一个 ![[公式]](https://www.zhihu.com/equation?tex=n%5Ctimes+%28n%2B+m%29) 的矩阵的秩。而且Hautus判据还可以直接给出哪一个特征值是不可控的！这样Hautus判据可以在一些计算中比Kalman判据更简单。

Hautus判据也可以用来判断系统是否有**能稳定性**(Stabilisierbarkeit)，系统是能稳定的，当且仅当所有不稳定的特征值 ![[公式]](https://www.zhihu.com/equation?tex=Re%28%5Clambda_i%29%5Cgeq+0) 都完全能控。

**4.1.3 SISO系统变形为能控标准型**

一个系统如果是能控标准型，那么我们可以轻松读出传递函数，而且能控标准型便于控制器的设计，那么普通系统怎样变成变成能控标准型呢？我们先考察一个SISO的系统

(4.9) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA+x%2Bb%7Du%2C%5Cqquad+%5Cmathbf%7B+x%7D%280%29%3D%5Cmathbf%7B+x%7D_0%5C%5C+y%26%3D%5Cmathbf%7Bc%5ET+x+%2B%7D~du+%5Cend%7Balign%7D)

其中状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%5Cin%5Cmathbb%7B+R%7D%5En) ，输入标量变量 ![[公式]](https://www.zhihu.com/equation?tex=u%5Cin%5Cmathbb%7B+R%7D) ，输出标量 ![[公式]](https://www.zhihu.com/equation?tex=y%5Cin%5Cmathbb%7B+R%7D) 。设给出能满足条件的这样的可逆变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D) ，那么有能控标准型下的系统变量坐标 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D%3D%5Cmathbf%7BT+x%7D) ，变形完的能控标准型为

(4.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+++%5Cmathbf%7B%5Cdot+%7B%5Ctilde+%7Bx%7D%7D%7D%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D++0%261%260%26%5Ccdots%260%5C%5C+0%260%261%26%5Ccdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cddots%26%5Cvdots%26%5C%5C+0%260%26%5Ccdots%260%261%5C%5C+-a_0%26-a_1%26%5Ccdots%26-a_%7Bn-2%7D%26-a_%7Bn-1%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%3DTAT%7D%5E%7B-1%7D%7D%5Cmathbf%7B%5Ctilde+x%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%5C%5C+0%5C%5C+%5Cvdots%5C%5C+0%5C%5C+1+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+b%3DTb%7D%7Du%5C%5C+y%26%3D%5Cbegin%7Bbmatrix%7Db_0-a_0b_n%26%5Ccdots%26b_%7Bn-1%7D-a_%7Bn-1%7Db_n%5C%5C++%5Cend%7Bbmatrix%7D%5Cmathbf%7B%5Ctilde+x%7D%2Bb_n+u+%5Cend%7Balign%7D)

显然，在第一次出现控制量 ![[公式]](https://www.zhihu.com/equation?tex=u) 以前，状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde+x_1) 必须至少 ![[公式]](https://www.zhihu.com/equation?tex=n) 次可微，使用变换向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Ctilde+x_1%3D%5Cmathbf%7Bt%5ET%7D%5Cmathbf%7Bx%7D) ，代入原方程可得

(4.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot+%7B%5Ctilde+x%7D_1%26%3D%5Ctilde+x_2%3D%5Cmathbf%7Bt%5ETAx%2Bt%5ETb%7Du%2C%26+%5Cmathbf%7Bt%5ETb%7D%26%3D0%5C%5C+%5Cdot+%7B%5Ctilde+x%7D_2%26%3D%5Ctilde+x_3%3D%5Cmathbf%7Bt%5ETA%7D%5E2%5Cmathbf%7Bx%2Bt%5ETAb%7Du%2C%26%5Cmathbf%7Bt%5ETAb%7D%26%3D0%5C%5C+%26~~%5Cvdots%5C%5C+%7B%5Ctilde+x%7D_1%5E%7B%28n-1%29%7D%26%3D%5Ctilde+x_n%3D%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-1%7D%5Cmathbf%7Bx%2B%7D%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-2%7D%5Cmathbf%7Bb%7Du%2C%26%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-2%7D%5Cmathbf%7Bb%7D%26%3D0%5C%5C+%7B%5Ctilde+x%7D_1%5E%7B%28n%29%7D%26%3D%5Cdot+%7B%5Ctilde+x%7D_n%3D%5Cmathbf%7Bt%5ETA%7D%5E%7Bn%7D%5Cmathbf%7Bx%2B%7D%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-1%7D%5Cmathbf%7Bb%7Du%2C%26%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-1%7D%5Cmathbf%7Bb%7D%26%3D1%5C%5C+%5Cend%7Balign%7D)

所以把限制条件的线性运算合写做矩阵相乘，得

(4.12) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t%5ET%7D%5Cunderbrace%7B%5Cleft%5B+%5Cmathbf%7B+b%7D%2C%5Cmathbf%7BAb%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7Bb%7D%2C...%2C%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7Bb%7D%5Cright%5D%7D_%7B%5Cmathbf%7B+Q%7D_S%7D%3D%5B0%2C...%2C0%2C1%5D)

可见能控标准型和能控矩阵密切联系，当且仅当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S) 满秩可逆，才有变换向量

(4.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t%5ET%7D%3D%5B0%2C...%2C0%2C1%5D%5Cmathbf%7B+Q%7D_S%5E%7B-1%7D)

所以我们需要借助能控矩阵的逆矩阵的最后一行的元素才能确定能控标准型的变换向量和变换矩阵。总结如下

> **定理4.4 能控标准型的变换**
> 如果式(4.9)决定的线性系统完全能控，那么才可以通过以下变换关系得到能控标准型
> (4.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+t%5ET%7D%5C%5C%5Cmathbf%7Bt%5ETA%7D%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7Bt%5ETA%7D%5E%7Bn-1%7D+%5Cend%7Bbmatrix%7D%2C%5Cqquad+%5Cmathbf%7B+t%5ET%7D%3D%5B0%2C...%2C0%2C1%5D%5Cmathbf%7B+Q%7D_S%5E%7B-1%7D%2C+%5Cqquad+%5Cmathbf%7B+Q%7D_S%3D%5Cleft%5B+%5Cmathbf%7B+b%7D%2C%5Cmathbf%7BAb%7D%2C%5Cmathbf%7BA%7D%5E2%5Cmathbf%7Bb%7D%2C...%2C%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7Bb%7D%5Cright%5D)

能控标准型能够直接看出传递函数，同样也可以反过来用传递函数直接读出能控标准型，而且在SISO系统里，控制变量 ![[公式]](https://www.zhihu.com/equation?tex=u) 只会直接影响状态变量的最后一行，这对于控制器设计来说尤为便利。至于MIMO系统的能控标准型变换会在下一章节给出。

## 4.2 能观性

事实上，在绝大多数情况下，困扰我们的问题不是能控性，而是状态变量是否可以测得。系统的**能观性**(Beobachtabarkeit)就关乎这个问题：我们是否可以通过直接测量量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29) 以及输入控制量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%28t%29) 来重建状态变量的关系。

继续考察一个线性时不变的MIMO系统

(4.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA+x%2BBu%7D%2C%5Cqquad+%5Cmathbf%7B+x%7D%280%29%3D%5Cmathbf%7B+x%7D_0%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BC+x%2BDu%7D+%5Cend%7Balign%7D)

其中状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%5Cin%5Cmathbb%7B+R%7D%5En) ，输入变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5Cin%5Cmathbb%7B+R%7D%5Em) ，输出变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%5Cin%5Cmathbb%7B+R%7D%5Ep) ，![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bn%5Ctimes+n%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bn%5Ctimes+m%7D) ，![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+C%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bp%5Ctimes+n%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+D%7D%5Cin%5Cmathbb%7B+R%7D%5E%7Bp%5Ctimes+m%7D) 。

> **定义4.2 能观性**
> 一个线性系统被称为完全能观，当且仅当在有限时间 ![[公式]](https://www.zhihu.com/equation?tex=T%3C%5Cinfty) 内，都可通过连续的控制变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%28t%29) 以及测得的输出变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29) 的信息，在 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5Cleft%5B+0%2CT%5Cright%5D) 内，完全确定初始状态 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D%280%29%3D%5Cmathbf%7B+x%7D_0) 。

**4.2.1 Kalman定义的能观性**

如同对能观性的考察，我们回顾最后系统的输出变量的解

(4.16) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29%3D%5Cmathbf%7B+C%5CPhi%7D%28t%29%5Cmathbf%7B+x%7D_0%2B%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbf%7B+C%5CPhi%7D%28t-%5Ctau%29%5Cmathbf%7BBu%7D%28%5Ctau%29d%5Ctau%5Cmathbf%7B%2BDu%7D%28t%29)

假设输入量和输出量轨迹全部已知，显然后两项对确定初始条件 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D_0) 没有影响。而为了简化探求能观性的难度，再让输入量始终置零 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%28t%29%5Cequiv%5Cmathbf%7B+0%7D) ，原式就简化为

(4.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29%3D%5Cmathbf%7B+C%5CPhi%7D%28t%29%5Cmathbf%7B+x%7D_0)

另一个对于考察能观性必要的条件是，假设存在一个非零向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+a%7D%5Cne%5Cmathbf%7B+0%7D) 使得

(4.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+CA%7D%5Ek%5Cmathbf%7Ba%7D%3D%5Cmathbf%7B+0%7D%2C%5Cquad%5Cquad+k%3D1%2C2%2C...)

于是就可以得出

(4.19) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29%3D%5Cmathbf%7B+C%5CPhi%7D%28t%29%5Cmathbf%7Ba%7D%3D%5Cleft%28+%5Csum_%7Bk%3D0%7D%5E%7B%5Cinfty%7D%5Cmathbf%7B+CA%7D%5Ek%5Cfrac%7Bt%5Ek%7D%7Bk%21%7D%5Cright%29%5Cmathbf%7Ba%7D%3D%5Cmathbf%7B+0%7D)

使得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+y%7D%28t%29%3D%5Cmathbf%7B+0%7D) 的初值在上述情况中只有两种可能，初值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D_0%3D%5Cmathbf%7B+0%7D) 以及 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+x%7D_0%3D%5Cmathbf%7B+a%7D%5Cne%5Cmathbf%7B+0%7D) ，这显然有悖于定义4.2，为了保证定义完整，系统能观性的必要条件就一定是**不存在这样的非零向量** ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+a%7D%5Cne%5Cmathbf%7B+0%7D) ，它同时正交于所有向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+CA%7D%5Ek) **。**

就如同定理4.1所述，仅需考察 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5E0%2C%5Cmathbf%7B+A%7D%5E1%2C...%2C%5Cmathbf%7B+A%7D%5E%7Bn-1%7D) ，因为更高次幂的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%5E%7Bn%7D%2C%5Cmathbf%7BA%7D%5E%7Bn%2B1%7D%2C...+) 都可以通过前面低次幂的线性组合得到，于是有

(4.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+CA%7D%5Ek%5Cmathbf%7Ba%7D%3D%5Cmathbf%7B+0%7D%2C%5Cquad%5Cquad+k%3D0%2C1%2C...%2Cn-1) 或者说 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+C%7D%5C%5C%5Cmathbf%7BCA%7D%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7BCA%7D%5E%7Bn-1%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7Ba%7D%3D%5Cmathbf%7B+0%7D)

当式(4.20)里面这个矩阵秩为 ![[公式]](https://www.zhihu.com/equation?tex=n) 时，即满秩，就可以保证不存在一个非零向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+a%7D%5Cne%5Cmathbf%7B+0%7D) 的非平凡解。这也是确定系统能观性的必要条件。

> **定理4.5 Kalman的能观性判据**
> 式(4.15)所确定的系统是完全能观的，当且仅当能观矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_B) 满秩
> (4.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_B%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+C%7D%5C%5C%5Cmathbf%7BCA%7D%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7BCA%7D%5E%7Bn-1%7D+%5Cend%7Bbmatrix%7D) 或者SISO系统中 (4.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_B%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+c%5ET%7D%5C%5C%5Cmathbf%7B+c%5ETA%7D%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7B+c%5ETA%7D%5E%7Bn-1%7D+%5Cend%7Bbmatrix%7D)
> ![[公式]](https://www.zhihu.com/equation?tex=Rank%28%5Cmathbf%7B+Q%7D_B%29%3Dn)

**4.2.2 Hautus定义的能观性**

除了Kalman给出的定义，还有Hautus的能观性定义，这也关于动态矩阵的特征值的分析

> **定理4.6 Hautus的能控性判据**
> 式(4.1)所指的系统完全能控，当且仅当所有动态矩阵的特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_i) 都满足
> (4.23) ![[公式]](https://www.zhihu.com/equation?tex=Rank%28%5Cbegin%7Bbmatrix%7D+%5Clambda_i+%5Cmathbf%7B+I-A%7D%5C%5C%5Cmathbf%7BC%7D+%5Cend%7Bbmatrix%7D%29%3Dn)

Kalman判据要探讨一个 ![[公式]](https://www.zhihu.com/equation?tex=%28p%5Ctimes+n%29%5Ctimes+n) 的矩阵的秩。跟Kalman的判据不同，Hautus只需要讨论一个 ![[公式]](https://www.zhihu.com/equation?tex=%28n%2B+p%29%5Ctimes+n) 的矩阵的秩。而且Hautus判据还可以直接给出哪一个特征值是不可控的！这样Hautus判据可以在一些计算中比Kalman判据更简单。

Hautus判据也可以用来判断系统是否有**能检测性**(Detektierbarkeit)，系统是能检测的，当且仅当所有不稳定的特征值 ![[公式]](https://www.zhihu.com/equation?tex=Re%28%5Clambda_i%29%5Cgeq+0) 都完全能观。

**4.2.3 SISO系统变形为能观标准型**

类比前面4.1.3中出现的能控标准型，我们也可以把系统变为能观标准型。引入变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BV%7D) ，有变换关系 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cmathbf%7BV%5Ctilde+x%7D) ，所以新坐标下有

(4.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+%7B%5Ctilde+x%7D%7D%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D++0%26%5Ccdots%26%5Ccdots%260%26-a_0%5C%5C+1%260%26%5Ccdots%260%26-a_1%5C%5C+%5Cvdots%261%26%5Cddots%26%5Cvdots%26%5Cvdots%26%5C%5C+0%260%26%5Cddots%260%26-a_%7Bn-2%7D%5C%5C+0%260%26%5Ccdots%261%26-a_%7Bn-1%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D%3D%5Cmathbf%7BV%5E%7B-1%7DAV%7D%7D%5Cmathbf%7B+%7B%5Ctilde+x%7D%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+b_0-a_0b_n%5C%5C+b_1-a_1b_n%5C%5C+%5Cvdots%5C%5C+b_%7Bn-2%7D-a_%7Bn-2%7Db_n%5C%5C+b_%7Bn-1%7D-b_%7Bn-1%7Db_n+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+b%7D%3D%5Cmathbf%7BV%5E%7B-1%7D+b%7D%7Du%5C%5C+y%26%3D%5Cbegin%7Bbmatrix%7D0%260%26%5Ccdots%260%261%5C%5C++%5Cend%7Bbmatrix%7D%5Cmathbf%7B+%7B%5Ctilde+x%7D%7D%2Bb_nu+%5Cend%7Balign%7D)

> **定理4.7 能观标准型的变换**
> 如果式(4.9)决定的线性系统完全能观，那么才可以通过以下变换关系得到能观标准型
> (4.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BV%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+v%7D%26%5Cmathbf%7BAv%7D%26+%5Ccdots%26%5Cmathbf%7BA%7D%5E%7Bn-1%7D%5Cmathbf%7Bv%7D+%5Cend%7Bbmatrix%7D%2C%5Cquad+%5Cmathbf%7B+v%7D%3D%5Cmathbf%7B+Q%7D_B%5E%7B-1%7D%5Cbegin%7Bbmatrix%7D+0%5C%5C+%5Cvdots%5C%5C0%5C%5C1+%5Cend%7Bbmatrix%7D%2C+%5Cquad+%5Cmathbf%7B+Q%7D_B%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+c%5ET%7D%5C%5C%5Cmathbf%7B+c%5ETA%7D%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7B+c%5ETA%7D%5E%7Bn-1%7D+%5Cend%7Bbmatrix%7D)
> 变换向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+v%7D) 为能观矩阵逆矩阵的最后一列。

类似能控标准型，能观标准型也是对于设计观测器来说特别合适的形式，而且输出量 ![[公式]](https://www.zhihu.com/equation?tex=y) 只跟状态变量的最后一行有关。MIMO的能观标准型会在之后的篇章给出。

## 4.3 对偶原则

在上一章末尾已经展示过，标量传递函数转置与否不影响它的值，即

(4.26) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%28G%28s%29%29%5ET%3D%5Cleft%28+%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D%2Bd+%5Cright%29%5ET%3D%5Cmathbf%7Bb%5ET%7D%28s%5Cmathbf%7BI-A%5ET%7D%29%5E%7B-1%7D%5Cmathbf%7Bc%7D%2Bd)

在MIMO系统里，更可以定义对偶关系

(4.27) ![[公式]](https://www.zhihu.com/equation?tex=+%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2BBu%7D%5Cqquad%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BCx%2BDu%7D+%5Cend%7Balign%7D) ![[公式]](https://www.zhihu.com/equation?tex=%5CLeftrightarrow%5C%5C) ![[公式]](https://www.zhihu.com/equation?tex=+%5Cbegin%7Balign%7D++%5Cqquad+%5Cmathbf%7B%5Cdot+x%7D_D%26%3D%5Cmathbf%7BA%5ET%7D%5Cmathbf%7Bx%7D_D%5Cmathbf%7B%2BC%5ETu%7D_D%5C%5C+%5Cmathbf%7By%7D_D%26%3D%5Cmathbf%7BB%5ETx%7D_D%5Cmathbf%7B%2BD%5ETu%7D_D+%5Cend%7Balign%7D)

对于传递矩阵来说 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BG%7D_D%28s%29%3D%5Cmathbf%7BG%5ET%7D%28s%29)

(4.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BG%5ET%7D%28s%29%3D%5Cleft%28+%5Cmathbf%7BC%7D%28s%5Cmathbf%7BI-A%7D%29%5E%7B-1%7D%5Cmathbf%7BB%2BD%7D+%5Cright%29%5ET%3D+%5Cmathbf%7BB%5ET%7D%28s%5Cmathbf%7BI-A%5ET%7D%29%5E%7B-1%7D%5Cmathbf%7BC%5ET%2BD%5ET%7D%3D%5Cmathbf%7BG%7D_D%28s%29)

此外还有对应的关系，原系统的能控性(能观性)恰好就是对偶系统的能观性(能控性)

(4.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%5ET%7D_S%3D%5Cmathbf%7B+Q%7D_%7BB%2CD%7D%2C%5Cqquad+%5Cmathbf%7B+Q%5ET%7D_B%3D%5Cmathbf%7B+Q%7D_%7BS%2CD%7D)

> **定理4.8 对偶系统的能控能观性**
> 对偶系统恰好能控(能观)，当且仅当原系统能观(能控)。

------

到目前为止，状态方程描述的系统特性已经基本上讲完了。下一章我们正式开始已经前面铺垫的内容利用状态方程来设计控制器。

# (五)设计状态反馈控制器

在经典控制理论里面，我们会关注，一个SISO的系统的输出被测量后传回输入形成反馈环。通过比较实际输出信号 ![[公式]](https://www.zhihu.com/equation?tex=y) 与参考输入信号 ![[公式]](https://www.zhihu.com/equation?tex=w) 计算出应该调节的动态控制输入信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29) ，再逐步纠正输出信号。

![img](https://pic3.zhimg.com/80/v2-38a9e6a80c33305ceb53bca85c9a6086_hd.jpg)图5.1 SISO系统的输出反馈控制

假设一个系统的所有状态变量都是可以通过传感测量技术测量的或者说可以估计的，那么就可以设计一个线性的全状态反馈控制器，意思就是用所有的状态向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D) 的值反馈，而非之前用输出变量 ![[公式]](https://www.zhihu.com/equation?tex=y) 的值来反馈。这样使得新的控制律为

(5.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cmathbf%7B-Kx%2BSw%7D)

通过 ![[公式]](https://www.zhihu.com/equation?tex=%28m%5Ctimes+n%29) 的反馈矩阵或者控制矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D) 以及 ![[公式]](https://www.zhihu.com/equation?tex=%28n%5Ctimes+p%29) 的前馈矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D) 来实现控制量调节。接下来会探讨在没有直接控制 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7BD%3D0%7D%29) 的MIMO的线性系统的控制器的设计，其中输入向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5Cin+%5Cmathbb%7BR%7D%5Em) ，输出向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%5Cin+%5Cmathbb%7BR%7D%5Ep) 。

(5.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2BBu%7D%2C%5Cqquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BCx%7D+%5Cend%7Balign%7D)

在设置全状态反馈控制器时，有一些设计目标是特别值得关注的

- 保证反馈系统的稳定性
- 调整可预期的输入输出变量行为
- 提高阻尼
- 改善暂态响应
- 补偿扰动误差
- 提高参考信号的跟踪精度

![img](https://pic2.zhimg.com/80/v2-57eab5da0f3ca67de3ba446ebf76fa11_hd.jpg)图5.2 MIMO系统的状态反馈

这样设计控制律以及控制矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D)，就可以得到

(5.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BAx%2BB%28-Sx%2BKw%29%7D%3D%5Cmathbf%7B%28A-BK%29x%2BBSw%7D)

所以我们的目标就转化为确定合适的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D) 使得合成了控制器以后的总的闭环系统是渐近稳定的，也就是说新的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%28A-BK%29%7D) 的特征值必须要在复平面的左半平面。

## 5.1静态前置滤波器

接下来我们先研究前置滤波器的设计，前置滤波器的目的就是为了使最终输出信号能够和参考信号输入一致，在静态输入时相当于确定了一个新的工作点，系统输出会移动到那个新的位置，而当连续输入变化的信号时，相当于使系统遵循预设轨迹运动。

先考虑静态输入，即参考输入信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bw%7D) 是恒定的，而且也没有外界的扰动影响。并且假设系统的状态反馈控制矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D)已知，我们应当这样设计前置滤波器，使得最终稳态输出时没有剩下来的反馈控制误差，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%7B%5Cmathbf%7By%7D%28t%29%7D%3D%5Cmathbf%7By%7D_%5Cinfty)

(5.4) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty%3D%5Cmathbf%7BCx%7D_%5Cinfty)

那么最终稳态的反馈也会使得系统稳态，不再有动态，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D_%5Cinfty%3D%5Cmathbf%7B0%7D) ，所以

(5.5) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_%5Cinfty%3D%5Cmathbf%7B-Kx%7D_%5Cinfty%5Cmathbf%7B%2BSw%7D)

(5.6) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B0%7D%3D%5Cmathbf%7B%28A-BK%29x%7D_%5Cinfty+%5Cmathbf%7B%2BBSw%7D)

当整个闭环是渐近稳定的，所有![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%28A-BK%29%7D) 的特征值必在复平面的左半平面，那么![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%28A-BK%29%7D) 也是一个非奇异矩阵，那么可逆，有

(5.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_%5Cinfty+%3D%5Cmathbf%7B%28BK-A%29%7D%5E%7B-1%7D%5Cmathbf%7BBSw%7D)

稳态输出就变成

(5.8) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty+%3D%5Cmathbf%7BC%28BK-A%29%7D%5E%7B-1%7D%5Cmathbf%7BBSw%7D)

因为控制变量 ![[公式]](https://www.zhihu.com/equation?tex=u) 和输出变量 ![[公式]](https://www.zhihu.com/equation?tex=y) 的个数一般是相等的 ![[公式]](https://www.zhihu.com/equation?tex=%28m%3Dp%29) ，于是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BC%28BK-A%29%7D%5E%7B-1%7D%5Cmathbf%7BB%7D) 必为方阵，并且控制目标应该和参考输入信号一致，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty%3D%5Cmathbf%7BIw%7D%3D%5Cmathbf%7Bw%7D) ，所以就可以确定前置滤波矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D)

(5.9) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D%3D%5Cleft%5B+%5Cmathbf%7BC%28BK-A%29%7D%5E%7B-1%7D%5Cmathbf%7BB%7D%5Cright%5D%5E%7B-1%7D)

每个期望的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty) 通过对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_V%3D%5Cmathbf%7BSw%7D) 的可调性，来保证括号内矩阵的可逆性。

## 5.2 基于状态反馈设计直接给定特征值(SISO系统)

对于一个系统的响应来说，我们希望它最好能够在我们期望的位置实现，即极点和特征值可以让我们自由配置，以获得期望的动态。接下来考察SISO系统的标量控制变量 ![[公式]](https://www.zhihu.com/equation?tex=u)

(5.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2Bb%7Du%2C%5Cqquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+y%26%3D%5Cmathbf%7Bc%5ETx%7D+%5Cend%7Balign%7D)

(5.11) ![[公式]](https://www.zhihu.com/equation?tex=u%3D%5Cmathbf%7B-k%5ETx%7D%2BSw)

代入单输入的控制律，原状态方程变为用新的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D_R%3D%28%5Cmathbf%7BA-bk%5ET%7D%29) 描述

(5.12) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cunderbrace%7B%28%5Cmathbf%7BA-bk%5ET%7D%29%7D_%7B%5Cmathbf%7BA%7D_R%7D%5Cmathbf%7Bx%7D%2BS~%5Cmathbf%7Bb%7Dw%2C%5Cqquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+y%26%3D%5Cmathbf%7Bc%5ETx%7D+%5Cend%7Balign%7D)

如果能够选择合适的反馈控制器增益向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D) ，就可以任意调整闭环动态矩阵的特征值到我们希望的位置上去！所以我们就可以先预给需要的特征值，再反过来求应当要选的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D)。

对应的调整以后的特征多项式为

(5.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+q%28%5Clambda%2C%5Cmathbf%7Bk%7D%29%26%3Ddet%28%5Clambda%5Cmathbf%7BI-A%2Bbk%5ET%7D%29%5C%5C+%26%3Dq_0%28%5Cmathbf%7Bk%7D%29%2Bq_%7B1%7D%28%5Cmathbf%7Bk%7D%29%5Clambda%2B...%2Bq_%7Bn-1%7D%28%5Cmathbf%7Bk%7D%29%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En+%5Cend%7Balign%7D)

而我们预给的特征值展开也会得到同幂次的多项式

(5.14) ![[公式]](https://www.zhihu.com/equation?tex=p%5E%2A%28%5Clambda%29%3Dp_0%2Bp_1%5Clambda%2B...%2Bp_%7Bn-1%7D%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En)

比较两式系数，由每个来自增益向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D%3D%5Cleft%5B+k_1+%2Ck_2%2C...%2Ck_n+%5Cright%5D) 的元素构成的线性组合 ![[公式]](https://www.zhihu.com/equation?tex=q_i%28%5Cmathbf%7Bk%7D%29) 都应该与预给特征值展开的多项式系数 ![[公式]](https://www.zhihu.com/equation?tex=p_i) 相等，即

(5.15) ![[公式]](https://www.zhihu.com/equation?tex=q_0%28%5Cmathbf%7Bk%7D%29%2Bq_%7B1%7D%28%5Cmathbf%7Bk%7D%29%5Clambda%2B...%2Bq_%7Bn-1%7D%28%5Cmathbf%7Bk%7D%29%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En%3Dp_0%2Bp_1%5Clambda%2B...%2Bp_%7Bn-1%7D%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En)

(5.16) ![[公式]](https://www.zhihu.com/equation?tex=q_0%28%5Cmathbf%7Bk%7D%29%3Dp_0%2C~~+q_1%28%5Cmathbf%7Bk%7D%29%3Dp_1%2C~~...~~%2C~~q_%7Bn-1%7D%28%5Cmathbf%7Bk%7D%29%3Dp_%7Bn-1%7D)

而对于MIMO系统 ![[公式]](https://www.zhihu.com/equation?tex=%28m%3E1%29) ，情况会很复杂，MIMO的 ![[公式]](https://www.zhihu.com/equation?tex=n) 个等式下会有 ![[公式]](https://www.zhihu.com/equation?tex=n%5Ccdot+m) 个待定的 ![[公式]](https://www.zhihu.com/equation?tex=k_%7Bij%7D) 。只要系统能控，将存在无穷多个解。再者，在MIMO时可能会有 ![[公式]](https://www.zhihu.com/equation?tex=q_i%28%5Cmathbf%7Bk%7D%29) 非线性的情况，比如 ![[公式]](https://www.zhihu.com/equation?tex=7k_1k_2k_3%2C~~2k_1k_2%5E5) 等等情况。所以直接的特征值预置还是建议只在SISO系统里进行。接下来我们考察一个例子。

**例5.1 设计反馈控制增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D)**

当预置特征值为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_1%3D-2%2C~%5Clambda_2%3D1%2C~%5Clambda_3%3D2) ，先不考虑前置滤波器，只使用状态反馈控制律 ![[公式]](https://www.zhihu.com/equation?tex=u%3D%5Cmathbf%7B-k%5ETx%7D) ，有状态方程

(5.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D-2%260%263%5C%5C+1%262%262%5C%5C0%260%261+%5Cend%7Bbmatrix%7D%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D-1%5C%5C0%5C%5C1+%5Cend%7Bbmatrix%7Du)

闭环反馈动态矩阵为

(5.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D_R%3D%28%5Cmathbf%7BA-bk%5ET%7D%29%3D%5Cbegin%7Bbmatrix%7Dk_1-2%26k_2%263%2Bk_3%5C%5C+1%262%262%5C%5C-k_1%26-k_2%261-k_3+%5Cend%7Bbmatrix%7D)

有特征多项式

(5.19) ![[公式]](https://www.zhihu.com/equation?tex=det%28%5Clambda%5Cmathbf%7BI-A%7D_R%29%3D%5Clambda%5E3%2B%5Cunderbrace%7B%28-1-k_1%2Bk_3%29%7D_%7Bq_2%28%5Cmathbf%7Bk%7D%29%7D%5Clambda%5E2%2B%5Cunderbrace%7B%28-4%2B6k_1%2Bk_2%29%7D_%7Bq_1%28%5Cmathbf%7Bk%7D%29%7D%5Clambda%2B%5Cunderbrace%7B%284-8k_1%2B8k_2-4k_3%29%7D_%7Bq_0%28%5Cmathbf%7Bk%7D%29%7D)

而期望的预给特征值得到的特征多项式为

(5.20) ![[公式]](https://www.zhihu.com/equation?tex=p%5E%2A%28%5Clambda%29%3D%28%5Clambda%2B2%29%28%5Clambda-1%29%28%5Clambda-2%29%3D%5Clambda%5E3%2B6%5Clambda%5E2%2B11%5Clambda%2B6)

通过比较系数，可得

(5.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bcases%7D+-1-~~k_1%2B~~k_3%3D6%5C%5C+-4%2B6k_1%2B~~k_2%3D11%5Cqquad%5Cqquad%5CRightarrow+k_1%3D%5Cfrac%7B3%7D%7B2%7D%2C~~+k_2%3D6%2C~~+k_3%3D%5Cfrac%7B17%7D%7B2%7D%5C%5C+~~~4-8k_1%2B8k_2-4k_3%3D6+%5Cend%7Bcases%7D)

所以能确定增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D%3D%5Cbegin%7Bbmatrix%7D%5Cfrac%7B3%7D%7B2%7D%5Cquad6%5Cquad%5Cfrac%7B17%7D%7B2%7D+%5Cend%7Bbmatrix%7D)

## 5.3 对外界扰动的处理

之前在5.1里面我们使用的前置滤波器是假设没有扰动，把一个前置滤波器 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D) 设计成能使剩下的反馈误差在参考输入信号的导引下归零，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%7B%5Cmathbf%7Be_w%7D%28t%29%7D%3D%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%28%5Cmathbf%7Bw-y%7D%28t%29%29%3D%5Cmathbf%7B0%7D) 。当我们重新考虑了测得的控制对象参数由于外界扰动偏离时，由于前置滤波器和系统本身没有考虑过这个误差，它应该会作为系统误差直接保留下来，无法消除。

实际上一个外界扰动也可以视为一个输入变量作用在状态方程上，所以我们考察新的扩展系统

(5.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BAx%2BBu%2BEd%7D%2C%5Cqquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%5C%5C+%5Cmathbf%7By%7D%26%3D%5Cmathbf%7BCx%7D+%5Cend%7Balign%7D)

![[公式]](https://www.zhihu.com/equation?tex=%28n+%5Ctimes+l%29) 的扰动输入矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BE%7D+%5Cin%5Cmathbb%7BR%7D+%5E%7Bn%5Ctimes+l%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=l) 维的扰动输入向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bd%7D+%5Cin%5Cmathbb%7BR%7D+%5E%7Bl%7D) ，继续使用控制律，沿用之前式(5.5)的思路，使用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x+%7D_R%3D%5Cmathbf%7B0%7D) 得到在恒定外界扰动 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bd%7D) 作用下的新的平衡点的位置

(5.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_R+%3D%5Cmathbf%7B%28BK-A%29%7D%5E%7B-1%7D%28%5Cmathbf%7BBSw%2BEd%7D%29)

(5.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_R+%3D%5Cmathbf%7BC%28BK-A%29%7D%5E%7B-1%7D%28%5Cmathbf%7BBSw%2BEd%7D%29%3D%5Cmathbf%7Bw%2B%28BK-A%29%7D%5E%7B-1%7D%5Cmathbf%7BEd%7D%5Cne%5Cmathbf%7Bw%7D)

可见，这个稳态误差确实被留下来了，不能直接用前置滤波器消除。

于是我们可以引入**扰动变量串接补偿项**(Störgrößenaufschaltung)或者**积分环节**来消除扰动的影响。

**5.3.1 扰动变量串接补偿项**

它可以有效补偿可测/已知的扰动输入量，实现效果类似于额外添加一个控制项 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d) 到控制律里，新的控制律为

(5.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cmathbf%7B-Kx%2BSw%2Bu%7D_d)

最终补偿效果应该是使得

(5.26) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BBu%7D_d%5Cmathbf%7B%2BEd%7D%3D%5Cmathbf%7B0%7D)

假设 ![[公式]](https://www.zhihu.com/equation?tex=n%3Dm) 且 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D) 可逆，那控制项 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d)就有唯一的表达

(5.27) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d%3D%5Cmathbf%7B-B%7D%5E%7B-1%7D%28%5Cmathbf%7BEd%7D%29)

这样扰动项在系统中就能被精确补偿掉。

而对于一般情况 ![[公式]](https://www.zhihu.com/equation?tex=n%3Em) ，我们无法直接使用控制矩阵的逆矩阵。如此我们还有一种替代思路，不再寻求直接精确的解，我们需要寻找一个使 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cdelta%7D%3D%5Cmathbf%7BBu%7D_d%5Cmathbf%7B%2BEd%7D) 影响最小的方法，这时我们可以使用最小二乘法。

(5.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d%3D%5Cmin_%7B%5Cmathbf%7Bu%7D_d%7D%5Cboldsymbol%7B%5Cdelta%7D%5E%7B%5Cmathbf%7BT%7D%7D%5Cboldsymbol%7B%5Cdelta%7D)

(5.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cboldsymbol%7B%5Cdelta%7D%5E%7B%5Cmathbf%7BT%7D%7D%5Cboldsymbol%7B%5Cdelta%7D%26%3D%5Cleft%28+%5Cmathbf%7BBu%7D_d%5Cmathbf%7B%2BEd%7D+%5Cright%29%5E%7B%5Cmathbf%7BT%7D%7D%5Cleft%28+%5Cmathbf%7BBu%7D_d%5Cmathbf%7B%2BEd%7D+%5Cright%29%5C%5C+%26%3D%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETBu%7D_d%2B%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETEd%7D+%2B%5Cmathbf%7Bd%5ETE%5ETBu%7D_d%2B%5Cmathbf%7Bd%5ETE%5ETEd%7D+%5C%5C+%26%3D%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETBu%7D_d%2B2%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETEd%7D+%2B%5Cmathbf%7Bd%5ETE%5ETEd%7D++%5Cend%7Balign%7D)

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETEd%7D%3D%5Cleft%28+%5Cmathbf%7Bu%7D_d%5E%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7BB%5ETEd%7D+%5Cright%29+%5E%7B%5Cmathbf%7BT%7D%7D%3D%5Cmathbf%7Bd%5ETE%5ETBu%7D_d) ，因为它是标量，所以转置相等。

对(5.29)求极小值点有

(5.30) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+%5Cleft%28+%5Cboldsymbol%7B%5Cdelta%7D%5E%7B%5Cmathbf%7BT%7D%7D%5Cboldsymbol%7B%5Cdelta%7D+%5Cright%29%7D%7B%5Cpartial%5Cmathbf%7Bu%7D_d%7D%3D2%5Cmathbf%7BB%5ETBu%7D_d%2B2%5Cmathbf%7BB%5ETEd%7D%3D%5Cmathbf%7B0%7D)

基于合理的假设，即至少矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D) 每一列都线性无关，于是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%5ETB%7D) 可逆，如此可得

(5.31) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_d%3D-%5Cleft%28%5Cmathbf%7BB%5ETB%7D+%5Cright%29%5E%7B-1%7D%5Cmathbf%7BB%5ETEd%7D)

于是最终合成的反馈控制律为

(5.32) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cmathbf%7B-Kx%2BSw%7D-%5Cleft%28%5Cmathbf%7BB%5ETB%7D+%5Cright%29%5E%7B-1%7D%5Cmathbf%7BB%5ETEd%7D)

**5.3.2 PI状态反馈控制器**

使用扰动变量串接补偿项，必须事先要知晓扰动输入 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bd%7D) 以及扰动矩 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BE%7D) 的具体值，这在实际操作中往往是不可能的。另一种比较灵活的方法就是在控制律里引入积分环节，这样至少恒定的扰动以及参数误差都可以被稳定地压制！现在我们来看看所谓的PI状态反馈控制器的形式

(5.33) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D++%5Cmathbf%7B%5Cdot+x%7D_I%26%3D%5Cmathbf%7Bw-Cx%7D%5C%5C++%5Cmathbf%7Bu%7D~%26%3D%5Cmathbf%7B-Kx%2BK%7D_P%5Cleft%28+%5Cmathbf%7Bw-Cx%7D+%5Cright%29%2B%5Cmathbf%7BK%7D_I%5Cmathbf%7Bx%7D_I++%5Cend%7Balign%7D)

实际上参考信号和输出信号的差值就是误差值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Be_w%7D%3D%5Cmathbf%7Bw-y%7D%3D%5Cmathbf%7Bw-Cx%7D) ，而积分器状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_I%3D%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7Be_w%7Ddt) ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7Bx%7D_I%5Cin%5Cmathbb%7BR%7D%5Ep%29) 所以控制律即包含了比例和积分两个环节，即PI控制。

(5.34) ![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7Bu%7D%3D%5Cmathbf%7B-Kx%2BK%7D_P%5Cmathbf%7Be_w%7D%2B%5Cmathbf%7BK%7D_I%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7Be_w%7Ddt)

所以包含了原有状态变量以及新的积分器状态变量的扩展状态方程为

(5.35) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B%5Cdot+x%7D~%5C%5C%5Cmathbf%7B%5Cdot+x%7D_I%5Cend%7Bbmatrix%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7BA%7D%26%5Cmathbf%7B0%7D%5C%5C-%5Cmathbf%7BC%7D%26%5Cmathbf%7B0%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BA%7D_I%7D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+x%7D~%5C%5C%5Cmathbf%7Bx%7D_I%5Cend%7Bbmatrix%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7BB%7D%5C%5C%5Cmathbf%7B0%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BB%7D_I%7D%5Cmathbf%7Bu%7D%2B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B0%7D%5C%5C%5Cmathbf%7BI%7D%5Cend%7Bbmatrix%7D%5Cmathbf%7Bw%7D%2B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7BE%7D~%5C%5C%5Cmathbf%7B0%7D%5Cend%7Bbmatrix%7D%5Cmathbf%7Bd%7D%2C%5Cquad+%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bx%7D%280%29~%5C%5C%5Cmathbf%7B+x%7D_I%280%29%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bx%7D_0~%5C%5C%5Cmathbf%7B+x%7D_%7BI%2C0%7D%5Cend%7Bbmatrix%7D)

对于这个增广的矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D_I) ，想要自由配置极点，也必须考察它的能观性

> **定理5.1 增广矩阵的能控性**
> 当满足条件 ![[公式]](https://www.zhihu.com/equation?tex=rank%5Cbegin%7Bbmatrix%7D%5Cmathbf%7BA%7D%26%5Cmathbf%7BB%7D%5C%5C-%5Cmathbf%7BC%7D%26%5Cmathbf%7B0%7D%5Cend%7Bbmatrix%7D%3Dn%2Bp) 时，矩阵对 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7BA%7D%2C%5Cmathbf%7BB%7D%29) 的能控性就是扩展系统 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Cmathbf%7BA%7D_I%2C%5Cmathbf%7BB%7D_I%29) 的能控性。

而对增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%2C%5Cmathbf%7BK%7D_P%2C%5Cmathbf%7BK%7D_I) 的设计主要遵循以下两个步骤：

> ①第一步先设计扩展系统的状态反馈控制器，获得 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_1%2C%5Cmathbf%7BK%7D_2)
> (5.36) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D-%5Cbegin%7Bbmatrix%7D%5Cmathbf%7BK%7D_1%26%5Cmathbf%7BK%7D_2%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bx%7D~%5C%5C%5Cmathbf%7Bx%7D_I%5Cend%7Bbmatrix%7D)
> 与(5.33)比较可知
> (5.37) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_1%3D%5Cmathbf%7BK%7D%2B%5Cmathbf%7BK%7D_P%5Cmathbf%7BC%7D%2C%5Cqquad+%5Cmathbf%7BK%7D_2%3D-%5Cmathbf%7BK%7D_I)
>
> ②第二步就是确定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%2C%5Cmathbf%7BK%7D_P) 。通常先算出 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_P) 再求出 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D) 。
> 设初始条件满足 ![[公式]](https://www.zhihu.com/equation?tex=t%3D0) 时， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D%2C~~%5Cmathbf%7Bx%7D_%7BI%2C0%7D%3D%5Cmathbf%7B0%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bw%7D) 在 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cgeq0) 时恒定，
> (5.38) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%280%29%3D%5Cmathbf%7BK%7D_P%5Cmathbf%7Bw%7D)
> 当动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 渐近稳定时，可算出输出变量的稳态响应
> (5.39) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty+%3D%5Clim_%7Bt+%5Crightarrow+%5Cinfty%7D%7B%5Cmathbf%7By%7D%7D%28t%29%3D%5Cmathbf%7B-CA%5E%7B-1%7DBu%7D_%5Cinfty) 或 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D_%5Cinfty+%3D%5Cmathbf%7B-%28CA%5E%7B-1%7DB%29%5E%7B-1%7Dy%7D_%5Cinfty)
> 因为静态输入参考信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bw%7D) 和输出终态 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D_%5Cinfty) 会相等。但是增益一直不变，所以会有
> (5.40) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%280%29%3D+%5Cmathbf%7BK%7D_P%5Cmathbf%7Bw%7D%3D%5Cmathbf%7BK%7D_P%5Cmathbf%7By%7D_%5Cinfty%3D-%5Cmathbf%7BK%7D_P%5Cmathbf%7BCA%5E%7B-1%7DBu%7D_%5Cinfty)
> (5.41) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%280%29%3D%5Cmathbf%7Bu%7D_%5Cinfty)
> 于是有PI控制律下唯一的增益矩阵
> (5.42) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_P%3D%5Cmathbf%7B-%28CA%5E%7B-1%7DB%29%5E%7B-1%7D%7D%2C%5Cqquad++%5Cmathbf%7BK%7D_I%3D-%5Cmathbf%7BK%7D_2%2C%5Cqquad+%5Cmathbf%7BK%7D%3D%5Cmathbf%7BK%7D_1-%5Cmathbf%7BK%7D_P%5Cmathbf%7BC%7D)

在设计扩展系统时，不需要考虑扰动项 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BEd%7D) ，直接根据给定特征值来设计反馈增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_1%2C%5Cmathbf%7BK%7D_2) ，这是因为扩展矩阵设计时，加入新的积分器状态变量时，已经考虑了扰动的因素，而联合设计以后对于构成扩展系统的每一条状态方程都将是渐近稳定的，也就是说，它们的终态会趋于平衡点，也即

(5.43) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D_I%3D%5Cmathbf%7Bw-Cx%7D%3D%5Cmathbf%7B0%7D%5CRightarrow+%5Cmathbf%7Bw%7D%3D%5Cmathbf%7BCx%7D%3D%5Cmathbf%7By%7D_%5Cinfty)

值得一提的是，比例环节 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_P) 在控制律设计中不是必须的，它产生的作用也只是静态的前馈控制，因为参考信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bw%7D) 输进去以后，输入控制对象的输入信号 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%28t%29) 在极短时间内就会达到稳态值。此外，设计比例环节 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_P) 的前提是，动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 必须可逆，而当 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 不是渐进稳定的时候，可以直接让 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D_P%3D%5Cmathbf%7B0%7D) ，这样就能让设计简化了。

![img](https://pic4.zhimg.com/80/v2-5d33034b640995f815d968967beda657_hd.jpg)图5.3 PI状态反馈控制器设计

**例5.2 摩托车模型**

考虑摩托车的动力模型，此时外界扰动为恒定的侧风 ![[公式]](https://www.zhihu.com/equation?tex=d%3DF_w)。使用PI状态反馈控制器，对系统模型扩展，先设计扩展控制律，得到

(5.44) ![[公式]](https://www.zhihu.com/equation?tex=u%3D%5B~%5Cunderbrace%7B0.57~~~0.99~~~2.82%7D_%7B%5Cmathbf%7Bk%5ET_1%7D%7D~~~%5Cunderbrace%7B-3.16%7D_%7Bk_2%7D~%5D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bx%7D%5C%5C+~x_I%5Cend%7Bbmatrix%7D)

有一个状态变量，摩托车车体的偏航角 ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi) ，不是渐进稳定的，故让 ![[公式]](https://www.zhihu.com/equation?tex=k_P%3D0) ，继续算出

(5.45) ![[公式]](https://www.zhihu.com/equation?tex=k_I%3D-k_2%3D3.16%2C%5Cquad++%5Cmathbf%7Bk%7D%3D%5Cmathbf%7Bk%5ET_1%7D-k_P%5Cmathbf%7Bc%5ET%7D%3D%5Cmathbf%7Bk%5ET_1%7D%3D%5Cleft%5B+0.57~~~0.99~~~2.82+%5Cright%5D)

在初始状态时有一个偏移， ![[公式]](https://www.zhihu.com/equation?tex=t%3D5s) 时，侧风会以以阶跃信号形式施加 ![[公式]](https://www.zhihu.com/equation?tex=d%3DF_w%3D2000N) 的干扰力。下图就展示了对应的模拟过程，摩托车用于控制方向的输入量，前轮导向角 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdelta%3D0)表示不施加控制，即表示未控制的橙色虚线，蓝色实线表示接受了PI反馈控制。从下图可知，如果不进行控制，所有误差就会累积，而经过了反馈控制后，系统总体上性能有了很好改善。

![img](https://pic4.zhimg.com/80/v2-b4563a362eb00494a1f983b6d8ee9a27_hd.jpg)图5.4 摩托车受干扰后的控制模型

这章介绍了一些基本的基于全状态反馈控制器的设计方法，下一章将着重介绍基于能控标准型的设计方法。



# (六)用能控标准型设计控制器

上一篇初步谈到了如何利用状态变量的反馈来设计状态变量反馈控制器，相比于给定特征值后比较特征多项式系数，实际上还有更加一般方法，即基于能控标准型的设计方法。

## 6.1 SISO系统的Ackermann公式

第四篇的能控性里面提到过在线性时不变的SISO系统里变成能控标准型的变换

(6.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Ctilde+x_1%5C%5C%5Cvdots%5C%5C%5Ctilde+x_n%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+x%7D%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t%5ET%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t%5ETA%7D%5E%7Bn-1%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7B+x%7D%2C%5Cqquad+%5Cmathbf%7B+t%5ET%7D%3D%5Cleft%5B+0~~...~~0~~1+%5Cright%5D%5Cmathbf%7B+Q%7D%5E%7B-1%7D_S)

使用能控标准型来设计一个预给系统特征值的控制器是特别适合的，因为控制输入量 ![[公式]](https://www.zhihu.com/equation?tex=u) 唯独只会作用到能控标准型的最后一行。能控标准型的紧凑写法是

(6.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%7B%5Ctilde+x%7D_1~~~~%26%3D%7B%5Ctilde+x%7D_2%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bn-1%7D%26%3D%7B%5Ctilde+x%7D_n%5C%5C+%5Cdot%7B%5Ctilde+x%7D_n~~~~%26%3D%5Cmathbf%7Bg%5ET%5Ctilde+x%7D%2Bu%5C%5C+%5Cend%7Balign%7D) 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%5ET%7D%3D%5Cmathbf%7Bt%5ETA%5En%7D%5Cmathbf%7BT%7D%5E%7B-1%7D)

如果我们借助特殊的控制律来消除 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bg%5ET%5Ctilde+x%7D)

(6.3) ![[公式]](https://www.zhihu.com/equation?tex=u%3Dv-%5Cmathbf%7Bg%5ET%5Ctilde+x%7D)

那么最后合成的状态方程就会是新的输入变量 ![[公式]](https://www.zhihu.com/equation?tex=v) 控制下的完全解耦的形式

(6.4) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%7B%5Ctilde+x%7D_1~~~~%26%3D%7B%5Ctilde+x%7D_2%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bn-1%7D%26%3D%7B%5Ctilde+x%7D_n%5C%5C+%5Cdot%7B%5Ctilde+x%7D_n~~~~%26%3Dv%5C%5C+%5Cend%7Balign%7D)

这样我们就会得到一条以 ![[公式]](https://www.zhihu.com/equation?tex=v) 为输入量，长度为 ![[公式]](https://www.zhihu.com/equation?tex=n) 的连续直接积分链，再看看期望的特征值产生的特征多项式

(6.5) ![[公式]](https://www.zhihu.com/equation?tex=p%5E%2A%28%5Clambda%29%3Dp_0%2Bp_1%5Clambda%2B...%2Bp_%7Bn-1%7D%5Clambda%5E%7Bn-1%7D%2B%5Clambda%5En%3D%5Cprod_%7Bi%3D1%7D%5E%7Bn%7D%28%5Clambda-%5Clambda_i%5E%2A%29)

于是我们只要令新的输入量的控制律如下形式设计，就能实现我们想要的系统性能

(6.6) ![[公式]](https://www.zhihu.com/equation?tex=v%3D-p_0%7B%5Ctilde+x%7D_1-...-p_%7Bn-1%7D%7B%5Ctilde+x%7D_%7Bn%7D)

![img](https://pic2.zhimg.com/80/v2-6dae74fe60c769462bdba4502700d409_hd.png)图6.1 解耦的积分链

也就是说合成的闭环系统动态有

(6.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%7B%5Cmathbf%7B%5Ctilde+x%7D%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%261%26+%260%5C%5C+%5Cvdots%26+%26%5Cddots%26+%5C%5C+0%260%26+%261%5C%5C+-p_0%26-p_1%26...%26-p_%7Bn-1%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D_R%7D%5Cmathbf%7B%5Ctilde+x%7D)

它的特征多项式是和预期匹配的， ![[公式]](https://www.zhihu.com/equation?tex=%5Cdet%7B%28%5Clambda%5Cmathbf%7BI-%5Ctilde+A%7D_R%29%7D%3Dp%5E%2A%28%5Clambda%29) 。那么实际的控制变量 ![[公式]](https://www.zhihu.com/equation?tex=u) 开始的最初的反馈控制律就变为

(6.8) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+u%26%3D-p_0%7B%5Ctilde+x%7D_1-...-p_%7Bn-1%7D%7B%5Ctilde+x%7D_%7Bn%7D-%5Cmathbf%7Bg%5ET%5Ctilde+x%7D%5C%5C+%26%3D-%5Cunderbrace%7B%5Cmathbf%7Bt%5ET%7D%28p_0%5Cmathbf%7BI%7D%2B...%2Bp_%7Bn-1%7D%5Cmathbf%7BA%7D%5E%7Bn-1%7D%2B%5Cmathbf%7BA%7D%5En%29%7D_%7B%5Cmathbf%7Bk%5ET%7D%7D%5Cmathbf%7Bx%7D+%5Cend%7Balign%7D)

所以这条用来确定状态反馈Kalman增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D) 的公式即大名鼎鼎的Ackermann公式。

> **定理6.1 SISO系统下的Ackermann公式**
> 当系统完全能控，就可以使用状态反馈增益向量把系统构成闭环反馈，调节原有系统特征值到任意位置。状态反馈Kalman增益向量的公式为
> (6.9) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D%3D%5Cmathbf%7Bt%5ET%7D%28p_0%5Cmathbf%7BI%7D%2B...%2Bp_%7Bn-1%7D%5Cmathbf%7BA%7D%5E%7Bn-1%7D%2B%5Cmathbf%7BA%7D%5En%29)
> 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bt%5ET%7D) 是能控矩阵逆矩阵的最后一行，而系数 ![[公式]](https://www.zhihu.com/equation?tex=p_i) 是期望特征多项式的对应系数。

**例6.1 摩托车动力模型**

考察一个摩托车的动力模型的能控性

(6.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D-2.45%26-0.98%5C%5C+25.44%26-2.67%5Cend%7Bbmatrix%7D%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D0.95%5C%5C+36.32%5Cend%7Bbmatrix%7Du%2B%5Cbegin%7Bbmatrix%7D1.0%5Ccdot+10%5E%7B-5%7D%5C%5C8.82%5Ccdot+10%5E%7B-5%7D+%5Cend%7Bbmatrix%7Dd)

它的能控矩阵为

(6.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S%3D%5Cleft%5B+%5Cmathbf%7B+b%7D%2C%5Cmathbf%7BAb%7D%5Cright%5D%3D%5Cbegin%7Bbmatrix%7D0.95%26-38.02%5C%5C+36.32%26-72.95%5Cend%7Bbmatrix%7D%2C%5Cqquad%5Cdet%28%5Cmathbf%7B+Q%7D_S%29%3D1311.81%3E0)

![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S) 可逆，它逆矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S%5E%7B-1%7D) 的最后一行是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bt%5ET%7D%3D%5B-0.0277~~0.0007%5D) 。原本的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D) 的两个特征值为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%2F2%7D%3D-2.562%5Cpm+j4.999) ，这个系统是渐近稳定的，但是振荡也很强烈。所以我们的设计目标是让这个系统的动态能很快且有足够阻尼。

因为系统视为二阶系统，可以设计阻尼 ![[公式]](https://www.zhihu.com/equation?tex=D%5E%2A%3D%5Cfrac%7B%5Csqrt%7B2%7D%7D%7B2%7D) ，上升时间 ![[公式]](https://www.zhihu.com/equation?tex=T%5E%2A_%7Ban%7D%3D0.2s) ，算出时间常数 ![[公式]](https://www.zhihu.com/equation?tex=T%5E%2A%3DTe%5E%7B-%5Cfrac%7B%5Cpi%7D%7B4%7D%7D%5Capprox+0.0912s) 于是能给出想要的特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%2F2%7D%5E%2A%3D-7.754%5Cpm+j7.754) 。用式(6.9)算出反馈增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bk%5ET%7D%3D%5Cleft%5B+-1.56~~~0.327+%5Cright%5D) ，同时算出静态前置滤波器放大增益 ![[公式]](https://www.zhihu.com/equation?tex=S%3D%28%5Cmathbf%7Bc%5ET%7D%28%5Cmathbf%7Bbk%5ET-A%29%7D%5E%7B-1%7D%5Cmathbf%7Bb%7D%29%5E%7B-1%7D%3D1.063) 。

令初值为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0%3D%5B0~~~17.2%5E%5Ccirc%2Fs%5D%5ET) ，参考输入信号为 ![[公式]](https://www.zhihu.com/equation?tex=w%3D3%5E%5Ccirc%2Fs) ，得到控制律

(6.12) ![[公式]](https://www.zhihu.com/equation?tex=u%3D-%5Cmathbf%7Bk%5ETx%7D%2BSw%3D-%5Cleft%5B+-1.56~~~0.327+%5Cright%5D%5Cmathbf%7Bx%7D%2B3.189)

下图展示了未反馈控制(蓝色虚线)，仅使用了状态反馈控制(橙色虚线)，同时使用了前置滤波器和状态反馈控制(绿色实线)三种不同情况的时域结果。

![img](https://pic2.zhimg.com/80/v2-6ab30c5b46b2537b622cef8c7fc7759d_hd.jpg)图6.2 摩托车动力模型的响应

## 6.2 MIMO系统的能控性指数

在MIMO的情况下，系统的状态反馈设计同样能类比SISO情况的能控标准型来实现。首先需要导出MIMO情况下的能控标准型，所以需要先引入**能控性指数**(Steuerbarkeitsindizes)的概念。为了便于联系，我们先把矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D%3D%5Cleft%5B+%5Cmathbf%7B+b_1%7D%2C...%2C%5Cmathbf%7B+b_m%7D+%5Cright%5D) 和向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%3D%5Bu_1%2C...%2Cu_m%5D%5ET) 拆开

(6.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot++x%7D%3D%5Cmathbf%7B+Ax%7D%2B%5Cmathbf%7B+Bu%7D%3D%5Cmathbf%7B+Ax%7D%2B%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%5Cmathbf%7B+b%7D_iu_i%2C%5Cqquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0)

假设矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+B%7D) 满秩， ![[公式]](https://www.zhihu.com/equation?tex=rank%28%5Cmathbf%7B+B%7D%29%3Dm) ，那么类似的能控矩阵就可以写成

(6.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S%3D%5B+%5Cmathbf%7B+b_1%7D%2C...%2C%5Cmathbf%7B+b_m%7D%2C+%5Cmathbf%7B+Ab_1%7D%2C...%2C%5Cmathbf%7B+Ab_m%7D%2C+%5Cmathbf%7B+A%7D%5E%7Bn-1%7D%5Cmathbf%7Bb_1%7D%2C...%2C%5Cmathbf%7B+A%7D%5E%7Bn-1%7D%5Cmathbf%7Bb_m%7D%5D)

如果是SISO情况，我们可以直接使用可逆的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S) 来求出能控标准型，但是在MIMO里不行，因为MIMO的能控矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Q%7D_S) 不一定是方阵。然而为了自由配置特征值所需的能控矩阵并不需要所有的 ![[公式]](https://www.zhihu.com/equation?tex=m%5Ccdot+n) 个列数来控制，事实上就如同SISO系统一样，我们也只需要 ![[公式]](https://www.zhihu.com/equation?tex=n) 个线性无关的有效列来控制状态变量。所以我们先找出 ![[公式]](https://www.zhihu.com/equation?tex=n) 个线性无关的列向量，这就引出了能控指数。

> **定义6.1 能控指数**
> 能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_i)指的是，第 ![[公式]](https://www.zhihu.com/equation?tex=i) 个式(6.13)所表示的能控系统的指数都是最小的整数，这个最小整数对应的列向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5E%7B%5Crho_i%7D%5Cmathbf%7Bb%7D_i) 都跟式(6.14)左边列的向量线性无关。

当MIMO的能控矩阵可逆时，系统是完全能控的，那么简化的能控矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+Q%7D_S) 也是完全能控的

(6.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+Q%7D_S%3D%5B+%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+A%7D%5E%7B%5Crho_1-1%7D%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+b%7D_m%2C...%2C+%5Cmathbf%7B+A%7D%5E%7B%5Crho_m-1%7D%5Cmathbf%7Bb_m%7D%5D%2C%5Cqquad+%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%5Crho_i%3Dn)

注意！简化的矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+Q%7D_S) 和原来的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B++Q%7D_S) 矩阵元素排列方式不一样。

**例6.2 计算能控指数**

给定系统

(6.16) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D0%260%261%260%5C%5C+1%260%262%260%5C%5C+0%261%263%261%5C%5C+0%260%26-1%262%5Cend%7Bbmatrix%7D%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D1%260%5C%5C0%260%5C%5C+0%260%5C%5C+0%261%5Cend%7Bbmatrix%7D%5Cmathbf%7Bu%7D)

其能控矩阵为

(6.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26~+%5Cbegin%7Bmatrix%7D%5Cmathbf%7B++b%7D_1+%26%5Cmathbf%7B++b%7D_2+%26%5Cmathbf%7B+Ab%7D_1+%26%5Cmathbf%7B+A+b%7D_2+%26%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7Bb%7D_1+%26%5Cmathbf%7B+A+%7D%5E2%5Cmathbf%7Bb%7D_2+%26%5Cmathbf%7B+A%7D%5E3%5Cmathbf%7Bb%7D_1+%26%5Cmathbf%7B+A+%7D%5E3%5Cmathbf%7Bb%7D_2+%5Cend%7Bmatrix%7D%5C%5C+%5Cmathbf%7B++Q%7D_S%3D%26+%5Cbegin%7Bbmatrix%7D+1%26~0%26~+~~~0%26~~~~~~0%26~~~~~~~0%26~~~~~~~~1%26~~~~~~1%26~~~~~~~5~~%5C%5C+0%26~0%26+~~~~1%26~~~~~~0%26~~~~~~~0%26~~~~~~~~2%26~~~~~~2%26~~~~~~~11~~%5C%5C++0%26~0%26~~~~0%26~~~~~~1%26~~~~~~~1%26~~~~~~~~5%26~~~~~~3%26~~~~~20%5C%5C++0%26~1%26~~~~0%26~~~~~~2%26~~~~~~~0%26~~~~~~~~3%26~~~-1%26~~~~~1%5C%5C++%5Cend%7Bbmatrix%7D+%5Cend%7Balign%7D)

接下来要找到第一个能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1) 。显然 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3D1) 时， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+Ab%7D_1) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+b%7D_1%2C%5Cmathbf%7B+b%7D_2) 线性无关。这样应有 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3E1) 。事实上 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3D2) 时，有线性组合 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7Bb%7D_1%3D%5Cmathbf%7B+Ab%7D_2-2%5Cmathbf%7B+b%7D_2) ，类比，得到 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_2%3D2) 时，也有线性组合 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7Bb%7D_2%3D%5Cmathbf%7B+b%7D_1%2B3%5Cmathbf%7B+b%7D_2%2B2%5Cmathbf%7B+Ab%7D_1%2B5%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7Bb%7D_1) 。所以能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3D%5Crho_2%3D2) ，就会有简化的能控矩阵

(6.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%26~+%5Cbegin%7Bmatrix%7D~%5Cmathbf%7B++b%7D_1+%26%5Cmathbf%7B+Ab%7D_1+%26%5Cmathbf%7B++b%7D_2+%26%5Cmathbf%7B+A+b%7D_2++%5Cend%7Bmatrix%7D%5C%5C++%5Cmathbf%7B+%5Ctilde+Q%7D_S%3D%26+%5Cbegin%7Bbmatrix%7D++1%26~~~~0%26~+~~~0%26~~~~0%26%5C%5C+0%26~~~~1%26+~~~~0%26~~~~0%5C%5C+0%26~~~~0%26~~~~0%26~~~~1%5C%5C+++0%26~~~~0%26~~~~1%26~~~~2%5C%5C++%5Cend%7Bbmatrix%7D+%5Cend%7Balign%7D)

## 6.3 MIMO情况下的能控标准型

能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_i) 对于MIMO系统是有根本性意义的，因为借助能控指数简化的能控矩阵就可以把MIMO系统变换到能控标准型。借助变换矩阵

(6.19) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D%3D%5Cmathbf%7BTx%7D%2C%5Cqquad+%5Cmathbf%7B%5Ctilde+x%7D%3D%5Cbegin%7Bbmatrix%7D%5Ctilde+x_%7B1%2C1%7D%5C%5C%5Cvdots%5C%5C%5Cunderline%7B%5Ctilde+x_%7B1%2C%5Crho_1%7D%7D%5C%5C%5Cvdots%5C%5C%5Coverline%7B%5Ctilde+x_%7Bm%2C1%7D%7D%5C%5C%5Cvdots%5C%5C%5Ctilde+x_%7Bm%2C%5Crho_m%7D%5Cend%7Bbmatrix%7D%2C%5Cqquad%5Cmathbf%7BT%7D%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ET%7D%5C%5C%5Cvdots%5C%5C%5Cunderline%7B%5Cmathbf%7B+t_1%5ETA%7D%5E%7B%5Crho_1-1%7D%7D%5C%5C%5Cvdots%5C%5C%5Coverline%7B~~~~~%5Cmathbf%7B+t_m%5ET%7D~~~~~%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ETA%7D%5E%7B%5Crho_m-1%7D%5Cend%7Bbmatrix%7D)

向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_i%5ET%7D)需要通过类似的规则从简化的能控矩阵中获得

(6.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+t_1%5ET%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ET%7D+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+e_1%5ET%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+e_m%5ET%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7B+%5Ctilde+Q%7D_S%5E%7B-1%7D%2C%5Cqquad+%5Cmathbf%7B+e_i%5ET%7D%3D%5B%5Cunderbrace%7B0%2C...%2C0%7D_%7B%28%5Csum_%7Bj%3D1%7D%5E%7Bi%7D%7B%5Crho_j%7D%29-1%7D%2C1%2C0%2C...%2C0%5D%5Cin+%5Cmathbb%7BR%7D%5En)

其中，向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_i%5ET%7D) 是第 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Csum_%7Bj%3D1%7D%5E%7Bi%7D%7B%5Crho_j%7D%29) 行的简化能控矩阵的逆矩阵的元素构成的向量。

> **定理6.2 MIMO系统的能控标准型变换**
> 如果线性MIMO系统满足 ![[公式]](https://www.zhihu.com/equation?tex=rank%28%5Cmathbf%7B+B%7D%29%3Dm) 且完全能控，能控指数为 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%2C...%2C%5Crho_m) .那么可以把式(6.13)对应的系统变换为能控标准型
> (6.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D++%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C1%7D~~~~%26%3D%7B%5Ctilde+x%7D_%7Bi%2C2%7D%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C%5Crho_i-1%7D%26%3D%7B%5Ctilde+x%7D_%7Bi%2C%5Crho_i%7D%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C%5Crho_i%7D~~~~%26%3D%5Cmathbf%7Bg_i%5ET%5Ctilde+x%7D%2B%5Cmathbf%7Bh_i%5ETu%7D%2C%5Cquad+i%3D1%2C...%2Cm%5C%5C+%5Cend%7Balign%7D) 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D++%5Cmathbf%7Bg_i%5ET%7D%26%3D%5Cmathbf%7Bt_i%5ETA%7D%5E%7B%5Crho_i%7D%5Cmathbf%7BT%7D%5E%7B-1%7D%5C%5C+%5Cmathbf%7Bh_i%5ET%7D%26%3D%5Cmathbf%7Bt_i%5ETA%7D%5E%7B%5Crho_i%7D%5Cmathbf%7BB%7D+%5Cend%7Balign%7D+)
> 向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_i%5ET%7D) 是第 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Csum_%7Bj%3D1%7D%5E%7Bi%7D%7B%5Crho_j%7D%29) 行的简化能控矩阵的逆矩阵的元素构成的向量。

那么矩阵表示的能控标准型形式为

(6.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%7B%5Cmathbf%7B%5Ctilde+x%7D%7D%3D%5Cunderbrace%7B+%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+D%7D_1%26%5Cmathbf%7B%5Ctilde+N%7D_1%5E2%26%5Cdots%26%5Cmathbf%7B%5Ctilde+N%7D_1%5Em%5C%5C++%5Cmathbf%7B%5Ctilde+N%7D_2%5E1%26%5Cmathbf%7B%5Ctilde+D%7D_2%26%5Cdots%26%5Cmathbf%7B%5Ctilde+N%7D_2%5Em%5C%5C+%5Cvdots%26%5Cvdots%26%5Cddots%26%5Cvdots%5C%5C++%5Cmathbf%7B%5Ctilde+N%7D_m%5E1%26%5Cmathbf%7B%5Ctilde+N%7D_m%5E2%26%5Cdots%26%5Cmathbf%7B%5Ctilde+D%7D_m%5C%5C+%5Cend%7Bbmatrix%7D+%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D%3D%5Cmathbf%7BTAT%7D%5E%7B-1%7D%7D%5Cmathbf%7B%5Ctilde+x%7D%2B%5Cunderbrace%7B+%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+B%7D_1%5C%5C++%5Cmathbf%7B%5Ctilde+B%7D_2%5C%5C+%5Cvdots%5C%5C++%5Cmathbf%7B%5Ctilde+B%7D_m%5C%5C+%5Cend%7Bbmatrix%7D+%7D_%7B%5Cmathbf%7B%5Ctilde+B%7D%3D%5Cmathbf%7BTB%7D%7D%5Cmathbf%7Bu%7D)

其中矩阵块为

(6.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+D%7D_i%3D%5Cbegin%7Bbmatrix%7D0%261%26+%260%5C%5C+%5Cvdots%26%26%5Cddots%5C%5C0%260%26%261%5C%5C+%5Ctimes%26%5Ctimes%26%5Cdots%26%5Ctimes%5C%5C+%5Cend%7Bbmatrix%7D%5Cin+%5Cmathbb%7BR%7D%5E%7B%5Crho_i%5Ctimes+%5Crho_i%7D%2C%5Cqquad+%5Cmathbf%7B+%5Ctilde+N%7D_i%5Ej%3D%5Cbegin%7Bbmatrix%7D0%26%5Cdots%260%5C%5C+%5Cvdots%26%26%5Cvdots%5C%5C++0%26%5Cdots%260%5C%5C%5Ctimes%26%5Cdots%26%5Ctimes%5C%5C+%5Cend%7Bbmatrix%7D%5Cin+%5Cmathbb%7BR%7D%5E%7B%5Crho_i%5Ctimes+%5Crho_j%7D)

(6.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+B%7D_i%3D%5Cbegin%7Bbmatrix%7D0%26%5Cdots%260%260%260%26%5Cdots%260%5C%5C+%5Cvdots%26%26%5Cvdots%26%5Cvdots%26%5Cvdots%26%26%5Cvdots%5C%5C+0%26%5Cdots%260%260%260%26%5Cdots%260%5C%5C+%5Ctimes%26%5Cdots%26%5Ctimes%261%26%5Ctimes%26%5Cdots%26%5Ctimes%5C%5C+%5Cend%7Bbmatrix%7D%5Cin+%5Cmathbb%7BR%7D%5E%7B%5Crho_i%5Ctimes+m%7D)

符号" ![[公式]](https://www.zhihu.com/equation?tex=%5Ctimes) "表示一个不一定为0或1的组成元素。总的来说，在 ![[公式]](https://www.zhihu.com/equation?tex=%28m%3E1%29) 的MIMO的情况下就是有 ![[公式]](https://www.zhihu.com/equation?tex=m) 个方块对应的 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_i) 维的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Ctilde+x_%7Bi%2C1%7D%2C...%2C%5Ctilde+x_%7Bi%2C%5Crho_i%7D%29) 分别构成了一组状态方程。



**例6.3 计算能控标准型**

继续考察前面例6.2的简化过的能控矩阵的逆矩阵

(6.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+Q%7D_S%5E%7B-1%7D%3D%5Cbegin%7Bbmatrix%7D++1%260%260%260%5C%5C+0%261%26+0%260%5C%5C+0%260%262%261%5C%5C+++0%260%261%260%5C%5C++%5Cend%7Bbmatrix%7D)

能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3D%5Crho_2%3D2) 所以 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_1%5ET%7D) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_2%5ET%7D) 分别为逆矩阵第二行和第四行的元素

(6.26) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_1%5ET%7D%3D%5B0+~~1~~0~~0%5D%2C%5Cquad+%5Cmathbf%7B+t_2%5ET%7D%3D%5B0+~~0~~1~~0%5D)

(6.27) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D%3D%5Cbegin%7Bbmatrix%7D+%5Ctilde+x_%7B1%2C1%7D%5C%5C%5Ctilde+x_%7B1%2C2%7D%5C%5C%5Ctilde+x_%7B2%2C1%7D%5C%5C%5Ctilde+x_%7B2%2C2%7D+%5Cend%7Bbmatrix%7D%3D%5Cmathbf%7BTx%7D%2C%5Cquad+%5Cmathbf%7BT%7D%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ET%7D%5C%5C%5Cmathbf%7B+t_1%5ETA%7D%5C%5C%5Cmathbf%7B+t_2%5ET%7D%5C%5C%5Cmathbf%7B+t_2%5ETA%7D%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D++0%261%260%260%5C%5C+1%260%26+2%260%5C%5C+0%260%261%261%5C%5C+++0%261%263%261%5C%5C++%5Cend%7Bbmatrix%7D)

最后经过计算，得到标准型的矩阵表达

(6.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Cdot+x%7D%3D%5Cbegin%7Bbmatrix%7D+0%260%261%260%5C%5C++0%260%261%262%5C%5C++0%260%260%261%5C%5C++-2%261%26-7%265%5Cend%7Bbmatrix%7D%5Cmathbf%7B+x%7D%2B%5Cbegin%7Bbmatrix%7D0%260%5C%5C1%260%5C%5C+0%260%5C%5C+0%261%5Cend%7Bbmatrix%7D%5Cmathbf%7Bu%7D)

## 6.4 MIMO系统的状态变量解耦和预给特征值

类似SISO系统，在MIMO系统也有线性的状态反馈的控制律可以设计

(6.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D-%5Cmathbf%7BKx%7D%2B%5Cmathbf%7BSw%7D)

然后再预给特征值，配置系统性能。所以在能控标准型时设计是特别有优势的，因为控制输入量每每都在单个积分链的末端进入，或者说是在每个矩阵块 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+B%7D_i) 的最后一行出现。我们同样可以利用MIMO系统能控标准型的解耦形式来设计反馈控制律。

能控标准型的微分方程的最后一行，也可以放在一起这样表达

(6.30) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D%5Cdot%7B%5Ctilde+x%7D_%7B1%2C%5Crho_1%7D%5C%5C%5Cvdots%5C%5C%5Cdot%7B%5Ctilde+x%7D_%7Bm%2C%5Crho_m%7D+%5Cend%7Bbmatrix%7D+%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ETA%7D%5E%7B%5Crho_1%7D+%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ETA%7D%5E%7B%5Crho_m%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7BT%7D%5E%7B-1%7D+%5Cmathbf%7B+%5Ctilde+x%7D+%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ETA%7D%5E%7B%5Crho_1-1%7D+%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ETA%7D%5E%7B%5Crho_m-1%7D%5Cend%7Bbmatrix%7D%5Cmathbf%7BB%7D+%7D_%7B%5Cmathbf%7BH%7D%7D%5Cmathbf%7B+u%7D+)

假设有 ![[公式]](https://www.zhihu.com/equation?tex=rank%28%5Cmathbf%7B+B%7D%29%3Dm) ，那么耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bm%5Ctimes+m%7D) 可逆，于是反推出输入控制量为

(6.31) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%3D%5Cmathbf%7B+H%7D%5E%7B-1%7D%5Cleft%28+%5Cmathbf%7B+v%7D+-%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ETA%7D%5E%7B%5Crho_1%7D+%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ETA%7D%5E%7B%5Crho_m%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7BT%7D%5E%7B-1%7D+%5Cmathbf%7B+%5Ctilde+x%7D+%5Cright%29)

![img](https://pic1.zhimg.com/80/v2-242b3ec2d1baba7b3cdb2698c1dc8fd8_hd.jpg)图6.3 MIMO系统解耦后的积分链

于是就有了新的输入变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D%3D%5Bv_1%2C...%2Cv_m%5D%5ET) 使得原有的能控标准型各个状态变量之间完全解耦，并且能得到总共 ![[公式]](https://www.zhihu.com/equation?tex=m) 条积分链，如图6.3所示。于是就可以和SISO系统里一样，设计 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D) 满足预给特征值产生的特征多项式。

(6.32) ![[公式]](https://www.zhihu.com/equation?tex=v_i%3D-p_%7Bi%2C0%7D%5Ctilde+x_%7Bi%2C1%7D-...-p_%7Bi%2C%5Crho_i-1%7D%5Ctilde+x_%7Bi%2C%5Crho_i%7D%2C%5Cqquad+i%3D1%2C...%2Cm)

其中 ![[公式]](https://www.zhihu.com/equation?tex=p_%7Bi%2Cj%7D) 为期望特征多项式的系数

(6.33) ![[公式]](https://www.zhihu.com/equation?tex=p%5E%2A_i%28%5Clambda%29%3Dp_%7Bi%2C0%7D%2Bp_%7Bi%2C1%7D%5Clambda%2B...%2Bp_%7Bi%2C%5Crho_i-1%7D%5Clambda%5E%7B%5Crho_i-1%7D%2B%5Clambda%5E%7B%5Crho_i%7D%3D%5Cprod_%7Bj%3D1%7D%5E%7B%5Crho_i%7D%28%5Clambda-%5Clambda_%7Bi%2Cj%7D%5E%2A%29)

其中第 ![[公式]](https://www.zhihu.com/equation?tex=i) 个矩阵块对应的完全解耦的状态方程为(总共 ![[公式]](https://www.zhihu.com/equation?tex=m) 个)

(6.34) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C1%7D%5C%5C%5Cvdots%5C%5C%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C%5Crho_i%7D+%5Cend%7Bbmatrix%7D+%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%261%26+%260%5C%5C+%5Cvdots%26+%26%5Cddots%26+%5C%5C+0%260%26+%261%5C%5C+-p_%7Bi%2C0%7D%26-p_%7Bi%2C1%7D%26...%26-p_%7Bi%2C%5Crho_i-1%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D_%7BR%2Ci%7D%7D%5Cbegin%7Bbmatrix%7D%5Ctilde+x_%7Bi%2C1%7D%5C%5C%5Cvdots%5C%5C+%5Ctilde+x_%7Bi%2C%5Crho_i%7D+%5Cend%7Bbmatrix%7D)

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdet%28%5Clambda%5Cmathbf%7BI-%5Ctilde+A%7D_%7BR%2Ci%7D%29%3Dp%5E%2A_i%28%5Clambda%29) 。实际的输入控制律即

(6.35) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+u%7D%3D-%5Cunderbrace%7B%5Cmathbf%7B+H%7D%5E%7B-1%7D%5Cleft%28+%5Cbegin%7Bbmatrix%7Dp_%7B1%2C0%7D%5Cmathbf%7Bt_1%5ET%7D%2B...%2Bp_%7B1%2C%5Crho_1-1%7D%5Cmathbf%7Bt_1%5ETA%7D%5E%7B%5Crho_1-1%7D+%5C%5C%5Cvdots%5C%5Cp_%7Bm%2C0%7D%5Cmathbf%7Bt_m%5ET%7D%2B...%2Bp_%7Bm%2C%5Crho_1-1%7D%5Cmathbf%7Bt_m%5ETA%7D%5E%7B%5Crho_m-1%7D+%5Cend%7Bbmatrix%7D%2B%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ETA%7D%5E%7B%5Crho_1%7D+%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+t_m%5ETA%7D%5E%7B%5Crho_m%7D+%5Cend%7Bbmatrix%7D+%5Cright%29++%7D_%7B%5Cmathbf%7B++K%7D%7D%5Cmathbf%7B++x%7D)

这里就包含了MIMO的Ackermann公式。

> **定理3.3 MIMO系统下的Ackermann公式**
> 如果式(6.13)对应的MIMO系统的控制矩阵 ![[公式]](https://www.zhihu.com/equation?tex=rank%28%5Cmathbf%7B+B%7D%29%3Dm) ，且完全能控，那么经过状态反馈的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D_R%3D%5Cmathbf%7BA-BK%7D) 是可以任意配置特征值的，用于反馈的Kalman增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D) 为
> (6.36) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%3D%5Cmathbf%7B+H%7D%5E%7B-1%7D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bt_1%5ET%7D%28p_%7B1%2C0%7D%5Cmathbf%7BI%7D%2Bp_%7B1%2C1%7D%5Cmathbf%7BA%7D%2B...%2Bp_%7B1%2C%5Crho_1-1%7D%5Cmathbf%7BA%7D%5E%7B%5Crho_1-1%7D%2B+%5Cmathbf%7BA%7D%5E%7B%5Crho_1%7D+%29%5C%5C%5Cvdots%5C%5C%5Cmathbf%7Bt_m%5ET%7D%28p_%7Bm%2C0%7D%5Cmathbf%7BI%7D%2Bp_%7Bm%2C1%7D%5Cmathbf%7BA%7D%2B...%2Bp_%7Bm%2C%5Crho_1-1%7D%5Cmathbf%7BA%7D%5E%7B%5Crho_m-1%7D+%2B%5Cmathbf%7B+A%7D%5E%7B%5Crho_m%7D%29%5Cend%7Bbmatrix%7D)
> 耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH%7D) 由式(6.30)给出，而向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_i%5ET%7D) 则是由简化能控矩阵的逆矩阵的第 ![[公式]](https://www.zhihu.com/equation?tex=%28%5Csum_%7Bj%3D1%7D%5E%7Bi%7D%7B%5Crho_j%7D%29) 行的元素组成。而系数 ![[公式]](https://www.zhihu.com/equation?tex=p_%7Bi%2Cj%7D) 为期望的预给特征多项式的系数。

在MIMO系统里会享有，在SISO系统中不存在的，许多不同的自由度，比如预给特征值的时候，这 ![[公式]](https://www.zhihu.com/equation?tex=m) 个特征多项式的选择是不唯一的，而这合计 ![[公式]](https://www.zhihu.com/equation?tex=n) 个特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+%5Clambda_%7B1%2C1%7D%5E%2A+%2C...%2C%5Clambda_%7B1%2C%5Crho_1%7D%5E%2A%5Cright%5C%7D) ..... ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+%5Clambda_%7Bm%2C1%7D%5E%2A+%2C...%2C%5Clambda_%7Bm%2C%5Crho_m%7D%5E%2A%5Cright%5C%7D) 怎么分配到对应的特定的能控指数下。此外原则上，只要能够让简化的能控矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+%5Ctilde+Q%7D_S) 满秩，还有很多不同的能控指数的组合 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+%5Crho_1%5E%7B%27%7D%2C...%2C%5Crho_m%5E%7B%27%7D%5Cright%5C%7D) 。



**例6.4 计算反馈Kalman增益**

继续拓展设计来自例6.3里的系统，其中已经求得

能控指数 ![[公式]](https://www.zhihu.com/equation?tex=%5Crho_1%3D%5Crho_2%3D2)， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+t_1%5ET%7D%3D%5B0+~~1~~0~~0%5D%2C%5Cquad+%5Cmathbf%7B+t_2%5ET%7D%3D%5B0+~~0~~1~~0%5D)

耦合矩阵为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+H%7D%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7B+t_1%5ETA%7D%5C%5C%5Cmathbf%7B+t_2%5ETA%7D%5Cend%7Bbmatrix%7D%5Cmathbf%7B+B%7D%3D%5Cbegin%7Bbmatrix%7D1%260%5C%5C0%261%5Cend%7Bbmatrix%7D) 所以其逆矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+H%7D%5E%7B-1%7D%3D%5Cmathbf%7B+I%7D) ，原本的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+A%7D) 的特征值为 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%2F2%7D%3D-0.2806%5Cpm+j0.419) , ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B3%2F4%7D%3D2.7806%5Cpm+j0.367) ，系统是不稳定的。现在选定期望的特征值移动到 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5C%7B+-1~~-1~~-2~~-2+%5Cright%5C%7D) 。这样两组特征值还可以自由分配，比如选出两对特征值

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cleft%5C%7B+%5Clambda_%7B1%2C1%7D%5E%2A%2C%5Clambda_%7B1%2C2%7D%5E%2A+%5Cright%5C%7D%26%3D%5Cleft%5C%7B+-1%2C-1%5Cright%5C%7D%5C%5C+%5Cleft%5C%7B+%5Clambda_%7B2%2C1%7D%5E%2A%2C%5Clambda_%7B2%2C2%7D%5E%2A+%5Cright%5C%7D%26%3D%5Cleft%5C%7B+-1%2C-1%5Cright%5C%7D+%5Cend%7Balign%7D) ![[公式]](https://www.zhihu.com/equation?tex=%5CRightarrow+%5Cquad+%5Cmathbf%7B+K%7D%3D%5Cbegin%7Bbmatrix%7D2%263%2611%262%5C%5C+1%267%2626%269+%5Cend%7Bbmatrix%7D)

抑或是另一种选法

![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cleft%5C%7B+%5Clambda_%7B1%2C1%7D%5E%2A%2C%5Clambda_%7B1%2C2%7D%5E%2A+%5Cright%5C%7D%26%3D%5Cleft%5C%7B+-1%2C-2%5Cright%5C%7D%5C%5C+%5Cleft%5C%7B+%5Clambda_%7B2%2C1%7D%5E%2A%2C%5Clambda_%7B2%2C2%7D%5E%2A+%5Cright%5C%7D%26%3D%5Cleft%5C%7B+-1%2C-2%5Cright%5C%7D+%5Cend%7Balign%7D) ![[公式]](https://www.zhihu.com/equation?tex=%5CRightarrow+%5Cquad+%5Cmathbf%7B+K%7D%3D%5Cbegin%7Bbmatrix%7D3%264%2613%262%5C%5C+1%265%2621%268+%5Cend%7Bbmatrix%7D)

------

这一章我们探讨了借助能控标准型设计系统状态反馈的Kalman增益，不过却完全没有考虑输出变量在系统坐标变换后的受到的影响，因为系统的耦合，最终输出不一定如我们所愿。下一章要继续探讨输入输出解耦的状态反馈控制器的设计。

# (七)输入输出解耦的控制器设计

在利用状态方程设计MIMO的能控标准型时，闭环系统的动态是完全不考虑输出变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D) 而直接预给的，MIMO系统的输出动态可能会因为状态变量之间的耦合导致变换到能控标准型时无法保证期望的系统动态。这就是输入输出变量解耦的必要性，这样输入和输出就不会耦合在一起，期望的动态会被直接加在输出上。

接下来假设，输入控制量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5Cin+%5Cmathbb%7BR%7D%5Em+) 输出变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%5Cin+%5Cmathbb%7BR%7D%5Ep) 具有相同的维度，即 ![[公式]](https://www.zhihu.com/equation?tex=m%3Dp) 。这种控制器的设计方法其实最开始源自Falb和Wolovich，还有更多的方法论都是基于输入输出线性化的非线性系统的理论。

## 7.1 相对微分度

要实现输入输出的解耦，需要用到**相对微分度**(relativer Grad)的概念。考察一个MIMO的系统

(7.1) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cmathbf%7BA+x%7D%2B%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%5Cmathbf%7Bb%7D_iu_i%5C%5C+y_i%26%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+x%7D%2C%5Cqquad+i%3D1%2C...%2Cm+%5Cend%7Balign%7D)

> **定义7.1 向量形式的相对微分度**
> 式(7.1)表示的线性系统会能用有向量表示的 ![[公式]](https://www.zhihu.com/equation?tex=m) 个相对微分度 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D) ，如果满足
> ① ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bc%7D_i%5ET%5Cmathbf%7BA%7D%5Ek%5Cmathbf%7Bb%7D_j%3D0%2C%5Cquad+i%3D1%2C...%2Cm%5Cquad+j%3D1%2C...%2Cm%5Cquad+k%3D0%2C1%2C...%2Cr_i-2)
> ②一个 ![[公式]](https://www.zhihu.com/equation?tex=%28m%5Ctimes+m%29) 的矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH_y%7D)
> (7.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH_y%7D%3D+%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7Bc%7D_1%5ET%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%5Cmathbf%7Bb%7D_1%26%5Cdots%26%5Cmathbf%7Bc%7D_i%5ET%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%5Cmathbf%7Bb%7D_m%5C%5C+%5Cvdots%26%26%5Cvdots%5C%5C+%5Cmathbf%7Bc%7D_m%5ET%5Cmathbf%7BA%7D%5E%7Br_m-1%7D%5Cmathbf%7Bb%7D_1%26%5Cdots%26%5Cmathbf%7Bc%7D_m%5ET%5Cmathbf%7BA%7D%5E%7Br_m-1%7D%5Cmathbf%7Bb%7D_m+%5Cend%7Bbmatrix%7D)
> 是满秩可逆的，即 ![[公式]](https://www.zhihu.com/equation?tex=rank%28%5Cmathbf%7BH_y%7D%29%3Dm)

指数 ![[公式]](https://www.zhihu.com/equation?tex=r_i) 的意义是很清楚的，当输出 ![[公式]](https://www.zhihu.com/equation?tex=y_i%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+x%7D) 关于时间连续求导后有

(7.3) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot+y_i%26%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+Ax%7D~~~~+~~%2B%5Cunderbrace%7B%5Cmathbf%7B+c%7D_i%5ET%5B%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+b%7D_m%5D%7D_%7B%3D%5Cmathbf%7B+0%7D~~%5Cbecause+%E2%91%A0%7D%5Cmathbf%7B+u%7D+%26%3D%26%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+Ax%7D%5C%5C+%5Cddot+y_i%26%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7B+x%7D~~~~%2B%5Cunderbrace%7B%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5B%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+b%7D_m%5D%7D_%7B%3D%5Cmathbf%7B+0%7D~~%5Cbecause+%E2%91%A0%7D%5Cmathbf%7B+u%7D+%26%3D%26%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E2%5Cmathbf%7B+x%7D%5C%5C+%26~~%5Cvdots%26~~%5Cvdots%26%5C%5C+y_i%5E%7B%28r_i-1%29%7D%26%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E%7Br_i-1%7D%5Cmathbf%7B+x%7D%2B%5Cunderbrace%7B%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E%7Br_i-2%7D%5B%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+b%7D_m%5D%7D_%7B%3D%5Cmathbf%7B+0%7D~~%5Cbecause+%E2%91%A0%7D%5Cmathbf%7B+u%7D+%26%3D%26%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E%7Br_i-1%7D%5Cmathbf%7B+x%7D%5C%5C+y_i%5E%7B%28r_i%29%7D%26%3D%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E%7Br_i%7D%5Cmathbf%7B+x%7D~~~~%2B%5Cunderbrace%7B%5Cmathbf%7B+c%7D_i%5ET%5Cmathbf%7B+A%7D%5E%7Br_i-1%7D%5B%5Cmathbf%7B+b%7D_1%2C...%2C%5Cmathbf%7B+b%7D_m%5D%7D_%7B%5Cne%5Cmathbf%7B+0%7D~~%5Cbecause+%E2%91%A1%7D%5Cmathbf%7B+u%7D++%5Cend%7Balign%7D)

我们知道满足这样所有假设①②后，就能得到独立的![[公式]](https://www.zhihu.com/equation?tex=m) 个相对微分度 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D)，它表示从 ![[公式]](https://www.zhihu.com/equation?tex=m) 个输入 ![[公式]](https://www.zhihu.com/equation?tex=u_i) 开始，各有 ![[公式]](https://www.zhihu.com/equation?tex=r_i) 个解耦后的相对的微分度为 ![[公式]](https://www.zhihu.com/equation?tex=r_i)的阶数逐步递增的微分方程。而且输出变量 ![[公式]](https://www.zhihu.com/equation?tex=y_i) 必须经历 ![[公式]](https://www.zhihu.com/equation?tex=r_i) 次微分以后才会第一次到达输入端，也就是每个控制输入变量 ![[公式]](https://www.zhihu.com/equation?tex=u_i) 的直接作用只出现在第 ![[公式]](https://www.zhihu.com/equation?tex=r_i) 阶的输出变量上，之后的影响都是间接积分得到。输入量只在入口处出现，跟后面中间过渡量无关，所以输入输出是解耦的。

当所有相对微分度之和的总微分度不超过系统阶数时

(7.4) ![[公式]](https://www.zhihu.com/equation?tex=r%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%7Br%7D_i%5Cleq+n)

那么最高阶的输出变量的 ![[公式]](https://www.zhihu.com/equation?tex=y_i%5E%7B%28r_i%29%7D) 就决定了系统的输入输出解耦形式，把(7.3)最后一行表示的写得紧凑一点

(7.5) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+y%5E%7B%28r_1%29%7D%5C%5C%5Cvdots%5C%5Cy%5E%7B%28r_m%29%7D+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+c%7D_1%5ET%5Cmathbf%7B+A%7D%5E%7Br_1%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+c%7D_m%5ET%5Cmathbf%7B+A%7D%5E%7Br_m%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7B+x%7D%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7Bc%7D_1%5ET%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%5Cmathbf%7Bb%7D_1%26%5Cdots%26%5Cmathbf%7Bc%7D_i%5ET%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%5Cmathbf%7Bb%7D_m%5C%5C+%5Cvdots%26%26%5Cvdots%5C%5C+%5Cmathbf%7Bc%7D_m%5ET%5Cmathbf%7BA%7D%5E%7Br_m-1%7D%5Cmathbf%7Bb%7D_1%26%5Cdots%26%5Cmathbf%7Bc%7D_m%5ET%5Cmathbf%7BA%7D%5E%7Br_m-1%7D%5Cmathbf%7Bb%7D_m+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BH_y%7D%7D+%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+u_1%5C%5C%5Cvdots%5C%5Cu_m+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bu%7D%7D)

显然SISO系统的微分度只是MIMO系统的相对微分度的一维简化，即 ![[公式]](https://www.zhihu.com/equation?tex=m%3Dp%3D1) 时。定义7.1的简化为

(7.6) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%E2%91%A0%26~~~~%5Cmathbf%7Bc%7D%5ET%5Cmathbf%7BA%7D%5Ek%5Cmathbf%7Bb%7D%3D0%2C%5Cquad+k%3D0%2C1%2C...%2Cr_i-2%5C%5C+%E2%91%A1%26~~~~H_y%3D%5Cmathbf%7Bc%7D%5ET%5Cmathbf%7BA%7D%5E%7Br-1%7D%5Cmathbf%7Bb%7D%5Cne+0%2C%5Cquad+r%5Cleq+n+%5Cend%7Balign%7D)

## 7.2 输入输出标准型

相对微分度向量 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D) 能用来确定正则的状态变量变换矩阵

(7.7) ![[公式]](https://www.zhihu.com/equation?tex=%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+x%7D_y%5C%5C%5Cboldsymbol%7B%5Ceta%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+x%7D%7D+%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7BT%7D_y%5C%5C%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7Bx%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D_y%3D%5Cbegin%7Bbmatrix%7D+%5Ctilde+x_%7B1%2C1%7D%5C%5C%5Cvdots%5C%5C%5Cunderline%7B%5Ctilde+x_%7B1%2Cr_1%7D%7D%5C%5C%5Cvdots%5C%5C%5Coverline%7B%5Ctilde+x_%7Bm%2C1%7D%7D%5C%5C%5Cvdots%5C%5C%5Ctilde+x_%7Bm%2Cr_m%7D+%5Cend%7Bbmatrix%7D%5Cin+%5Cmathbb%7BR%7D%5Er) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D_y%3D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7Bc%7D_1%5ET%5C%5C%5Cvdots%5C%5C%5Cunderline%7B%5Cmathbf%7Bc%7D_1%5ET%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%7D%5C%5C%5Cvdots%5C%5C%5Coverline%7B~~~~~%5Cmathbf%7Bc%7D_m%5ET~~~~~%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7Bc%7D_m%5ET%5Cmathbf%7BA%7D%5E%7Br_m-1%7D+%5Cend%7Bbmatrix%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Br%5Ctimes+n%7D)

第一个 ![[公式]](https://www.zhihu.com/equation?tex=r) 行的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D_y) 表示了所有输出变量 ![[公式]](https://www.zhihu.com/equation?tex=y_i) 的导数 ![[公式]](https://www.zhihu.com/equation?tex=y_i%5E%7B%28j%29%7D%2Cj%3D1%2C...%2Cr_i-1) 。如果想使得状态变量的变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D) 存在且可逆，必须使剩下的变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%5Cin%5Cmathbb%7BR%7D%5E%7B%28n-r%29%5Ctimes+n%7D) ，所以

(7.8) ![[公式]](https://www.zhihu.com/equation?tex=rank%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7BT%7D_y%5C%5C%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D+%5Cend%7Bbmatrix%7D%3Dn)

所以能导出输入输出标准型的变换定理

> **定理 7.1 线性输入输出标准型**
> 一个式(7.1)决定的线性系统的输出 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7By%7D%3D%5By_1%2C...%2Cy_m%5D%5ET) 有相对微分度向量 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D)，且总的相对微分数 ![[公式]](https://www.zhihu.com/equation?tex=r%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%7Br%7D_i%5Cleq+n) 。那么总可以选出一个变换矩阵![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%5Cin%5Cmathbb%7BR%7D%5E%7B%28n-r%29%5Ctimes+n%7D)来保证总的变换矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BT%7D) 是可逆的，并且系统能够变成输入输出标准型
> (7.9)**输入输出动态**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C1%7D~~~~%26%3D%5Ctilde+x_%7Bi%2C2%7D%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2Cr_i-1%7D%26%3D%5Ctilde+x_%7Bi%2Cr_i%7D%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2Cr_i%7D~~~~%26%3D%5Cmathbf%7Bg_%7By%2Ci%7D%5ET%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cmathbf%7Bg_%7B%5Ceta%2Ci%7D%5ET%7D%5Cboldsymbol%7B%5Ceta%7D%2B%5Cmathbf%7Bh_%7By%2Ci%7D%5ET%7D%5Cmathbf%7Bu%7D%2C%5Cqquad+i%3D1%2C...%2Cm+%5Cend%7Balign%7D)
> (7.10)**内动态**： ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cdot%5Ceta%7D~~~~~~~%3D%5Cmathbf%7BM_y%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cmathbf%7BM_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D%2B%5Cmathbf%7BNu%7D)
> 其中变换后的输出变量为 ![[公式]](https://www.zhihu.com/equation?tex=y_i%3D%5Ctilde+x_%7Bi%2C1%7D) , ![[公式]](https://www.zhihu.com/equation?tex=i%3D1%2C...%2Cm) ，其他矩阵向量分别为
> (7.11) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7Bg_%7Bi%7D%5ET%7D%26%3D%5B%5Cmathbf%7Bg_%7By%2Ci%7D%5ET%7D~~%5Cmathbf%7Bg_%7B%5Ceta%2Ci%7D%5ET%7D%5D%3D%5Cmathbf%7Bc%7D_i%5ET%5Cmathbf%7BA%7D%5E%7Br_i%7D%5Cmathbf%7BT%7D%5E%7B-1%7D%2C%5Cqquad+%26%5Cmathbf%7Bh_%7By%2Ci%7D%5ET%7D%26%3D%5Cmathbf%7Bc%7D_i%5ET%5Cmathbf%7BA%7D%5E%7Br_i-1%7D%5Cmathbf%7BB%7D%5C%5C+%5Cmathbf%7BM%7D~%26%3D%5B%5Cmathbf%7BM_%7By%7D%7D~~%5Cmathbf%7BM_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5D+%3D%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%5Cmathbf%7BA%7D%5Cmathbf%7BT%7D%5E%7B-1%7D%2C%5Cqquad+%26%5Cmathbf%7BN%7D~~~%26%3D%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%5Cmathbf%7BB%7D+%5Cend%7Balign%7D)

这合计 ![[公式]](https://www.zhihu.com/equation?tex=m) 条对解耦状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x%7D_y%5Cin+%5Cmathbb%7BR%7D%5E%7Br%7D) 的积分链，产生了系统输入输出解耦的动态，而剩下的子系统的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Ceta%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bn-r%7D) 就描述了所谓的**系统的内动态**(interne Dynamik)。在许多情况下，子系统的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Ceta%7D%3D%5B%5Ceta_1%2C...%2C%5Ceta_%7Bn-r%7D%5D%5ET) 也都可以分配给变换前系统唯一对应的状态变量 ![[公式]](https://www.zhihu.com/equation?tex=x_i) ，其经由 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Ceta%7D%3D%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%5Cmathbf%7Bx%7D) 得到。

## 7.3 状态解耦和特征值预给

取式(7.5)，它其实就是每个相对微分度下解耦的最后一行

(7.12)![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D%3D%5Cbegin%7Bbmatrix%7D+y%5E%7B%28r_1%29%7D%5C%5C%5Cvdots%5C%5Cy%5E%7B%28r_m%29%7D+%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D+%5Cdot%7B%5Ctilde+x%7D_%7B1%2Cr_1%7D%5C%5C%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bm%2Cr_m%7D%5Cend%7Bbmatrix%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+c%7D_1%5ET%5Cmathbf%7B+A%7D%5E%7Br_1%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+c%7D_m%5ET%5Cmathbf%7B+A%7D%5E%7Br_m%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7BT%7D%5E%7B-1%7D%7D_%7B%5Cmathbf%7BG%7D%7D%5Cmathbf%7B%5Ctilde+x%7D+%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B+c%7D_1%5ET%5Cmathbf%7B+A%7D%5E%7Br_1-1%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7B+c%7D_m%5ET%5Cmathbf%7B+A%7D%5E%7Br_m-1%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7BB%7D%7D_%7B%5Cmathbf%7BH_y%7D%7D+%5Cmathbf%7Bu%7D)

因为基本假设，即耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH_y%7D) 满秩可逆，且存在微分度向量 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D) 那么原本的输入控制变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D) 就还可以用新的输入控制量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D%5Cin%5Cmathbb%7BR%7D%5Em) 表示

(7.13) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D%5Cmathbf%7BH_y%7D%5E%7B-1%7D%28%5Cmathbf%7Bv%7D-%5Cmathbf%7BG%7D%5Cmathbf%7B%5Ctilde+x%7D%29)

于是导出了输入输出解耦的形式

(7.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C1%7D~~~~%26%3D%5Ctilde+x_%7Bi%2C2%7D%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2Cr_i-1%7D%26%3D%5Ctilde+x_%7Bi%2Cr_i%7D%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2Cr_i%7D~~~~%26%3Dv_%7Bi%7D%2C%5Cqquad+i%3D1%2C...%2Cm+%5C%5C+%5Cboldsymbol%7B%5Cdot%5Ceta%7D~~~~~~~%26%3D%5Cmathbf%7B%5Cbar+M_y%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D%2B%5Cmathbf%7B%5Cbar+Nv%7D++%5Cend%7Balign%7D)

其中有(7.15) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D++%5Cmathbf%7B%5Cbar+M%7D~%26%3D%5B%5Cmathbf%7B%5Cbar+M_%7By%7D%7D~~%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5D+%3D%5Cmathbf%7BM%7D-%5Cmathbf%7BN%7D+%5Cmathbf%7BH_y%7D%5E%7B-1%7D%5Cmathbf%7BG%7D%2C%5Cqquad+%5Cmathbf%7B%5Cbar+N%7D%3D%5Cmathbf%7BN%7D+%5Cmathbf%7BH_y%7D%5E%7B-1%7D%5Cend%7Balign%7D)

对于每一条积分链的输出端， ![[公式]](https://www.zhihu.com/equation?tex=y_i%3D%5Ctilde+x_%7Bi%2C1%7D) 可以借助新的输入端 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D%3D%5Bv_1%2C...%2Cv_m%5D%5ET) 实现既定目标的控制。根据式(7.14)可知，新输入量会对系统的内动态产生影响，而新输入量也可以像之前能控标准型一样，任意配置系统期望的内动态，依据

(7.16) ![[公式]](https://www.zhihu.com/equation?tex=v_i%3D-p_%7Bi%2C0%7D%5Ctilde+x_%7Bi%2C1%7D-...-p_%7Bi%2Cr_i-1%7D%5Ctilde+x_%7Bi%2Cr_i%7D%2C%5Cquad++i%3D1%2C...%2Cm)

![img](https://pic1.zhimg.com/80/v2-4bdcabe62e227d958b36978505382448_hd.jpg)图7.1 解耦后的输入输出标准型

![[公式]](https://www.zhihu.com/equation?tex=p_%7Bi%2Cj%7D) 依然是目标特征多项式的系数

(7.17) ![[公式]](https://www.zhihu.com/equation?tex=p%5E%2A_i%28%5Clambda%29%3Dp_%7Bi%2C0%7D%2Bp_%7Bi%2C1%7D%5Clambda%2B...%2Bp_%7Bi%2Cr_i-1%7D%5Clambda%5E%7Br_i-1%7D%2B%5Clambda%5E%7Br_i%7D%3D%5Cprod_%7Bj%3D1%7D%5E%7Br_i%7D%28%5Clambda-%5Clambda%5E%2A_%7Bi%2Cj%7D%29%2C+~~i%3D1%2C...%2Cm)

然而，与原来单单只用特征值预给可以保证系统的稳定性不同的是，采用输入输出解耦形式时，内动态的稳定性是对整个系统稳定性有决定性的作用。其次，因为实际的输入变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D) 因为式(7.13)而让内动态状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Ceta%7D) 实实在在地出现。当内动态是不稳定的时候，也会导致 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bv%7D) 过高的调控幅值。

如果想要获取内动态的实际稳定性，我们不应该让输入状态以及其他非内动态的状态变量影响它，也就是让内动态变为自治系统，于是我们就需要考察所谓的**零动态**(Nulldynamik)，先让其他状态变量以及输入量全部置零

![[公式]](https://www.zhihu.com/equation?tex=y_i%5E%7B%28j%29%7D%3D%5Ctilde+x_%7Bi%2Cj%2B1%7D%3D0%2C~~j%3D0%2C1%2C...%2Cr_i-1%5Cqquad+y_i%5E%7B%28r_i%29%7D%3Dv_i%3D0%2Ci%3D1%2C...%2Cm)

于是由解耦形态直接获得零动态

(7.18) ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cdot%5Ceta%7D%3D%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D)

零动态是一种特殊的内动态，当所有输出量都保持零时，它表达了系统最后剩下的动态。只有当零动态是渐进稳定的，整个系统才能保持渐近稳定。

整个经过解耦的输入输出标准型，依然可以利用反馈律进行特征值的配置，利用Ackermann公式和式(7.14)，类似得到

> **定理7.2 输入输出解耦的状态反馈设计**
> 式(7.1)所示的MIMO线性系统有相对微分度向量 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D)，经过输入输出解耦后，得到形如式(7.9)的表达，并且零动态是渐进稳定的。那么会有反馈控制律以及Kalman增益矩阵
> (7.19) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%3D%5Cmathbf%7BH_y%7D%5E%7B-1%7D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7Bc_1%5ET%7D%28p_%7B1%2C0%7D%5Cmathbf%7BI%7D%2Bp_%7B1%2C1%7D%5Cmathbf%7BA%7D%2B...%2Bp_%7B1%2Cr_1-1%7D%5Cmathbf%7BA%7D%5E%7Br_1-1%7D%2B%5Cmathbf%7BA%7D%5E%7Br_1%7D%29%5C%5C+%5Cvdots%5C%5C%5Cmathbf%7Bc_m%5ET%7D%28p_%7Bm%2C0%7D%5Cmathbf%7BI%7D%2Bp_%7Bm%2C1%7D%5Cmathbf%7BA%7D%2B...%2Bp_%7Bm%2Cr_m-1%7D%5Cmathbf%7BA%7D%5E%7Br_m-1%7D%2B%5Cmathbf%7BA%7D%5E%7Br_m%7D%29+%5Cend%7Bbmatrix%7D)
> 使系统能够渐近稳定。其中耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH_y%7D) 来自(7.2)，而系数 ![[公式]](https://www.zhihu.com/equation?tex=p_%7Bi%2Cj%7D)来自特征多项式(7.17)。

解耦的输入输出标准型的Ackermann公式和原本普通的MIMO的标准型不一样，原本Ackermann公式使用变换向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bt%5ET%7D%5Cin%5Cmathbb%7BR%7D%5En) 以及耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH%7D%5Cin%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes+n%7D) ,而输入输出标准型则直接使用输出向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bc_i%5ET%7D%5Cin%5Cmathbb%7BR%7D%5E%7Bn%7D) 和新的耦合矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BH_y%7D%5Cin%5Cmathbb%7BR%7D%5E%7Bm%5Ctimes+m%7D) ，有相对微分度向量 ![[公式]](https://www.zhihu.com/equation?tex=deg%5Cleft%5C%7Br_1%2C...%2Cr_m+%5Cright%5C%7D)，且总的相对微分数 ![[公式]](https://www.zhihu.com/equation?tex=r%3D%5Csum_%7Bi%3D1%7D%5E%7Bm%7D%7Br%7D_i%3Cn)时，会留出 ![[公式]](https://www.zhihu.com/equation?tex=n-r) 阶的系统内动态，只有当系统内动态，或者零动态稳定时，系统才完全稳定。

反馈控制矩阵可以使得输入输出解耦的子系统稳定，整个经由反馈调整后的解耦子系统可如下表示

(7.20) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+%5Cdot%7B%5Ctilde+x%7D_%7Bi%2C1%7D%5C%5C%5Cvdots%5C%5C%5Cdot%7B%5Ctilde+x%7D_%7Bi%2Cr_i%7D%5Cend%7Bbmatrix%7D+%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+0%261%26%260%5C%5C%5Cvdots%26%26%5Cddots%5C%5C+0%260%26%261%5C%5C+-p_%7Bi%2C0%7D%26-p_%7Bi%2C1%7D%26%5Cdots%26-p_%7Bi%2Cr_i-1%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A_%7By%2Ci%7D%7D%7D%5Cbegin%7Bbmatrix%7D+%5Ctilde+x_%7Bi%2C1%7D%5C%5C%5Cvdots%5C%5C+%5Ctilde+x_%7Bi%2Cr_i%7D%5Cend%7Bbmatrix%7D%2C%5Cqquad+i%3D1%2C...%2Cm)

因充分解耦，可把每个矩阵块 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+A_%7By%2Ci%7D%7D) 组成总的解耦子系统矩阵是对角矩阵![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+A_y%7D%3Ddiag%28%5Cmathbf%7B%5Ctilde+A_%7By%2C1%7D%7D%2C...%2C%5Cmathbf%7B%5Ctilde+A_%7By%2Cm%7D%7D%29) 。并且考虑内动态系统，会有

(7.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Bbmatrix%7D+%5Cdot%7B%5Cmathbf%7B%5Ctilde+x%7D%7D_y%5C%5C%5Cdot+%7B%5Cboldsymbol%7B%5Ceta%7D%7D+%5Cend%7Bbmatrix%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+A_y%7D%26%5Cmathbf%7B0%7D%5C%5C%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D-%5Cmathbf%7B%5Cbar+NP%7D%26%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+A%7D_R%7D%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+x%7D_y%5C%5C%5Cboldsymbol%7B%5Ceta%7D+%5Cend%7Bbmatrix%7D)

且有(7.22) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BP%7D%3D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bp_1%5ET%7D%26%5Cmathbf%7B0%7D%26%5Cdots%26%5Cmathbf%7B0%7D%5C%5C%5Cmathbf%7B0%7D%26%5Cmathbf%7Bp_2%5ET%7D%26%5Cdots%26%5Cmathbf%7B0%7D%5C%5C%5Cvdots%26%26%5Cddots+%5C%5C%5Cmathbf%7B0%7D+%26%5Cmathbf%7B0%7D%26+%5Cdots%26%5Cmathbf%7Bp_m%5ET%7D%5Cend%7Bbmatrix%7D) ，它的每一个向量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bp_i%5ET%7D%3D%5Bp_%7Bi%2C0%7D~...~p_%7Bi%2Cr_i-1%7D%5D) 都对应了所属特征多项式的系数。因而可求最终合成闭环系统的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+A%7D_R) 的特征值

(7.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdet%28%7B%5Clambda%5Cmathbf%7BI-%5Ctilde+A%7D_R%7D%29%3D%5Cdet%28%7B%5Clambda%5Cmathbf%7BI_%7B%28m%29%7D-%5Ctilde+A_y%7D%7D%29%5Cdet%28%5Clambda%5Cmathbf%7BI_%7B%28n-r%29%7D-%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%29)

闭环系统的特征值正好分别是预给特征多项式和零动态多项式的乘积！也就是说，系统总的特征值是独立分开的，解耦部分用预给特征多项式保证稳定性，内动态用 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D) 的特征值保证稳定性。

## 7.4 系统零动态的含义

借助SISO系统的传递函数，我们会更容易看出系统的零动态行为。

(7.24) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7Bb_0%2Bb_1s%2B...%2Bb_%7Bn-r%7Ds%5E%7Bn-r%7D%7D%7Ba_0%2Ba_1s%2B...%2Ba_%7Bn-1%7Ds%5E%7Bn-1%7D%2Bs%5En%7D)

显然，上面这个分子分母互质的传递函数的微分度是 ![[公式]](https://www.zhihu.com/equation?tex=r) ，它的能控标准型为

(7.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cbegin%7Bbmatrix%7D0%261%26%260%5C%5C+%5Cvdots%26%26%5Cddots%5C%5C+0%260%26%261%5C%5C+-a_0%26-a_1%26%5Cdots%26-a_%7Bn-1%7D+%5Cend%7Bbmatrix%7D%5Cmathbf%7Bx%7D%2B%5Cbegin%7Bbmatrix%7D0%5C%5C%5Cvdots%5C%5C0%5C%5C1%5Cend%7Bbmatrix%7Du%5C%5Cy%26%3D%5Bb_0~~~b_1~~~...~~~b_%7Bn-r%7D~~~0~~~...~~0%5D~%5Cmathbf%7Bx%7D+%5Cend%7Balign%7D)

这个形式也是对传递函数的最小实现。现在把它变成解耦的输入输出标准型，需要借助

(7.26) ![[公式]](https://www.zhihu.com/equation?tex=%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7B%5Ctilde+x%7D_y%5C%5C%5Cboldsymbol%7B%5Ceta%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+x%7D%7D+%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7BT%7D_y%5C%5C%5Cmathbf%7BT%7D_%7B%5Cboldsymbol%7B%5Ceta%7D%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BT%7D%7D%5Cmathbf%7Bx%7D)

其中有 ![[公式]](https://www.zhihu.com/equation?tex=%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D%5Ctilde+x_1%5C%5C%5Cvdots%5C%5C%5Ctilde+x_r%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Ctilde+x_y%7D%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Cmathbf%7Bc%5ET%7D%5C%5C%5Cmathbf%7Bc%5ETA%7D%5C%5C%5Cvdots%5C%5C%5Cmathbf%7Bc%5ET%7D%5Cmathbf%7BA%7D%5E%7Br-1%7D+%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BT%7D_y%7D%5Cmathbf%7Bx%7D) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D+%5Ceta_1%5C%5C%5Cvdots%5C%5C%5Ceta_%7Bn-r%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cboldsymbol%7B%5Ceta%7D+%7D%3D%5Cbegin%7Bbmatrix%7Dx_1%5C%5C%5Cvdots%5C%5Cx_%7Bn-r%7D%5Cend%7Bbmatrix%7D%3D%5Cmathbf%7BT_%7B%5Cboldsymbol%7B%5Ceta%7D+%7Dx%7D)

所以解耦的输入输出标准型为

(7.27) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot%7B%5Ctilde+x%7D_%7B1%7D~~~%26%3D%5Ctilde+x_%7B2%7D%5C%5C+%26~~%5Cvdots%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Br-1%7D%26%3D%5Ctilde+x_%7Br%7D%5C%5C+%5Cdot%7B%5Ctilde+x%7D_%7Br%7D~~~~%26%3D%5Cmathbf%7Bg_%7By%7D%5ET%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cmathbf%7Bg_%7B%5Ceta%7D%5ET%7D%5Cboldsymbol%7B%5Ceta%7D%2BH_%7By%7Du%5C%5C%5Cboldsymbol%7B%5Cdot%5Ceta%7D~~~~~%26%3D%5Cmathbf%7BM_y%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cmathbf%7BM_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D+%5Cend%7Balign%7D)

它的内动态的细节有

(7.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cdot+%5Ceta_1~~~~~~~%26%3D%5Cdot+x_1~~~~~~~%3Dx_2~~~~~~~~%3D%5Ceta_2%5C%5C+%26%5Cvdots%5C%5C+%5Cdot+%5Ceta_%7Bn-r-1%7D%26%3D%5Cdot+x_%7Bn-r-1%7D%3Dx_%7Bn-r%7D~~~~%3D%5Ceta_%7Bn-r%7D%5C%5C+%5Cdot+%5Ceta_%7Bn-r%7D~~~%26%3D%5Cdot+x_%7Bn-r%7D~~~~%3Dx_%7Bn-r%2B1%7D%3D-%5Cfrac%7Bb_0%7D%7Bb_%7Bn-r%7D%7D%5Ceta_1-...-%5Cfrac%7Bb_%7Bn-r-1%7D%7D%7Bb_%7Bn-r%7D%7D%5Ceta_%7Bn-r%7D%2B%5Cfrac%7B1%7D%7Bb_%7Bn-r%7D%7D%5Ctilde+x_1%5Cend%7Balign%7D)

因此内动态的状态方程为

(7.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cdot%5Ceta%7D%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%260%26%5Cdots%260%5C%5C+%5Cvdots%26%5Cvdots%26%260%5C%5C+0%260%26%5Cdots%260%5C%5C+%5Cfrac%7B1%7D%7Bb_%7Bn-r%7D%7D%260%26%5Cdots%260%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Cbar+M_y%7D%7D%5Cmathbf%7B%5Ctilde+x%7D_y%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%261%26%260%5C%5C+%5Cvdots%26%26%5Cddots%5C%5C0%260%26%261%5C%5C+-%5Cfrac%7Bb_0%7D%7Bb_%7Bn-r%7D%7D%26-%5Cfrac%7Bb_1%7D%7Bb_%7Bn-r%7D%7D%26...%26-%5Cfrac%7Bb_%7Bn-r-1%7D%7D%7Bb_%7Bn-r%7D%7D%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D)

令 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Ctilde+x_y%7D%3D%5Cmathbf%7B0%7D) ，于是有零动态 ![[公式]](https://www.zhihu.com/equation?tex=%5Cboldsymbol%7B%5Cdot%5Ceta%7D%3D%5Cmathbf%7B%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%5Cboldsymbol%7B%5Ceta%7D) ，求其特征值

(7.30) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdet%28%5Clambda%5Cmathbf%7BI-%5Cbar+M_%7B%5Cboldsymbol%7B%5Ceta%7D%7D%7D%29%3D-%5Cfrac%7B1%7D%7Bb_%7Bn-r%7D%7D%28b_0%2Bb_1%5Clambda%2B...%2Bb_%7Bn-r-1%7D%5Clambda%5E%7Bn-r-1%7D%2B%5Clambda%5E%7Bn-r%7D%29)

所以零动态的特征值对应了的传递函数零点！所以只要零动态稳定，其所对应的传递函数的零点就会落在左半平面。当系统是非最小相位的时候，会有一个或者多个传递函数的零点在右半平面，也就是说内动态是不稳定的。所以一个状态反馈控制器在解耦的输入输出标准型下设计的时候，必须要求系统是最小相位的，这样才可以稳定。

这一章我们深入探讨了考虑了系统输出之后应当使输入输出解耦的状态反馈控制器的设计方案，还引入了解耦后出现的系统内动态的概念。下一章要初步讨论最优控制。

# (八)最优控制——LQR控制器

上一篇我们谈及了在MIMO系统为了解决多个输入和多个输出最终耦合的问题，使用了输入输出解耦的控制器设计方法。这一章我们要简略探讨一下线性系统里面的最优控制。

到目前为止考察的状态反馈控制器都是通过预设特征值的方式，来使系统稳定，而在MIMO系统里，预设特征值还会有更多的自由发挥空间。通过特征值或是极点的预置，可以让反馈增益很明确地算出来，然后再让闭环系统实现期望的动态。

然而实际设计时，会有很多实际技术条件限制，因为对特征值的配置实际上对单个状态变量或是输入控制量的反馈控制行为没有直接的影响。为了平衡各种限制以及设计要求，我们需要另寻设计准则，线性系统最优控制就是这样一个考虑了控制量大小的设计思路。

最优控制(Optimale Regelung)引入了代价函数(Kostenfuntional)的概念

(8.1) ![[公式]](https://www.zhihu.com/equation?tex=J%28%5Cmathbf%7Bu%7D%2C%5Cmathbf%7Bx%7D_0%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%28T%29%5Cmathbf%7BSx%7D%28T%29%2B%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7Bx%5ET%7D%28t%29%5Cmathbf%7BQx%7D%28t%29%2B%5Cmathbf%7Bu%5ET%7D%28t%29%5Cmathbf%7BRu%7D%28t%29dt)

代价函数实现在区间 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5B0%2CT%5D) ，自变量来自系统状态方程

(8.2) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7BAx%2BBu%7D%2C%5Cquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0)

有半正定的对称方阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes+n%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes+n%7D) ，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bm%5Ctimes+m%7D) 是正定的对称矩阵。半正定即，矩阵所有特征值大于等于零，正定则矩阵所有特征值大于零。

![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%28t%29%5Cmathbf%7BQx%7D%28t%29) 这一项评估了状态变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%28t%29) 时间上历程，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bu%5ET%7D%28t%29%5Cmathbf%7BRu%7D%28t%29) 则是输入控制变量的，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%28T%29%5Cmathbf%7BSx%7D%28T%29) 则是评估了终态的状态变量。 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bu%5ET%7D%28t%29%5Cmathbf%7BRu%7D%28t%29) 经常被描述成能量部分，而因为平方形式的代价函数和线性的系统动态，这类最优控制问题常常被称为"LQR"问题 (Linear-Quadratic-Regulator)。

其实我们想要寻找的是最优的控制输入过程 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29) ，能使代价函数最小，即

(8.3) ![[公式]](https://www.zhihu.com/equation?tex=J%28%5Cmathbf%7Bu%7D%5E%2A%2C%5Cmathbf%7Bx%7D_0%29%3D%5Cmin_%7B%5Cmathbf%7Bu%7D%7DJ%28%5Cmathbf%7Bu%7D%2C%5Cmathbf%7Bx%7D_0%29)

从而最优问题即系统从初值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0) 出发，在最优轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29%2C%5Cmathbf%7Bx%7D%5E%2A%28t%29) 下尽可能接近原点。权重矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D%2C%5Cmathbf%7BQ%7D%2C%5Cmathbf%7BR%7D) 确定了系统输入输出行为。

最优问题的解即LQR问题的线性反馈控制律，常常被称为LQR控制器，抑或是Riccati控制器。想要求解LQR问题需要引入Bellmann的动态规划。

## 8.1 动态规划

动态规划的基本思想是最优原则。为了更好理解它，我们需要最小化从非线性的代价函数出发

(8.4) ![[公式]](https://www.zhihu.com/equation?tex=J%28%5Cmathbf%7Bu%7D%2C%5Cmathbf%7Bx%7D_0%29%3D%5Cvarphi%28%5Cmathbf%7Bx%7D%28T%29%29%2B%5Cint_%7B0%7D%5E%7BT%7DI%28%5Cmathbf%7Bx%7D%28t%29%2C%5Cmathbf%7Bu%7D%28t%29%2Ct%29dt)

其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cvarphi%3A%5Cmathbb%7BR%7D%5En%5Crightarrow+%5Cmathbb%7BR%7D_0%5E%2B) ， ![[公式]](https://www.zhihu.com/equation?tex=I%3A%5Cmathbb%7BR%7D%5En%5Ctimes%5Cmathbb%7BR%7D%5Em%5Ctimes+%5Cmathbb%7BR%7D_0%5E%2B%5Crightarrow+%5Cmathbb%7BR%7D_0%5E%2B) ，自变量来自非线性系统动态

(8.5) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cdot+x%7D%3D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%2C%5Cquad+%5Cmathbf%7Bx%7D%280%29%3D%5Cmathbf%7Bx%7D_0)

> 定理8.1 最优原则
> 一个最优任务的解具有这样的特征，它的初值的每个点的是最优解，从这一点开始之后所有的解也是任务的最优解。

最优原则可以用在上面的非线性系统的最优问题求解，只要使用传递成本(cost-to-go)

(8.6) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%28t%29%2Ct%29%3D%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7B+%5Cvarphi%28%5Cmathbf%7Bx%7D%28T%29%29%2B%5Cint_%7Bt%7D%5E%7BT%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau+%5Cright%5C%7D)

当最优的状态变量轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5E%2A%28t%29) 已知后，传递成本就是最优传递成本，对应的最优控制就是 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29) 剩下的部分。在区间 ![[公式]](https://www.zhihu.com/equation?tex=t%5E%7B%27%7D%5Cin%5Bt%2CT%5D) 都能写出传递成本的最小化形式

(8.7) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%28t%29%2Ct%29%3D%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7B+%5Cint_%7Bt%7D%5E%7Bt%5E%7B%27%7D%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau+%2B%5Cint_%7Bt%5E%7B%27%7D%7D%5E%7BT%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau+%2B%5Cvarphi%28%5Cmathbf%7Bx%7D%28T%29%29%5Cright%5C%7D)

因为最优原则，最优轨迹的终端仍然是最优的，所以上式可以写成

(8.8) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%28t%29%2Ct%29%3D%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7B+%5Cint_%7Bt%7D%5E%7Bt%5E%7B%27%7D%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau+%2BV%28%5Cmathbf%7Bx%7D%28t%5E%7B%27%7D%29%2Ct%5E%7B%27%7D%29%5Cright%5C%7D)

如果我们的轨迹已经是最优，那可以简写为 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%3D%5Cmathbf%7Bx%7D%28t%29%3D%5Cmathbf%7Bx%7D%5E%2A%28t%29) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5E%7B%27%7D%3D%5Cmathbf%7Bx%7D%28t%5E%7B%27%7D%29%3D%5Cmathbf%7Bx%7D%5E%2A%28t%5E%7B%27%7D%29) ,再假设传递成本的函数是连续可微，那么对 ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%5E%7B%27%7D%2Ct%5E%7B%27%7D%29) 使用泰勒展开做一阶近似

(8.9) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%5E%7B%27%7D%2Ct%5E%7B%27%7D%29%3DV%28%5Cmathbf%7Bx%7D%2Ct%29%2B%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%5Cmathbf%7B%5Cdot+x%7D%5CDelta+t%2B%5Cfrac%7B%5Cpartial+V%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+t%7D%5CDelta+t%2B%5Cmathcal%7BO%7D%28%5CDelta+t%5E2%29)

再令对 ![[公式]](https://www.zhihu.com/equation?tex=I%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29) 的积分也做一阶近似

(8.10) ![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7Bt%7D%5E%7Bt%5E%7B%27%7D%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau%3DI%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%5CDelta+t%2B%5Cmathcal%7BO%7D%28%5CDelta+t%5E2%29)

将式(8.9)(8.10)都代入(8.8)可得

(8.11) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%2Ct%29%3D%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7BI%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%5CDelta+t%2BV%28%5Cmathbf%7Bx%7D%2Ct%29%2B%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%5Cmathbf%7B%5Cdot+x%7D%5CDelta+t%2B%5Cfrac%7B%5Cpartial+V%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+t%7D%5CDelta+t%2B%5Cmathcal%7BO%7D%28%5CDelta+t%5E2%29%5Cright%5C%7D)

上述形式还可以简化，考虑到最初输入控制变量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D) 和 ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%2Ct%29) 无关，且已经为最小的表达，可以提出大括号并且约去，再两边同除以 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta+t%28%5CDelta+t%3E0%29) ，于是又可以消去高阶项

(8.12) ![[公式]](https://www.zhihu.com/equation?tex=0%3D%5Cfrac%7B%5Cpartial+V%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+t%7D%2B%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7BI%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%2B%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%5Cright%5C%7D)

这个等式包含非线性偏导数，为了确定等式，还要用到终点的条件

(8.13) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%2CT%29%3D%5Cvarphi%28%5Cmathbf%7Bx%7D%29)

确定了以后就可以得出有名的Hamilton-Jacobi-Bellman等式(HJB方程)。

> **定理8.2 Hamilton-Jacobi-Bellman定理**
> 如果 ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%2Ct%29) 是带有式(8.13)的条件的连续可微的HJB方程的解，此外有最优输入轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29) ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5B0%2CT%5D) 也是连续函数，那么最优问题
> (8.14) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmin_%7B%5Cmathbf%7Bu%5Cin%5Cmathbb%7BR%7D%7D%5Em%7D%5CTheta%3D%5Cmin_%7B%5Cmathbf%7Bu%5Cin%5Cmathbb%7BR%7D%7D%5Em%7D%5Cleft%5C%7BI%28%5Cmathbf%7Bx%7D%5E%2A%28t%29%2C%5Cmathbf%7Bu%7D%2Ct%29%2B%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%5E%2A%28t%29%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%5E%2A%28t%29%2C%5Cmathbf%7Bu%7D%2Ct%29%5Cright%5C%7D)
> 对任意区间 ![[公式]](https://www.zhihu.com/equation?tex=t%5Cin%5B0%2CT%5D) 内的 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D%5E%2A%28t%29)都是HJB方程的唯一解。并且 ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%5E%2A%28t%29%2Ct%29) 是最优的传递成本函数，而控制轨迹 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29)也是最优的。

然而令人遗憾的是，只有极少情况能直接算出HJB方程的解析解。如果能求出解，那就可以由传递成本函数导出最优控制律 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A%28t%29%3D%5Cmathbf%7Bk%7D%28%5Cmathbf%7Bx%7D%5E%2A%28t%29%2Ct%29) 。另一种选择是用数值解近似求解(次优解)，不过不在这里深入。

## 8.2 Riccati微分方程

尽管对于HJB方程在一般的非线性问题的求解很难，但是这却是一个非常曲取巧的求解LQR问题的方案。如果把HJB方程运用到线性系统的话，即 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bf%7D%28%5Cmathbf%7Bx%7D%2C%5Cmathbf%7Bu%7D%2Ct%29%3D%5Cmathbf%7BAx%2BBu%7D) ，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cint_%7B0%7D%5E%7BT%7DI%28%5Cmathbf%7Bx%7D%28%5Ctau%29%2C%5Cmathbf%7Bu%7D%28%5Ctau%29%2C%5Ctau%29d%5Ctau%3D%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7Bx%5ET%7D%28t%29%5Cmathbf%7BQx%7D%28t%29%2B%5Cmathbf%7Bu%5ET%7D%28t%29%5Cmathbf%7BRu%7D%28t%29dt) ，于是有

(8.15) ![[公式]](https://www.zhihu.com/equation?tex=0%3D%5Cfrac%7B%5Cpartial+V%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+t%7D%2B%5Cmin_%7B%5Cmathbf%7Bu%7D%7D%5Cleft%5C%7B%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D%2B%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bu%5ET%7D%5Cmathbf%7BRu%7D%2B%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%5Cleft%28+%5Cmathbf%7BAx%2BBu%7D%5Cright%29%5Cright%5C%7D)

记 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+V%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+t%7D%3DV_t) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+V%5E%7BT%7D%28%5Cmathbf%7Bx%7D%2Ct%29%7D%7B%5Cpartial+%5Cmathbf%7Bx%7D%7D%3D+%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D) 。因为求自变量最小 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D) 的最优项是关于 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D) 连续可微的，那么对后一项求极值点，可得最优输入控制量 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%5E%2A)

(8.16) ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B%5Cpartial+%5CTheta%7D%7B%5Cpartial+%5Cmathbf%7Bu%7D%7D%3D%5Cmathbf%7BRu%7D%2B%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D%3D%5Cmathbf%7B0%7D%5CRightarrow+%5Cmathbf%7Bu%7D%5E%2A%3D-%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D)

略去带自变量的表达，这条式子所有矩阵最后都是标量式，所以

(8.17) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+0%26%3DV_t%2B%5Cfrac%7B1%7D%7B2%7D%5Cleft%28+%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D%2B%5Cmathbf%7B%28u%5E%2A%29%5ET%7D%5Cmathbf%7BRu%5E%2A%7D%2B2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D+%5Cmathbf%7BAx%7D%2B2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D+%5Cmathbf%7BBu%5E%2A%7D+%5Cright%29%5C%5C%26%3DV_t%2B%5Cfrac%7B1%7D%7B2%7D%5Cleft%28+%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D-%5Cmathbf%7B%28u%5E%2A%29%5ET%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D%2B2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D%5Cmathbf%7BBu%5E%2A%7D%2B2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D+%5Cmathbf%7BAx%7D+%5Cright%29%5C%5C%26%3DV_t%2B%5Cfrac%7B1%7D%7B2%7D%5Cleft%28+%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D-%5Cmathbf%7BV_%7B%5Cmathbf%7Bx%7D%7D%5ETB%7D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%7D+%2B2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D%5Cmathbf%7BAx%7D+%5Cright%29%5C%5C++%5Cend%7Balign%7D)

由于偏导数 ![[公式]](https://www.zhihu.com/equation?tex=V_t) ，![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D) 仍然未知，不妨设传递成本函数

(8.18) ![[公式]](https://www.zhihu.com/equation?tex=V%28%5Cmathbf%7Bx%7D%2Ct%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BP%7D%28t%29%5Cmathbf%7Bx%7D)

所以只要求出未知的时变对称矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BP%7D%28t%29) 就能求出传递成本函数。而偏导数可表示为

(8.19) ![[公式]](https://www.zhihu.com/equation?tex=V_t%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cdot+%7B%5Cmathbf%7BP%7D%7D%28t%29%5Cmathbf%7Bx%7D)

(8.20) ![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D%3D%5Cmathbf%7BP%7D%28t%29%5Cmathbf%7Bx%7D)

由于标量转置仍为本身 ![[公式]](https://www.zhihu.com/equation?tex=2%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D+%5Cmathbf%7BAx%7D%3D%5Cmathbf%7BV_%5Cmathbf%7Bx%7D%5ET%7D+%5Cmathbf%7BAx%7D%2B%5Cmathbf%7Bx%5ETA%5ET%7D%5Cmathbf%7BV%7D+_%5Cmathbf%7Bx%7D) 全部代入(8.16)

(8.21) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+0%26%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cdot+%7B%5Cmathbf%7BP%7D%7D%5Cmathbf%7Bx%7D%2B%5Cfrac%7B1%7D%7B2%7D%5Cleft%28+%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D-%5Cmathbf%7Bx%5ETPB%7D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BP%7D%5Cmathbf%7Bx%7D+%2B%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BPAx%7D+%2B%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BA%5ETPx%7D%5Cright%29%5C%5C+%26%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cleft%28+%5Cdot+%7B%5Cmathbf%7BP%7D%7D%2B%5Cmathbf%7BQ%7D-%5Cmathbf%7BPB%7D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BP%7D+%2B%5Cmathbf%7BPA%7D+%2B%5Cmathbf%7BA%5ETP%7D%5Cright%29%5Cmathbf%7Bx%7D+%5Cend%7Balign%7D)

而在终点条件(8.13)也要满足，所以

(8.22) ![[公式]](https://www.zhihu.com/equation?tex=0%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%5Cleft%28+%5Cmathbf%7BP%7D%28T%29-%5Cmathbf%7BS%7D+%5Cright%29%5Cmathbf%7Bx%7D)

综上所述，HJB方程对任意状态 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bx%7D) 都应该成立，所以消去多余项得到所谓的**Riccati矩阵微分方程**

(8.23) ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%7B%5Cmathbf%7BP%7D%7D%3D-%5Cmathbf%7BPA%7D+-%5Cmathbf%7BA%5ETP%7D%2B%5Cmathbf%7BPB%7D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BP%7D+-%5Cmathbf%7BQ%7D)

(8.24) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BP%7D%28T%29%3D%5Cmathbf%7BS%7D)

比较最有反馈控制律 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7Bu%7D%3D-%5Cmathbf%7BK%7D%28t%29%5Cmathbf%7Bx%7D%3D-%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BP%7D%28t%29+%5Cmathbf%7Bx%7D) ，可得时变增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%28t%29)

(8.25) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%28t%29%3D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7BP%7D%28t%29+)

总结，因为不存在初值，要求Riccati方程的解，比较方便的方法是从 ![[公式]](https://www.zhihu.com/equation?tex=t%3DT) 开始，倒着积分回去来求到 ![[公式]](https://www.zhihu.com/equation?tex=t%3D0) 的状态。即最优控制下的初值能满足代价函数为

(8.26) ![[公式]](https://www.zhihu.com/equation?tex=J%5E%2A%28%5Cmathbf%7Bx%7D_0%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%7D_0%5ET%5Cmathbf%7BP%7D%280%29%5Cmathbf%7Bx%7D_0)

所以，![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BK%7D%28t%29)必须在系统实施反馈控制以前就要先算出来。而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BP%7D%28t%29+) 是对称的半正定矩阵，所以 ![[公式]](https://www.zhihu.com/equation?tex=n%5E2) 的系统阶数也只对应了 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7Bn%28n%2B1%29%7D%7B2%7D) 的微分方程组(其余的都耦合了)。

如果是时变的系统矩阵， ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BA%7D%28t%29+) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BB%7D%28t%29+) 以及权重矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%28t%29+) , ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D%28t%29+) 不影响推导结论，只需要对应改成时变项就行。

## 8.3 Riccati代数方程

考虑一种特殊情况，当代价函数会在无限的时间区间内来考察时，那么终值权重部分 ![[公式]](https://www.zhihu.com/equation?tex=%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%5ET%7D%28T%29%5Cmathbf%7BSx%7D%28T%29) 就失去了意义。总归当时间 ![[公式]](https://www.zhihu.com/equation?tex=t%5Crightarrow+%5Cinfty) 时，状态变量的范数 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%7C+%5Cleft%7C+%5Cmathbf%7Bx%7D%28t%29+%5Cright%7C+%5Cright%7C%5Crightarrow0) ，只要状态方程是收敛的。那么我们可以让 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BS%7D%3D%5Cmathbf%7B0%7D) 并且假设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bn%5Ctimes+n%7D) ，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D%5Cin+%5Cmathbb%7BR%7D%5E%7Bm%5Ctimes+m%7D) 是正定的对称矩阵，整个系统是完全能控的，而矩阵对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cmathbf%7BA%7D+%2C%5Cmathbf%7B%5Cbar+C%7D%5Cright%5D) 是完全能观的(其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+C%7D) 是Cholesky分解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+C%5ET%7D%5Cmathbf%7B%5Cbar+C%7D%3D%5Cmathbf%7BQ%7D) 得到的)。

系统的为了满足 ![[公式]](https://www.zhihu.com/equation?tex=+%5Cmathbf%7Bx%5ET%7D%5Cmathbf%7BQx%7D%3D%5Cmathbf%7B%5Cbar+y%5ET%7D%28t%29%5Cmathbf%7B%5Cbar+y%7D%28t%29) ，出现了“虚构”的输出方程

(8.27) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+y%7D%28t%29%3D%5Cmathbf%7B%5Cbar+Cx%7D%28t%29)

若这个虚构的输出是完全能观的时候，那么代价函数就会明确地和系统特征值有关。此外又有系统完全能控的假设，那总的来说就存在一个使系统能稳定的状态反馈机制。

基于以上繁复的假设，式(8.23)的Riccati方程的解在反向时间内就会朝着稳态的正定矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D+) 收敛。而矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D+) 本身是在开始反向积分以后和终值 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+P%7D%28T%29+) 无关的。所以就可以近似从任意给定的半正定的终值点 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+P%7D%28T%29+) 出发来确定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D+)。比如，从 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+P%7D%28T%29+%3D%5Cmathbf%7B+0%7D) 开始反向积分，直到时间上的变动 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%7B%5Cmathbf%7BP%7D%7D%28t%29) 收敛到允许误差以内。

一种比较巧妙的确定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D+) 的方法，即使用假定 ![[公式]](https://www.zhihu.com/equation?tex=%5Cdot+%7B%5Cmathbf%7BP%7D%7D%28t%29%3D%5Cmathbf%7B0%7D) 得到的所谓的Riccati代数方程

(8.28) ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+PA%7D%2B%5Cmathbf%7BA%5ET%5Cbar+P%7D-%5Cmathbf%7B%5Cbar+PB%7D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7B%5Cbar+P%7D+%2B%5Cmathbf%7BQ%7D%3D%5Cmathbf%7B0%7D)

因为方程是非线性的，还可能存在多种解。不过基于之前所有必要的假设以后，这个方程只会得到唯一确定的解 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D+)！

由于最优原则，现在只有时不变的反馈控制律了，而这就是系统在 ![[公式]](https://www.zhihu.com/equation?tex=t%5Crightarrow%5Cinfty) 的最优解

(8.29) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5Cmathbf%7Bu%7D%3D-%5Cmathbf%7B%5Cbar+K%7D%5Cmathbf%7Bx%7D%2C%5Cqquad+%5Cmathbf%7B%5Cbar+K%7D%3D%5Cmathbf%7BR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7B%5Cbar+P%7D%5Cquad%28m%3E1%29%5C%5C+u%3D-%5Cmathbf%7B+k%5ET%7D%5Cmathbf%7Bx%7D%2C%5Cqquad+%5Cmathbf%7B+k%5ET%7D%3D%5Cfrac%7B1%7D%7BR%7D~%5Cmathbf%7Bb%5ET%7D%5Cmathbf%7B%5Cbar+P%7D%5Cquad%28m%3D1%29+%5Cend%7Balign%7D)

现在总结成下面的定理

> **定理8.3 线性时不变系统的LQR控制器**
> 给出能控的线性时不变系统，使之有最小的代价函数。
> (8.30) ![[公式]](https://www.zhihu.com/equation?tex=J%28%5Cmathbf%7Bu%7D%2C%5Cmathbf%7Bx%7D_0%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7Bx%5ET%7D%28t%29%5Cmathbf%7BQx%7D%28t%29%2B%5Cmathbf%7Bu%5ET%7D%28t%29%5Cmathbf%7BRu%7D%28t%29dt)
> 而假设 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%3D%5Cmathbf%7B%5Cbar+C%5ET%7D%5Cmathbf%7B%5Cbar+C%7D) 是半正定的，而 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D) 是正定的对称矩阵，整个系统是完全能控的，而矩阵对 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%5B+%5Cmathbf%7BA%7D+%2C%5Cmathbf%7B%5Cbar+C%7D%5Cright%5D) 是完全能观的。那么就有经过最优反馈控制律得到的最小初值
> (8.31) ![[公式]](https://www.zhihu.com/equation?tex=J%5E%2A%28%5Cmathbf%7Bx%7D_0%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cmathbf%7Bx%7D_0%5ET%5Cmathbf%7B%5Cbar+P%7D%5Cmathbf%7Bx%7D_0)
> 其中 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B%5Cbar+P%7D) 是Riccati代数方程的唯一正定解，并且矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cmathbf%7BA%7D-%5Cmathbf%7BBR%7D%5E%7B-1%7D%5Cmathbf%7BB%5ET%7D%5Cmathbf%7B%5Cbar+P%7D%5Cright%29) 的所有特征值具有负实部，这样形成的闭环动态才是渐进稳定的。

定理8.3里的最优控制器经常被称为Riccati控制器或者LQR控制器，而且在实践工作中常常用到。



**例8.1 倒立摆小车系统的最优控制**

考察之前出现的倒立摆小车系统，并令臂长 ![[公式]](https://www.zhihu.com/equation?tex=l%3D1m) , ![[公式]](https://www.zhihu.com/equation?tex=m%3DM%3D1kg) , ![[公式]](https://www.zhihu.com/equation?tex=g%3D9.81m%2Fs%5E2) 取线性化的系统，其状态变量为 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta+%5Cmathbf%7Bx%7D%3D%5Cleft%5B+%5CDelta%5Cphi%2C+%5CDelta%5Cdot+%5Cphi%2C%5CDelta+x_w%2C%5CDelta+%5Cdot+x_w%5Cright%5D%5ET) ,输出 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta+y%3D%5CDelta+x_w)

(8.32) ![[公式]](https://www.zhihu.com/equation?tex=%5Cbegin%7Balign%7D+%5CDelta%5Cmathbf%7B%5Cdot+x%7D%26%3D%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%261%260%260%5C%5C23.544%260%260%260%5C%5C+0%260%260%261%5C%5C-5.886%260%260%260%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7BA%7D%7D%5CDelta%5Cmathbf%7B+x%7D+%2B%5Cunderbrace%7B%5Cbegin%7Bbmatrix%7D0%5C%5C-1.2%5C%5C0%5C%5C0.8%5Cend%7Bbmatrix%7D%7D_%7B%5Cmathbf%7Bb%7D%7D%5CDelta+u%5C%5C+%5CDelta+y%26%3D%5Cleft%5B+0~~0~~1~~0+%5Cright%5D%5CDelta%5Cmathbf%7B+x%7D+%5Cend%7Balign%7D)

直接调用MATHLAB指令：eig。求其特征值， ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%2F2%7D%3D0%2C%5Clambda_%7B3%2F4%7D%3D%5Cpm+4.85)

接下来开始LQR控制器设计。取权重矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%3Ddiag%2810%5E0%2C10%5E0%2C10%5E0%2C10%5E0%29%2C~~R%3D10%5E%7B-1%7D)

调用MATHLAB指令：lqr。算出反馈增益 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7B+k%5ET%7D%3D%5B-64.21~~15.01~-3.16~-6.22%5D)

所以新的动态矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cleft%28%5Cmathbf%7BA%7D-%5Cmathbf%7Bbk%5ET%7D%5Cright%29) 算出新的特征值 ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B1%7D%3D-7.37) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B2%7D%3D-3.34) ， ![[公式]](https://www.zhihu.com/equation?tex=%5Clambda_%7B3%2F4%7D%3D-1.16%5Cpm+j+0.41) 。新的系统动态已经渐进稳定了。然后再补充设计一个前置滤波器

![[公式]](https://www.zhihu.com/equation?tex=S%3D%5Cleft%28+%5Cmathbf%7Bc%5ET%7D%28%5Cmathbf%7Bbk%5ET%7D-%5Cmathbf%7BA%7D%29%5E%7B-1%7D%5Cmathbf%7Bb%7D+%5Cright%29%5E%7B-1%7D%3D-3.16) 。使得小车系统最后能够稳定在期望的位置 ![[公式]](https://www.zhihu.com/equation?tex=w) 。于是有总的控制律 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta+u%3D-%5Cmathbf%7B+k%5ET%7D%5CDelta%5Cmathbf%7Bx%7D%2BSw) 。

下图展示了从初值 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cmathbf%7Bx%7D%280%29%3D%5CDelta%5Cmathbf%7Bx%7D_0%3D%5Cmathbf%7B0%7D) 到目标位置 ![[公式]](https://www.zhihu.com/equation?tex=w%3D0.2) 的动态过程。

![img](https://pic4.zhimg.com/80/v2-691b51ea15b1f235f701056077fe742f_hd.jpg)图8.1 不同权重下的最优控制轨迹

由上图可知，不同权重下产生的轨迹都有不同，橙色虚线和绿色点划线对应的轨迹的权重矩阵中都有一行元素是未调整之前的1000倍。橙色虚线的权重使得角度 ![[公式]](https://www.zhihu.com/equation?tex=%5CDelta%5Cphi) 有了更小的振荡，但是接近稳态也更慢。绿色点划线虽然快速趋向稳态，但是稳态前出现了明显的反向行为，说明并不是最小相位系统。考察系统的传递函数

(8.33) ![[公式]](https://www.zhihu.com/equation?tex=G%28s%29%3D%5Cfrac%7B%5CDelta+Y_1%28s%29%7D%7B%5CDelta+U%28s%29%7D%3D%5Cfrac%7B0.8%28s%5E2-14.71%29%7D%7Bs%5E2%28s%5E2-23.54%29%7D)

它有两个零点 ![[公式]](https://www.zhihu.com/equation?tex=s_%7B0%2C1%2F2%7D%3D%5Cpm3.836) 。有正根，零点非最小相位。通过反馈控制得到新动态。

输入MATHLAB命令：tf和ss。得到闭环传递函数

(8.34) ![[公式]](https://www.zhihu.com/equation?tex=G_w%28s%29%3DS%5Cmathbf%7Bc%5ET%7D%28s%5Cmathbf%7BI%7D-%5Cmathbf%7BA%7D_R%29%5E%7B-1%7D%5Cmathbf%7Bb%7D+%3D%5Cfrac%7B-2.53%28s%5E2-14.71%29%7D%7Bs%5E4%2B13.03S%5E3%2B50.98s%5E2%2B73.28s%2B37.23%7D)

注意到，经过反馈控制后，系统的零点并没有变化。所以非最小相位的零点依旧导致了系统的反向振荡。这就是所谓的**不动零点**，它是不能由反馈控制改变的系统内动态。

## 8.4 预给特征值和LQR设计方法的比较

到目前为止，我们一共讨论过两种基本的系统动态性能配置的方法：直接预给特征值法以及LQR设计法。它们各有一些优缺点。

**特征值预给设计法**

- 闭环系统或者输入输出动态能被特征值的位置影响。
- 如果考虑输入控制变量幅值受限会十分棘手，没有直接方法保证输入变量行为不会超阈值。
- 在SISO系统时，特征值的给定都是唯一的。但在MIMO系统会有很多自由度，只要能保证能控指数分配后的简化能控矩阵可逆。
- 控制器设计方法需要解析解法，反馈控制增益都要精确给出。

**LQR设计法**

- 受控闭环系统的特征值不能直接给定。
- 权重矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BQ%7D%2C%5Cmathbf%7BR%7D) 的每一行元素(至少是对角形式)显然对闭环系统的行为有明显的影响。
- 在矩阵 ![[公式]](https://www.zhihu.com/equation?tex=%5Cmathbf%7BR%7D) 的元素能对单独的控制变量影响，比如减小输入变量幅值来保持低于输入阈值。
- LQR设计法不论是在SISO还是MIMO中都是唯一的解，不会有额外设计自由度。
- LQR是数值解法，因为Riccati方程一般只能数值求解。



# （九）故障诊断5——状态观测器和输出观测器

2019-02-19 10:46:06 [路漫求索_CUMT](https://me.csdn.net/jinpeng_cumt) 阅读数 1964 收藏 更多

分类专栏： [故障诊断与容错控制](https://blog.csdn.net/jinpeng_cumt/category_8606032.html) [故障诊断与容错控制](https://blog.csdn.net/jinpeng_cumt/category_9291601.html)

版权声明：本文为博主原创文章，遵循[ CC 4.0 BY-SA ](http://creativecommons.org/licenses/by-sa/4.0/)版权协议，转载请附上原文出处链接和本声明。本文链接：https://blog.csdn.net/jinpeng_cumt/article/details/87692579

## 1. 状态观测器分类

在现代控制理论中，控制系统的基本结构和经典控制理论一样，仍然是由受控对象和反馈控制器两部分构成的闭环系统。不过在经典理论中习惯于采用输出反馈，而在现代控制理论中则更多地采用状态反馈。由于状态反馈能提供更丰富的状态信息和可供选择的自由度，因而使系统容易获得更为优异的性能。

### 1.1 基于状态反馈的控制器设计

状态反馈是将系统的每一个状态变量乘以相应的反馈系数，然后反馈到输入端与参与输入相加形成控制律，作为受控系统的控制输入。图1是一个多输入—多输出系统状态反馈的基本结构。

​              ![img](https://img-blog.csdnimg.cn/20190219104112203.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppbnBlbmdfY3VtdA==,size_16,color_FFFFFF,t_70)

​                                       图1 多输入多输出系统状态反馈结构图

系统状态方程如下： 

​                                      ![\left\{\begin{matrix} \dot{x}=Ax+Bu\\ y = Cx+Du \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3DAx&plus;Bu%5C%5C%20y%20%3D%20Cx&plus;Du%20%5Cend%7Bmatrix%7D%5Cright.)                           （1）

式中![x\in R^{n}](https://private.codecogs.com/gif.latex?x%5Cin%20R%5E%7Bn%7D); ![u\in R^{r}](https://private.codecogs.com/gif.latex?u%5Cin%20R%5E%7Br%7D);![y\in R^{m}](https://private.codecogs.com/gif.latex?y%5Cin%20R%5E%7Bm%7D)；![A_{n\times n}](https://private.codecogs.com/gif.latex?A_%7Bn%5Ctimes%20n%7D)、![B_{n\times r}](https://private.codecogs.com/gif.latex?B_%7Bn%5Ctimes%20r%7D)、![C_{m\times n}](https://private.codecogs.com/gif.latex?C_%7Bm%5Ctimes%20n%7D)、![D_{m\times r}](https://private.codecogs.com/gif.latex?D_%7Bm%5Ctimes%20r%7D)。若![D=0](https://private.codecogs.com/gif.latex?D%3D0)，则受控系统简化为：

​                                     ![\left\{\begin{matrix} \dot{x}=Ax+Bu\\ y = Cx \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3DAx&plus;Bu%5C%5C%20y%20%3D%20Cx%20%5Cend%7Bmatrix%7D%5Cright.)                            （2）

简记为![\sum=(A,B,C)](https://private.codecogs.com/gif.latex?%5Csum%3D%28A%2CB%2CC%29)

状态线性反馈控制律![u](https://private.codecogs.com/gif.latex?u)为

​                                     ![u=Kx+v](https://private.codecogs.com/gif.latex?u%3DKx&plus;v)                                 （3）

其中，![v\rightarrow r\times 1](https://private.codecogs.com/gif.latex?v%5Crightarrow%20r%5Ctimes%201) 维参考输入，![K\rightarrow r\times n](https://private.codecogs.com/gif.latex?K%5Crightarrow%20r%5Ctimes%20n) 维状态反馈系数阵或状态反馈增益阵。对单输入系统，![K](https://private.codecogs.com/gif.latex?K)为![1\times n](https://private.codecogs.com/gif.latex?1%5Ctimes%20n)维行向量。

将（3）式代入（1）式整理可得状态反馈闭环系统的状态空间表达式如下：

​                                   ![\left\{\begin{matrix} \dot{x}=(A+BK)x+Bv\\ y = (C+DK)x+Dv \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3D%28A&plus;BK%29x&plus;Bv%5C%5C%20y%20%3D%20%28C&plus;DK%29x&plus;Dv%20%5Cend%7Bmatrix%7D%5Cright.)                       （4）

如![D=0](https://private.codecogs.com/gif.latex?D%3D0)，则

​                                   ![\left\{\begin{matrix} \dot{x}=(A+BK)x+Bv\\ y = Cx \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3D%28A&plus;BK%29x&plus;Bv%5C%5C%20y%20%3D%20Cx%20%5Cend%7Bmatrix%7D%5Cright.)                        （5）

简记为![\sum=(A+BK,B,C)](https://private.codecogs.com/gif.latex?%5Csum%3D%28A&plus;BK%2CB%2CC%29)

闭环系统的传递函数矩阵为

​                       ![W_{k}(s)=C[sI-(A+BK)]^{-1}B](https://private.codecogs.com/gif.latex?W_%7Bk%7D%28s%29%3DC%5BsI-%28A&plus;BK%29%5D%5E%7B-1%7DB)                     （6）

比较开环系统![\sum=(A,B,C)](https://private.codecogs.com/gif.latex?%5Csum%3D%28A%2CB%2CC%29)与闭环系统![\sum=(A+BK,B,C)](https://private.codecogs.com/gif.latex?%5Csum%3D%28A&plus;BK%2CB%2CC%29)可见，状态反馈阵![K](https://private.codecogs.com/gif.latex?K)的引入，并不增加系统的维数，但可通过![K](https://private.codecogs.com/gif.latex?K)的选择自由地改变闭环系统的特征值，从而使系统获得所要求的性能。

### 1.2 基于输出反馈的控制器设计

输出反馈是采用输出矢量![Y](https://private.codecogs.com/gif.latex?Y)构成线性反馈律。在经典控制理论中主要讨论这种反馈形式。图2示出多输入—多输出系统输出反馈的基本结构。

​                 ![img](https://img-blog.csdnimg.cn/20190219212209843.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppbnBlbmdfY3VtdA==,size_16,color_FFFFFF,t_70)     

​                                      图2 多输入多输出系统输出反馈结构图

系统状态方程如下： 

​                                      ![\left\{\begin{matrix} \dot{x}=Ax+Bu\\ y = Cx+Du \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3DAx&plus;Bu%5C%5C%20y%20%3D%20Cx&plus;Du%20%5Cend%7Bmatrix%7D%5Cright.)                             （7）

输出线性反馈控制律为

​                                   ![u=Hy+v](https://private.codecogs.com/gif.latex?u%3DHy&plus;v)                             （8）

式中，![H\rightarrow r\times m](https://private.codecogs.com/gif.latex?H%5Crightarrow%20r%5Ctimes%20m)维输出反馈增益阵。对单输出系统，![H](https://private.codecogs.com/gif.latex?H)为![r\times 1](https://private.codecogs.com/gif.latex?r%5Ctimes%201)维列向量。闭环系统状态空间表达式可由式（7）代入（8）得：

​                                  ![u=H(Cx + Du)+v](https://private.codecogs.com/gif.latex?u%3DH%28Cx%20&plus;%20Du%29&plus;v)                     （9）

整理得 ：

​                                 ![u=(I-HD)^{-1}(HCx+v)](https://private.codecogs.com/gif.latex?u%3D%28I-HD%29%5E%7B-1%7D%28HCx&plus;v%29)                 （10）

再把式（10）代入式（7）求得

​                       ![\left\{\begin{matrix} \dot{x}=[A+B(I-HD)^{-1}HC]x+B(I-HD)^{-1}v\\ y = [C+D(I-Hu)^{-1}HC]x+D(I-HD)^{-1}v \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3D%5BA&plus;B%28I-HD%29%5E%7B-1%7DHC%5Dx&plus;B%28I-HD%29%5E%7B-1%7Dv%5C%5C%20y%20%3D%20%5BC&plus;D%28I-Hu%29%5E%7B-1%7DHC%5Dx&plus;D%28I-HD%29%5E%7B-1%7Dv%20%5Cend%7Bmatrix%7D%5Cright.)           （11）

若![D=0](https://private.codecogs.com/gif.latex?D%3D0)，则

​                             ![\left\{\begin{matrix} \dot{x}=(A+BHC)x+Bv\\ y = Cx \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3D%28A&plus;BHC%29x&plus;Bv%5C%5C%20y%20%3D%20Cx%20%5Cend%7Bmatrix%7D%5Cright.)                             （12）

简记![\sum=(A+BHC,B,C)](https://private.codecogs.com/gif.latex?%5Csum%3D%28A&plus;BHC%2CB%2CC%29)。由式（12）可见，通过选择输出反馈增益阵![H](https://private.codecogs.com/gif.latex?H)也可以改变闭环系统的特征值，从而改变系统的控制特性。

输出反馈系统的传递函数矩阵为

​                         ![W_{H}(s)=C[sI-(A+BHC)]^{-1}B](https://private.codecogs.com/gif.latex?W_%7BH%7D%28s%29%3DC%5BsI-%28A&plus;BHC%29%5D%5E%7B-1%7DB)                  （13）

若受控系统的传递函数阵为

​                             ![W_{0}(s)=C[sI-A]^{-1}B](https://private.codecogs.com/gif.latex?W_%7B0%7D%28s%29%3DC%5BsI-A%5D%5E%7B-1%7DB)                        （14）

则![W_{H}(s)](https://private.codecogs.com/gif.latex?W_%7BH%7D%28s%29)和![W_{0}(s)](https://private.codecogs.com/gif.latex?W_%7B0%7D%28s%29)存在下列关系

​                         ![W_{H}(s)=W_{0}(s)[I-HW_{0}(s)]^{-1}](https://private.codecogs.com/gif.latex?W_%7BH%7D%28s%29%3DW_%7B0%7D%28s%29%5BI-HW_%7B0%7D%28s%29%5D%5E%7B-1%7D)                     （15）

或者

​                         ![W_{H}(s)=[I-W_{0}(s)H]^{-1}W_{0}(s)](https://private.codecogs.com/gif.latex?W_%7BH%7D%28s%29%3D%5BI-W_%7B0%7D%28s%29H%5D%5E%7B-1%7DW_%7B0%7D%28s%29)                     （16）

比较上述两种基本形式的反馈可以看出，输出反馈中的![HC](https://private.codecogs.com/gif.latex?HC)与状态反馈中的![K](https://private.codecogs.com/gif.latex?K)相当。但由于![m<n](https://private.codecogs.com/gif.latex?m%3Cn)，所以![H](https://private.codecogs.com/gif.latex?H)可供选择的自由度远比![K](https://private.codecogs.com/gif.latex?K)小，因而输出反馈只能相当于一部分状态反馈。只有当![C=I](https://private.codecogs.com/gif.latex?C%3DI)时，![HC=K](https://private.codecogs.com/gif.latex?HC%3DK)才能等同于全状态反馈。因此，在不增加补偿器的条件下，输出反馈的效果显然不如状态反馈系统好。但输出反馈在技术实现上的方便性则是其突出优点。

 

## 2. 基于观测器的控制器

系统模型

​                                  ![\left\{\begin{matrix} \dot{x}=Ax+Bu\\ y = Cx+Du \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3DAx&plus;Bu%5C%5C%20y%20%3D%20Cx&plus;Du%20%5Cend%7Bmatrix%7D%5Cright.)                            （17）

假定系统是能控、能观的。使得闭环系统极点为![\lambda _{1},\lambda _{2},\cdots,\lambda _{n}](https://private.codecogs.com/gif.latex?%5Clambda%20_%7B1%7D%2C%5Clambda%20_%7B2%7D%2C%5Ccdots%2C%5Clambda%20_%7Bn%7D)的状态反馈控制律是![u=-Kx](https://private.codecogs.com/gif.latex?u%3D-Kx)。若系统状态不能直接测量，可以利用龙伯格观测器来估计系统的状态。

​               ![\dot{\tilde{x}}=A\tilde{x}+Bu+L(y-C\tilde{x}) =(A-LC)\tilde{x}+Bu+Ly](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3DA%5Ctilde%7Bx%7D&plus;Bu&plus;L%28y-C%5Ctilde%7Bx%7D%29%20%3D%28A-LC%29%5Ctilde%7Bx%7D&plus;Bu&plus;Ly)          （18）

进而用![u=-K\tilde{x}](https://private.codecogs.com/gif.latex?u%3D-K%5Ctilde%7Bx%7D)来替代原来的控制。

将![u=-K\tilde{x}](https://private.codecogs.com/gif.latex?u%3D-K%5Ctilde%7Bx%7D)代入(18)式，可得利用状态估计值的反馈控制器如下：

​                ![\dot{\tilde{x}}=A\tilde{x}+Bu+L(y-C\tilde{x}) =(A-LC-BK)\tilde{x}+Ly](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3DA%5Ctilde%7Bx%7D&plus;Bu&plus;L%28y-C%5Ctilde%7Bx%7D%29%20%3D%28A-LC-BK%29%5Ctilde%7Bx%7D&plus;Ly)          （19）

基于观测器的输出反馈控制系统结构图3所示：

​               ![img](https://img-blog.csdnimg.cn/20190220213419777.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppbnBlbmdfY3VtdA==,size_16,color_FFFFFF,t_70)

​                        图3 基于观测器的输出反馈控制系统结构

由图3可知，系统增加了积分器，闭环系统是2n 阶的。

（1）若选择![\begin{bmatrix} x^{T} & \tilde{x}^{T} \end{bmatrix}^{T}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%20x%5E%7BT%7D%20%26%20%5Ctilde%7Bx%7D%5E%7BT%7D%20%5Cend%7Bbmatrix%7D%5E%7BT%7D)为闭环系统状态，则系统状态方程

​                       ![\dot{x}=Ax-Bu = Ax-BK\tilde{x}](https://private.codecogs.com/gif.latex?%5Cdot%7Bx%7D%3DAx-Bu%20%3D%20Ax-BK%5Ctilde%7Bx%7D)                             （20）

​                      ![\dot{\tilde{x}}=(A-LC-BK)\tilde{x}+LCx](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3D%28A-LC-BK%29%5Ctilde%7Bx%7D&plus;LCx)                            （21）

写成矩阵向量形式：

​                     ![\begin{bmatrix} \dot{x}\\ \dot{\tilde{x}} \end{bmatrix}=\begin{bmatrix} A &-BK \\ LC& A-LC-BK \end{bmatrix}\begin{bmatrix} x\\ \tilde{x} \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%20%5Cdot%7Bx%7D%5C%5C%20%5Cdot%7B%5Ctilde%7Bx%7D%7D%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20A%20%26-BK%20%5C%5C%20LC%26%20A-LC-BK%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20x%5C%5C%20%5Ctilde%7Bx%7D%20%5Cend%7Bbmatrix%7D)                          （22）

定义误差向量：![e(t)=x(t)-\tilde{x}(t)](https://private.codecogs.com/gif.latex?e%28t%29%3Dx%28t%29-%5Ctilde%7Bx%7D%28t%29)，则

​              ![\dot{e}(t)=\dot{x}(t)-\dot{\tilde{x}}(t) \\ =Ax-BK\tilde{x}-(A-LC-BK)\tilde{x}-LCx \\ = (A-LC)x(t)-(A-LC)\tilde{x}(t)=(A-LC)e(t)](https://private.codecogs.com/gif.latex?%5Cdot%7Be%7D%28t%29%3D%5Cdot%7Bx%7D%28t%29-%5Cdot%7B%5Ctilde%7Bx%7D%7D%28t%29%20%5C%5C%20%3DAx-BK%5Ctilde%7Bx%7D-%28A-LC-BK%29%5Ctilde%7Bx%7D-LCx%20%5C%5C%20%3D%20%28A-LC%29x%28t%29-%28A-LC%29%5Ctilde%7Bx%7D%28t%29%3D%28A-LC%29e%28t%29)                  （23）

其特征多项式为

​    ![det\left [ \lambda I-(A-LC) \right ]=det\left [ \lambda I-(A-LC)^{T} \right ]=det\left [ \lambda I-(A^{T}-C^{T}L^{T})\right ]](https://private.codecogs.com/gif.latex?det%5Cleft%20%5B%20%5Clambda%20I-%28A-LC%29%20%5Cright%20%5D%3Ddet%5Cleft%20%5B%20%5Clambda%20I-%28A-LC%29%5E%7BT%7D%20%5Cright%20%5D%3Ddet%5Cleft%20%5B%20%5Clambda%20I-%28A%5E%7BT%7D-C%5E%7BT%7DL%5E%7BT%7D%29%5Cright%20%5D)      （24）

（2）若选择![\begin{bmatrix} x^{T} & {e}^{T} \end{bmatrix}^{T}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%20x%5E%7BT%7D%20%26%20%7Be%7D%5E%7BT%7D%20%5Cend%7Bbmatrix%7D%5E%7BT%7D)为闭环系统状态，则系统状态方程

​                     ![\begin{bmatrix} \dot{x}\\ \dot{e} \end{bmatrix}=\begin{bmatrix} A-BK &BK \\ 0& A-LC \end{bmatrix}\begin{bmatrix} x\\e \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%20%5Cdot%7Bx%7D%5C%5C%20%5Cdot%7Be%7D%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20A-BK%20%26BK%20%5C%5C%200%26%20A-LC%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20x%5C%5Ce%20%5Cend%7Bbmatrix%7D)                            （25）

其特征多项式为

 ![det\left ( \begin{bmatrix} \lambda I-A+BK &-BK \\ 0& \lambda I-A+LC \end{bmatrix} \right )=det\left ( \lambda I-A+BK \right )det\left ( \lambda I-A+LC \right )](https://private.codecogs.com/gif.latex?det%5Cleft%20%28%20%5Cbegin%7Bbmatrix%7D%20%5Clambda%20I-A&plus;BK%20%26-BK%20%5C%5C%200%26%20%5Clambda%20I-A&plus;LC%20%5Cend%7Bbmatrix%7D%20%5Cright%20%29%3Ddet%5Cleft%20%28%20%5Clambda%20I-A&plus;BK%20%5Cright%20%29det%5Cleft%20%28%20%5Clambda%20I-A&plus;LC%20%5Cright%20%29)  （26）

**分离性原理** 闭环系统的极点是极点配置单独设计产生的极点和由观测器单独设计产生的极点两部分组成。

## 3. 设计实例

系统状态空间模型的系数矩阵：

​            ![A=\begin{bmatrix} 0 & 1\\ -1 & 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?A%3D%5Cbegin%7Bbmatrix%7D%200%20%26%201%5C%5C%20-1%20%26%200%20%5Cend%7Bbmatrix%7D)，  ![B=\begin{bmatrix} 1\\ 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?B%3D%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7D),   ![C=\begin{bmatrix} 1& 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?C%3D%5Cbegin%7Bbmatrix%7D%201%26%200%20%5Cend%7Bbmatrix%7D)

已知系统状态不能直接测量，试设计控制器，使得闭环系统渐近稳定。

### 控制器一：输出反馈控制器

​             输出反馈控制器：![u=-ky](https://private.codecogs.com/gif.latex?u%3D-ky)

​             系统闭环矩阵：

​                            ![\begin{bmatrix} 0 & 1\\ -1 & 0 \end{bmatrix}-\begin{bmatrix} 1\\ 0 \end{bmatrix}k\begin{bmatrix} 1 & 0 \end{bmatrix}=\begin{bmatrix} 0 &1-k \\ -1 &0 \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%200%20%26%201%5C%5C%20-1%20%26%200%20%5Cend%7Bbmatrix%7D-%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7Dk%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%200%20%261-k%20%5C%5C%20-1%20%260%20%5Cend%7Bbmatrix%7D)                      （27）

特征多项式：![\lambda ^{2}+1-k](https://private.codecogs.com/gif.latex?%5Clambda%20%5E%7B2%7D&plus;1-k)

结论：无论k取什么值，无法将两个闭环极点配置在左半开复平面。

### 控制器二：状态反馈控制器

​           第1步： 判断系统能控性和能观性

```
% 系统矩阵A = [0 1; -1,0];B = [1;0];C = [1 0]; % 判断系统是否完全能控E_con = ctrb(A,B);           % 求解能控性矩阵E_val_con = rank(E_con);     % 根据能控性矩阵是否满秩判断能控性 E_obs = obsv(A,C);           % 求解能观性矩阵E_val_obs = rank(E_obs);     % 根据能观性矩阵是否满秩判断能观性
```

根据上述结果可知，系统完全能控、能观。

第二步：设计状态反馈控制器![u=-\begin{bmatrix} k_{1} & k_{2} \end{bmatrix}y](https://private.codecogs.com/gif.latex?u%3D-%5Cbegin%7Bbmatrix%7D%20k_%7B1%7D%20%26%20k_%7B2%7D%20%5Cend%7Bbmatrix%7Dy)

闭环矩阵：

​               ![\begin{bmatrix} 0 & 1\\ -1 & 0 \end{bmatrix}-\begin{bmatrix} 1\\ 0 \end{bmatrix}\begin{bmatrix} k_{1} & k_{2} \end{bmatrix}=\begin{bmatrix} - k_{1}&1-k_{2} \\ -1 &0 \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%200%20%26%201%5C%5C%20-1%20%26%200%20%5Cend%7Bbmatrix%7D-%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20k_%7B1%7D%20%26%20k_%7B2%7D%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20-%20k_%7B1%7D%261-k_%7B2%7D%20%5C%5C%20-1%20%260%20%5Cend%7Bbmatrix%7D)                        （28）

特征多项式：![\lambda ^{2}+k_{1}\lambda+1-k_{2}](https://private.codecogs.com/gif.latex?%5Clambda%20%5E%7B2%7D&plus;k_%7B1%7D%5Clambda&plus;1-k_%7B2%7D)

结论：选取![K=\begin{bmatrix} k_{1} & k_{2} \end{bmatrix}=\begin{bmatrix} 1 & -1 \end{bmatrix}](https://private.codecogs.com/gif.latex?K%3D%5Cbegin%7Bbmatrix%7D%20k_%7B1%7D%20%26%20k_%7B2%7D%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%201%20%26%20-1%20%5Cend%7Bbmatrix%7D)，则闭环极点![-0.5\pm j1.32](https://private.codecogs.com/gif.latex?-0.5%5Cpm%20j1.32)。

### 控制器三：基于观测器的状态反馈控制器

控制器二是在系统状态可测的情况下求得的，如果系统状态不可测，则需要设计相应状态观测器。假设观测器的两个极点为均为-2，则根据极点配置方法，可得观测器增益矩阵![L=\begin{bmatrix} 4 & 3 \end{bmatrix}^{T}](https://private.codecogs.com/gif.latex?L%3D%5Cbegin%7Bbmatrix%7D%204%20%26%203%20%5Cend%7Bbmatrix%7D%5E%7BT%7D)，则观测器模型可写为：

​                     ![\dot{\tilde{x}}=\begin{bmatrix} -4 &1 \\ -4& 0 \end{bmatrix}\tilde{x}+\begin{bmatrix} 1\\ 0 \end{bmatrix}u+\begin{bmatrix} 4\\3 \end{bmatrix}y](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3D%5Cbegin%7Bbmatrix%7D%20-4%20%261%20%5C%5C%20-4%26%200%20%5Cend%7Bbmatrix%7D%5Ctilde%7Bx%7D&plus;%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7Du&plus;%5Cbegin%7Bbmatrix%7D%204%5C%5C3%20%5Cend%7Bbmatrix%7Dy)                           （29）

根据分离性原理，由以上分别得到的状态反馈和观测器增益矩阵可构造基于观测器的输出反馈控制器。

​                   ![\dot{\tilde{x}}=\begin{bmatrix} -5 &2 \\ -4& 3 \end{bmatrix}\tilde{x}+\begin{bmatrix} 4\\3 \end{bmatrix}y \\](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3D%5Cbegin%7Bbmatrix%7D%20-5%20%262%20%5C%5C%20-4%26%203%20%5Cend%7Bbmatrix%7D%5Ctilde%7Bx%7D&plus;%5Cbegin%7Bbmatrix%7D%204%5C%5C3%20%5Cend%7Bbmatrix%7Dy%20%5C%5C)                                    （30）

​                      ![u=-\begin{bmatrix} 1 & -1 \end{bmatrix}\tilde{x}](https://private.codecogs.com/gif.latex?u%3D-%5Cbegin%7Bbmatrix%7D%201%20%26%20-1%20%5Cend%7Bbmatrix%7D%5Ctilde%7Bx%7D)

系统的动态特性

​             ![\begin{bmatrix} \dot{x}\\ \dot{e} \end{bmatrix}=\begin{bmatrix} A-BK &BK \\ 0& A-LC \end{bmatrix}\begin{bmatrix} x\\e \end{bmatrix}=\begin{bmatrix} -1 & 2 & 1 &-1 \\ -1& 0 &0 &0 \\ 0 &0 &-4 &1 \\ 0& 0 & -4& 0 \end{bmatrix}\begin{bmatrix} x\\e \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bbmatrix%7D%20%5Cdot%7Bx%7D%5C%5C%20%5Cdot%7Be%7D%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20A-BK%20%26BK%20%5C%5C%200%26%20A-LC%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20x%5C%5Ce%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20-1%20%26%202%20%26%201%20%26-1%20%5C%5C%20-1%26%200%20%260%20%260%20%5C%5C%200%20%260%20%26-4%20%261%20%5C%5C%200%26%200%20%26%20-4%26%200%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20x%5C%5Ce%20%5Cend%7Bbmatrix%7D)         （31）

检验系统的稳定性，对象和误差的初始条件

​                        ![x(0)=\begin{bmatrix} 1\\ 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?x%280%29%3D%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7D)  ，![e(0)=\begin{bmatrix} 0.5\\ 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?e%280%29%3D%5Cbegin%7Bbmatrix%7D%200.5%5C%5C%200%20%5Cend%7Bbmatrix%7D)

系统曲线如下：





# （十）故障诊断4—龙伯格状态观测器设计

2019-02-15 18:16:32 [路漫求索_CUMT](https://me.csdn.net/jinpeng_cumt) 阅读数 2402 收藏 更多

分类专栏： [故障诊断与容错控制](https://blog.csdn.net/jinpeng_cumt/category_8606032.html) [故障诊断与容错控制](https://blog.csdn.net/jinpeng_cumt/category_9291601.html)

版权声明：本文为博主原创文章，遵循[ CC 4.0 BY-SA ](http://creativecommons.org/licenses/by-sa/4.0/)版权协议，转载请附上原文出处链接和本声明。本文链接：https://blog.csdn.net/jinpeng_cumt/article/details/86377433

## 1. 龙伯格状态观测器概念

已经线性系统模型如下：

​                               ![\left\{\begin{matrix} \dot{x}=Ax+Bu\\ y=Cx \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7Bx%7D%3DAx&plus;Bu%5C%5C%20y%3DCx%20%5Cend%7Bmatrix%7D%5Cright.)

当系统状态量难以获取，但实际控制中又需要利用系统状态量时，如何通过输入量和输出量重构系统状态量？这便是龙伯格状态观测器设计初衷，将实现系统状态的系统称为状态观测器。

为确保估计状态![\tilde{x(t)}](https://private.codecogs.com/gif.latex?%5Ctilde%7Bx%28t%29%7D)逼近系统真实状态![x(t)](https://private.codecogs.com/gif.latex?x%28t%29)，需满足如下条件：

​                                     ![\lim_{t \to\propto }\left [{ \tilde x(t)-x(t)} \right ]=0](https://private.codecogs.com/gif.latex?%5Clim_%7Bt%20%5Cto%5Cpropto%20%7D%5Cleft%20%5B%7B%20%5Ctilde%20x%28t%29-x%28t%29%7D%20%5Cright%20%5D%3D0)

其中，![\tilde{x(t)}](https://private.codecogs.com/gif.latex?%5Ctilde%7Bx%28t%29%7D)称为![x(t)](https://private.codecogs.com/gif.latex?x%28t%29)的重构状态或者状态估计值。

## 2. 状态观测器设计

假设系统状态观测量和输出观测量满足如下方程：

​                                ![\left\{\begin{matrix} \dot{\tilde{x}}=A\tilde{x}+Bu\\ \tilde{y}=C\tilde{x} \end{matrix}\right.](https://private.codecogs.com/gif.latex?%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%5Cdot%7B%5Ctilde%7Bx%7D%7D%3DA%5Ctilde%7Bx%7D&plus;Bu%5C%5C%20%5Ctilde%7By%7D%3DC%5Ctilde%7Bx%7D%20%5Cend%7Bmatrix%7D%5Cright.)

**龙伯格状态观测器模型：**

​                        ![\dot{\tilde{x}}=A\tilde{x}+Bu+L(y-C\tilde{x}) =(A-LC)\tilde{x}+Bu+Ly](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3DA%5Ctilde%7Bx%7D&plus;Bu&plus;L%28y-C%5Ctilde%7Bx%7D%29%20%3D%28A-LC%29%5Ctilde%7Bx%7D&plus;Bu&plus;Ly)

其中，A为状态矩阵，B为输入矩阵，C为输出矩阵，L为观测器增益矩阵，对偏差的加权。

### （1）状态估计的开环处理

若采用开环控制实现状态估计，其系统结构如图1所示，该系统模型简单，但存在模型不确定性和扰动，初始状态未知等问题。

​                            ![img](https://img-blog.csdnimg.cn/20190215163822972.png)

​                                    图1 基于开环控制的状态观测器实现

###  （2）状态估计的闭环处理

为提高系统的抗干扰性能，故采用闭环控制来实现状态估计，根据输出误差控制状态误差，使得估计状态和真实状态之间的误差逐步减小，其系统结构图如图2所示。                               

​                       ![img](https://img-blog.csdnimg.cn/20190215161009504.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ppbnBlbmdfY3VtdA==,size_16,color_FFFFFF,t_70)    

​                                   图2 基于闭环控制的状态观测器实现 

定义真实状态和估计状态的误差向量如下：

​                                 ![e=x-\tilde{x}](https://private.codecogs.com/gif.latex?e%3Dx-%5Ctilde%7Bx%7D)

则误差的动态行为为：

​                        ![\dot{e}=\dot{x}-\dot{\tilde{x}} \\ =Ax+Bu-(A-LC)\tilde{x}-Bu-Ly \\=Ax-(A-LC)\tilde{x}-LCx =(A-LC)e](https://private.codecogs.com/gif.latex?%5Cdot%7Be%7D%3D%5Cdot%7Bx%7D-%5Cdot%7B%5Ctilde%7Bx%7D%7D%20%5C%5C%20%3DAx&plus;Bu-%28A-LC%29%5Ctilde%7Bx%7D-Bu-Ly%20%5C%5C%3DAx-%28A-LC%29%5Ctilde%7Bx%7D-LCx%20%3D%28A-LC%29e)

由上式可知，矩阵(A-LC)的极点决定了误差是否衰减以及如何衰减，而对于一个已知系统，A和C由系统特性决定。因此，增益矩阵L成为系统是否稳定的关键，这一问题被成为系统的极点配置问题。若能使得矩阵 A － LC 具有适当的特征值，则可以使得误差具有一定的衰减率。

由于

![det\left [ \lambda I-(A-LC) \right ]=det\left [ \lambda I-(A-LC)^{T} \right ]=det\left [ \lambda I-(A^{T}-C^{T}L^{T})\right ]](https://private.codecogs.com/gif.latex?det%5Cleft%20%5B%20%5Clambda%20I-%28A-LC%29%20%5Cright%20%5D%3Ddet%5Cleft%20%5B%20%5Clambda%20I-%28A-LC%29%5E%7BT%7D%20%5Cright%20%5D%3Ddet%5Cleft%20%5B%20%5Clambda%20I-%28A%5E%7BT%7D-C%5E%7BT%7DL%5E%7BT%7D%29%5Cright%20%5D)

因此，问题转化为![\left ( A^{T},C^{T}\right )](https://private.codecogs.com/gif.latex?%5Cleft%20%28%20A%5E%7BT%7D%2CC%5E%7BT%7D%5Cright%20%29)的极点配置问题，该极点配置问题可解的充要条件为：

​                      ![\left ( A^{T},C^{T}\right )](https://private.codecogs.com/gif.latex?%5Cleft%20%28%20A%5E%7BT%7D%2CC%5E%7BT%7D%5Cright%20%29)完全能控  ![\Leftrightarrow](https://private.codecogs.com/gif.latex?%5CLeftrightarrow)  ![\left ( C,A\right )](https://private.codecogs.com/gif.latex?%5Cleft%20%28%20C%2CA%5Cright%20%29)完全能观

观测器的增益矩阵可以按照极点配置方法来设计求解![\left ( A^{T},C^{T}\right )](https://private.codecogs.com/gif.latex?%5Cleft%20%28%20A%5E%7BT%7D%2CC%5E%7BT%7D%5Cright%20%29)的极点配置问题，得到增益矩阵K；观测器增益矩阵![L=K^{T}](https://private.codecogs.com/gif.latex?L%3DK%5E%7BT%7D)。观测器设计的三种方法：直接法、变换法、爱克曼公式。

## 3. 状态观测器实例

考虑由以下系数矩阵给定的系统

​               ![A=\begin{bmatrix} 1 & 1\\ -1&0 \end{bmatrix}](https://private.codecogs.com/gif.latex?A%3D%5Cbegin%7Bbmatrix%7D%201%20%26%201%5C%5C%20-1%260%20%5Cend%7Bbmatrix%7D)  ， ![B=\begin{bmatrix} 1\\ 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?B%3D%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7D)  ， ![C=\begin{bmatrix} 1 & 0 \end{bmatrix}](https://private.codecogs.com/gif.latex?C%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%5Cend%7Bbmatrix%7D)

设计一个观测器，使观测器两个极点都是－2。

### 方法一：直接法

解：（1）检验系统的能观性：

​                      ![\tau _{0}=\begin{bmatrix} C\\ CA \end{bmatrix}=\begin{bmatrix} 1 & 0\\ 0& 1 \end{bmatrix}](https://private.codecogs.com/gif.latex?%5Ctau%20_%7B0%7D%3D%5Cbegin%7Bbmatrix%7D%20C%5C%5C%20CA%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%5C%5C%200%26%201%20%5Cend%7Bbmatrix%7D)

系统是能观的，因此问题可解。

(2) 要求确定观测器增益矩阵![L=\begin{bmatrix} l_{1}\\ l_{2} \end{bmatrix}](https://private.codecogs.com/gif.latex?L%3D%5Cbegin%7Bbmatrix%7D%20l_%7B1%7D%5C%5C%20l_%7B2%7D%20%5Cend%7Bbmatrix%7D) ，使得矩阵![A-LC](https://private.codecogs.com/gif.latex?A-LC) 具有两个相同的特征值－2。由于

​             ![det[\lambda I-(A-LC)]=det\left ( \begin{bmatrix} \lambda & 0\\ 0&\lambda \end{bmatrix} -\begin{bmatrix} 0 &1 \\ -1&0 \end{bmatrix}+\begin{bmatrix} l_{1}\\ l_{2} \end{bmatrix}\begin{bmatrix} 1 & 0 \end{bmatrix}\right ) \\ =det\left ( \begin{bmatrix} \lambda + l_{1} &-1 \\ 1+l_{2}& \lambda \end{bmatrix} \right ) \\ =\lambda ^{2}+l_{1}\lambda +1+l_{2}](https://private.codecogs.com/gif.latex?det%5B%5Clambda%20I-%28A-LC%29%5D%3Ddet%5Cleft%20%28%20%5Cbegin%7Bbmatrix%7D%20%5Clambda%20%26%200%5C%5C%200%26%5Clambda%20%5Cend%7Bbmatrix%7D%20-%5Cbegin%7Bbmatrix%7D%200%20%261%20%5C%5C%20-1%260%20%5Cend%7Bbmatrix%7D&plus;%5Cbegin%7Bbmatrix%7D%20l_%7B1%7D%5C%5C%20l_%7B2%7D%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%5Cend%7Bbmatrix%7D%5Cright%20%29%20%5C%5C%20%3Ddet%5Cleft%20%28%20%5Cbegin%7Bbmatrix%7D%20%5Clambda%20&plus;%20l_%7B1%7D%20%26-1%20%5C%5C%201&plus;l_%7B2%7D%26%20%5Clambda%20%5Cend%7Bbmatrix%7D%20%5Cright%20%29%20%5C%5C%20%3D%5Clambda%20%5E%7B2%7D&plus;l_%7B1%7D%5Clambda%20&plus;1&plus;l_%7B2%7D)

(3)期望的特征值多项式是

​                   ![\left ( \lambda +2 \right )\left ( \lambda +2 \right )=\lambda ^{2}+4\lambda +4](https://private.codecogs.com/gif.latex?%5Cleft%20%28%20%5Clambda%20&plus;2%20%5Cright%20%29%5Cleft%20%28%20%5Clambda%20&plus;2%20%5Cright%20%29%3D%5Clambda%20%5E%7B2%7D&plus;4%5Clambda%20&plus;4)

比较两个多项式，可以得到，

​                   ![l_{1}=4, l_{2}=3 \Rightarrow L=\begin{bmatrix} 4\\ 3 \end{bmatrix}](https://private.codecogs.com/gif.latex?l_%7B1%7D%3D4%2C%20l_%7B2%7D%3D3%20%5CRightarrow%20L%3D%5Cbegin%7Bbmatrix%7D%204%5C%5C%203%20%5Cend%7Bbmatrix%7D)

所求的观测器是

​                 ![\dot{\tilde{x}}=(A-LC)\tilde{x}+Bu+Ly=\begin{bmatrix} -4 &1 \\ -4& 0 \end{bmatrix}\tilde{x}+\begin{bmatrix} 1\\ 0 \end{bmatrix}u+\begin{bmatrix} 4\\ 3 \end{bmatrix}y](https://private.codecogs.com/gif.latex?%5Cdot%7B%5Ctilde%7Bx%7D%7D%3D%28A-LC%29%5Ctilde%7Bx%7D&plus;Bu&plus;Ly%3D%5Cbegin%7Bbmatrix%7D%20-4%20%261%20%5C%5C%20-4%26%200%20%5Cend%7Bbmatrix%7D%5Ctilde%7Bx%7D&plus;%5Cbegin%7Bbmatrix%7D%201%5C%5C%200%20%5Cend%7Bbmatrix%7Du&plus;%5Cbegin%7Bbmatrix%7D%204%5C%5C%203%20%5Cend%7Bbmatrix%7Dy)

### 方法二：爱克曼公式

```
%% 利用MATLAB中的acker函数求解状态观测器
% 
clc;
% clear all close all
% 系统矩阵
A = [0 1; -1,0];B = [1;0];C = [1 0];
% 期望的极点P = [-2;-2]; 
% 判断系统是否完全能观
E_obs = obsv(A,C);           
% 求解能观性矩阵
E_val = rank(E_obs);         
% 根据能控性矩阵是否满秩判断能观性 
L_acker = (acker(A',C',P))'; 
% 利用acker求状态增益矩阵L
```